/*!
 * tui-component-calendar.min.js
 * @version 1.2.0
 * @author NHNEnt FE Development Lab <dl_javascript@nhnent.com>
 * @license MIT
 */
!function(t){function e(n){if(a[n])return a[n].exports;var r=a[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var a={};return e.m=t,e.c=a,e.p="dist",e(0)}([function(t,e,a){"use strict";var n=a(1);tui.util.defineNamespace("tui.component",{Calendar:n})},function(t,e,a){"use strict";var n=a(3),r=a(2),i=tui.util,s=i.bind,o=i.extend,l=i.defineClass({init:function(t){this._option={},this._shownDate={year:0,month:1,date:1},this.$element=$(t.element||arguments[0]),this.$header=null,this.$title=null,this.$titleYear=null,this.$titleMonth=null,this.$body=null,this.$weekTemplate=null,this.$weekAppendTarget=null,this._$dateElement=null,this._$dateContainerElement=null,this.$footer=null,this.$today=null,this.shownLayerIdx=0,this.dataOfMonthLayer={},this.dataOfYearLayer={},this.isClickableTitle=!1,this.handlers={},this._setDefault(t)},_setDefault:function(t){this._setOption(t),this._assignHTMLElements(),this._attachEvent(),this.draw(this._option.year,this._option.month,!1,0)},_setOption:function(t){var e=this._option,a=n.getDateHash(),i={classPrefix:"calendar-",year:a.year,month:a.month,titleFormat:"yyyy-mm",todayFormat:"yyyy/mm/dd (D)",yearTitleFormat:"yyyy",monthTitleFormat:"m",monthTitles:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],dayTitles:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],itemCountOfYear:r.itemCountOfYear};o(e,i,t)},_assignHTMLElements:function(){var t=this._option.classPrefix,e=this.$element,a="."+t;this._assignHeader(e,a,t),this._assignBody(e,a,t),this._assignFooter(e,a,t)},_assignHeader:function(t,e,a){var n,i,s=t.find(e+"header"),o=r.relativeMonthValueKey,l="btn-";s.length||(n=r.calendarHeader,i=r.defaultClassPrefixRegExp,s=$(n.replace(i,a)),t.append(s)),s.find(e+l+r.prevYear).data(o,-12),s.find(e+l+r.prevMonth).data(o,-1),s.find(e+l+r.nextYear).data(o,12),s.find(e+l+r.nextMonth).data(o,1),this.$title=s.find(e+"title"),this.$titleYear=s.find(e+"title-year"),this.$titleMonth=s.find(e+"title-month"),this.$header=s,this.$title.hasClass(this._option.classPrefix+r.clickable)&&(this.isClickableTitle=!0)},_assignBody:function(t,e,a){var n,i,s=t.find(e+"body");s.length||(n=r.calendarBody,i=r.defaultClassPrefixRegExp,s=$(n.replace(i,a)),t.append(s)),this._assignWeek(e),this._assignMonthLayer(e),this._assignYearLayer(e),this.$body=s.hide()},_assignWeek:function(t){var e=this.$element.find(t+"body"),a=e.find(t+"week");this.$weekTemplate=a.clone(!0),this.$weekAppendTarget=a.parent()},_assignMonthLayer:function(t){var e=this.$element.find(t+"body"),a=e.find(t+"month-group"),n=a.find(t+"month").length,r=Math.ceil(this._option.monthTitles.length/n);this.dataOfMonthLayer={template:a.clone(!0),appendedTarget:a.parent(),frame:{cols:n,rows:r}}},_assignYearLayer:function(t){var e=this.$element.find(t+"body"),a=e.find(t+"year-group"),n=a.find(t+"year").length,r=Math.ceil(this._option.itemCountOfYear/n);this.dataOfYearLayer={template:a.clone(!0),appendedTarget:a.parent(),frame:{cols:n,rows:r}}},_assignFooter:function(t,e,a){var n,i,s=t.find(e+"footer");s.length||(n=r.calendarFooter,i=r.defaultClassPrefixRegExp,s=$(n.replace(i,a)),t.append(s)),this.$today=s.find(e+"today"),this.$footer=s},_attachEvent:function(){this.handlers.clickRolloverBtn=s(this._onClickRolloverButton,this),this.attachEventToRolloverBtn(),o(this.handlers,{clickTitle:s(this._onClickTitle,this),clickYearLayer:s(this._onClickYearLayer,this),clickMonthLayer:s(this._onClickMonthLayer,this)}),this.isClickableTitle&&this.attachEventToTitle(),this.attachEventToBody()},attachEventToRolloverBtn:function(){var t="."+this._option.classPrefix+"rollover",e=this.$header.find(t);e.on("click",this.handlers.clickRolloverBtn)},detachEventToRolloverBtn:function(){var t="."+this._option.classPrefix+"rollover",e=this.$header.find(t);e.off("click",this.handlers.clickRolloverBtn)},attachEventToTitle:function(){this.$title.on("click",this.handlers.clickTitle)},detachEventToTitle:function(){this.$title.off("click",this.handlers.clickTitle)},attachEventToBody:function(){var t="."+this._option.classPrefix,e=this.dataOfYearLayer.appendedTarget,a=this.dataOfMonthLayer.appendedTarget;e.on("click",t+"year",this.handlers.clickYearLayer),a.on("click",t+"month",this.handlers.clickMonthLayer)},detachEventToBody:function(){var t="."+this._option.classPrefix,e=this.dataOfYearLayer.appendedTarget,a=this.dataOfMonthLayer.appendedTarget;e.off("click",t+"year",this.handlers.clickYearLayer),a.off("click",t+"month",this.handlers.clickMonthLayer)},_onClickRolloverButton:function(t){var e=$(t.currentTarget).data(r.relativeMonthValueKey);t.preventDefault(),this.draw(0,e,!0)},_onClickTitle:function(t){var e,a=this.shownLayerIdx;t.preventDefault(),2!==a&&(a=2!==a?a+1:0,e=this.getDate(),this.draw(e.year,e.month,!1,a))},_onClickYearLayer:function(t){var e=$(t.currentTarget).data(r.relativeMonthValueKey);t.preventDefault(),this.draw(0,e,!0,1)},_onClickMonthLayer:function(t){var e=$(t.currentTarget).data(r.relativeMonthValueKey);t.preventDefault(),this.draw(0,e,!0,0)},_getDateForDrawing:function(t,e,a){var r,s=this.getDate();return s.date=1,i.isNumber(t)||i.isNumber(e)?(a?(r=n.getRelativeDate(t,e,0,s),s.year=r.year,s.month=r.month):(s.year=t||s.year,s.month=e||s.month),s):s},_isNecessaryForDrawing:function(t,e){var a=this._shownDate;return a.year!==t||a.month!==e},_setCalendarText:function(t){var e=t.year,a=t.month;this._setCalendarToday(),this._setCalendarTitle(e,a)},_drawDates:function(t,e){var a=t.year,s=t.month,o=0,l=n.getRelativeDate(0,-1,0,t),d=n.getRelativeDate(0,1,0,t),h=[],c=n.getFirstDay(a,s),y=this._fillDates(a,s,h);i.forEach(h,function(t, n){var i,h=!1,f=!1,u=$(this._$dateContainerElement[n]),p=a,m=s;n<c?(h=!0,u.addClass(e+r.prevMonth),p=l.year,m=l.month):n>y&&(f=!0,u.addClass(e+r.nextMonth),p=d.year,m=d.month),this._setWeekend(o,u,e),this._isToday(p,m,t)&&u.addClass(e+"today"),i={$date:$(this._$dateElement.get(n)),$dateContainer:u,year:p,month:m,date:t,isPrevMonth:h,isNextMonth:f,html:t},$(i.$date).html(i.html.toString()),o=(o+1)%7,this.fire("draw",i)},this)},_isToday:function(t, e, a){var r=n.getDateHash(),i=!t||r.year===t,s=!e||r.month===e,o=!a||r.date===a;return i&&s&&o},_setWeeks:function(t, e){var a,r,i=n.getWeeks(t,e);for(r=0; r<i; r+=1)a=this.$weekTemplate.clone(!0),a.appendTo(this.$weekAppendTarget),this._weekElements.push(a)},_fillDates:function(t, e, a){var r,i,s=n.getFirstDay(t,e),o=n.getLastDay(t,e),l=n.getLastDate(t,e),d=n.getRelativeDate(0,-1,0,{year:t,month:e,date:1}),h=n.getLastDate(d.year,d.month);if(s>0)for(i=h-s; i<h; i+=1)a.push(i+1);for(i=1; i<l+1; i+=1)a.push(i);for(r=a.length-1,i=1; i<7-o; i+=1)a.push(i);return r},_setWeekend:function(t,e,a){0===t?e.addClass(a+"sun"):6===t&&e.addClass(a+"sat")},_clear:function(){this._weekElements=[],this.$weekAppendTarget.empty(),this.dataOfMonthLayer.appendedTarget.empty(),this.dataOfYearLayer.appendedTarget.empty()},_setCalendarTitle:function(t,e){var a,i,s=this._option,o=s.titleFormat;e=n.prependLeadingZero(e),a=this._getReplaceMap(t,e),i=r.titleRegExp,this._setDateTextInCalendar(this.$title,o,a,i),i=r.titleYearRegExp,this._setDateTextInCalendar(this.$titleYear,s.yearTitleFormat,a,i),i=r.titleMonthRegExp,this._setDateTextInCalendar(this.$titleMonth,s.monthTitleFormat,a,i)},_setDateTextInCalendar:function(t, e, a, r){var i,s=$(t);s.length&&(i=n.getConvertedTitle(e,a,r),s.text(i))},_getReplaceMap:function(t, e, a){var n=this._option,r=t.toString().substr(2,2),i=n.monthTitles[e-1],s=new Date(t,e-1,a||1).getDay(),o=n.dayTitles[s];return{yyyy:t,yy:r,mm:e,m:Number(e),M:i,dd:a,d:Number(a),D:o}},_setCalendarToday:function(){var t,e,a,i,s,o,l,d=this.$today;d.length&&(e=n.getDateHash(),a=e.year,i=n.prependLeadingZero(e.month),s=n.prependLeadingZero(e.date),t=this._option.todayFormat,o=this._getReplaceMap(a,i,s),l=r.todayRegExp,this._setDateTextInCalendar(d,t,o,l))},_setTitleOnYearLayer:function(t){var e=this._getInfoOfYearRange(t),a=this._getConvertedYearTitle(e.startYear),n=this._getConvertedYearTitle(e.endYear),r=a+" - "+n;this.$title.text(r)},_setClassNameOnTitle:function(t){var e=this._option.classPrefix+r.clickable;this.isClickableTitle&&(2!==t?this.$title.addClass(e):this.$title.removeClass(e))},_getConvertedYearTitle:function(t){var e,a,i=this._option;return e=this._getReplaceMap(t),a=r.titleYearRegExp,n.getConvertedTitle(i.yearTitleFormat,e,a)},_getInfoOfYearRange:function(t){var e=this.dataOfYearLayer.frame,a=e.cols,n=e.rows,r=a*Math.floor(n/2)+Math.floor(a/2),i=t-r,s=i+a*n-1;return{startYear:i,endYear:s}},_getIndexOfShownLayer:function(t){return t?i.inArray(t,r.layerKeys):this.shownLayerIdx},_drawHeader:function(t,e){var a,n,i="."+this._option.classPrefix+"btn-",s=this.$header.find(i+r.prev),o=this.$header.find(i+r.next),l=r.relativeMonthValueKey,d=this._option.itemCountOfYear;switch(this._setClassNameOnTitle(e),e){case 0:this._setCalendarText(t),a=-1,n=1;break;case 1:this.$title.text(this._getConvertedYearTitle(t.year)),a=-12,n=12;break;case 2:this._setTitleOnYearLayer(t.year),a=-12*d,n=12*d}s.data(l,a),o.data(l,n)},_drawBody:function(t,e){var a=t.year,n=t.month,r=this._option.classPrefix;this._setWeeks(a,n),this._$dateElement=$("."+r+"date",this.$weekAppendTarget),this._$dateContainerElement=$("."+r+"week > *",this.$weekAppendTarget),this._drawDates(t,r),this._drawFrameOnMonthLayer(),this._drawButtonsOfMonth(t,r),this._drawFrameOnYearLayer(),this._drawButtonsOfYear(t,r),this._changeShownLayer(e)},_drawFrameOnMonthLayer:function(){for(var t,e=0,a=this.dataOfMonthLayer.frame.rows,n=this.dataOfMonthLayer;e<a;e+=1)t=n.template.clone(!0),t.appendTo(n.appendedTarget)},_drawButtonsOfMonth:function(t,e){var a,n,s,o,l=r.relativeMonthValueKey,d=t.month,h=this._option.monthTitles,c=this.dataOfMonthLayer.appendedTarget.find("."+e+"month");i.forEach(h,function(i,h){a=c.eq(h),n=h+1,n===d&&a.addClass(e+r.selected),this._isToday(this._shownDate.year,n)&&a.addClass(e+r.today),s=n-d,a.data(l,s).html(i),o={$date:a,$dateContainer:a,year:t.year,month:n,date:0,html:i},this.fire("draw",o)},this)},_drawFrameOnYearLayer:function(){for(var t,e=0,a=this.dataOfMonthLayer.frame.rows,n=this.dataOfYearLayer;e<a;e+=1)t=n.template.clone(!0),t.appendTo(n.appendedTarget)},_drawButtonsOfYear:function(t,e){for(var a,n,i,s=r.relativeMonthValueKey,o=t.year,l=this._getInfoOfYearRange(o),d=l.startYear,h=l.endYear,c=0,y=this.dataOfYearLayer.appendedTarget.find("."+e+"year");d<=h;d+=1)a=y.eq(c),d===o&&a.addClass(e+r.selected),this._isToday(d)&&a.addClass(e+r.today),n=12*(d-o),a.data(s,n).html(d),c+=1,i={$date:a,$dateContainer:a,year:d,month:0,date:0,html:d},this.fire("draw",i)},_changeShownLayer:function(t){var e=this._option.classPrefix,a=this.shownLayerIdx,n=this.$element.find("."+e+"body");this.shownLayerIdx=t,n.eq(a).hide(),n.eq(t).show()},draw:function(t,e,a,n){var r,s=this._getDateForDrawing(t,e,a),o=this.invoke("beforeDraw",s);o&&(r=i.isNumber(n)?n:this._getIndexOfShownLayer(n),t=s.year,e=s.month,this.setDate(t,e),this._clear(),this._drawHeader(s,r),this._drawBody(s,r),this.fire("afterDraw",s))},getDate:function(){return{year:this._shownDate.year,month:this._shownDate.month}},setDate:function(t,e){var a=this._shownDate;a.year=i.isNumber(t)?t:a.year,a.month=i.isNumber(e)?e:a.month}});i.CustomEvents.mixin(l),t.exports=l},function(t,e){"use strict";var a={relativeMonthValueKey:"relativeMonthValue",prev:"prev",prevYear:"prev-year",prevMonth:"prev-month",next:"next",nextYear:"next-year",nextMonth:"next-month",selected:"selected",today:"today",clickable:"clickable-title",calendarHeader:null,calendarBody:null,calendarFooter:null,defaultClassPrefixRegExp:/calendar-/g,titleRegExp:/yyyy|yy|mm|m|M/g,titleYearRegExp:/yyyy|yy/g,titleMonthRegExp:/mm|m|M/g,todayRegExp:/yyyy|yy|mm|m|M|dd|d|D/g,itemCountOfYear:12,layerKeys:["date","month","year"]};a.calendarHeader=['<div class="calendar-header">','<a href="#" class="calendar-rollover calendar-btn-'+a.prev+'">Prev</a>','<strong class="calendar-title calendar-clickable-title"></strong>','<a href="#" class="calendar-rollover calendar-btn-'+a.next+'">Next</a>',"</div>"].join(""),a.calendarBody=['<div class="calendar-body">',"<table>","<thead>","<tr>",'<th class="calendar-sun">Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fa</th><th class="calendar-sat">Sa</th>',"</tr>","</thead>","<tbody>",'<tr class="calendar-week">','<td class="calendar-date"></td>','<td class="calendar-date"></td>','<td class="calendar-date"></td>','<td class="calendar-date"></td>','<td class="calendar-date"></td>','<td class="calendar-date"></td>','<td class="calendar-date"></td>',"</tr>","</tbody>","</table>","</div>",'<div class="calendar-body">',"<table>","<tbody>",'<tr class="calendar-month-group">','<td class="calendar-month"></td>','<td class="calendar-month"></td>','<td class="calendar-month"></td>',"</tr>","</tbody>","</table>","</div>",'<div class="calendar-body">',"<table>","<tbody>",'<tr class="calendar-year-group">','<td class="calendar-year"></td>','<td class="calendar-year"></td>','<td class="calendar-year"></td>',"</tr>","</tbody>","</table>","</div>"].join(""),a.calendarFooter=['<div class="calendar-footer">','<p>오늘 <em class="calendar-today"></em></p>',"</div>"].join(""),t.exports=a},function(t, e){"use strict";var a={getDateHash:function(t, e, a){var n;return arguments.length<3&&(n=arguments[0]||new Date,t=n.getFullYear(),e=n.getMonth()+1,a=n.getDate()),{year:t,month:e,date:a}},getToday:function(){return a.getDateHash()},getWeeks:function(t, e){var a=this.getFirstDay(t,e),n=this.getLastDate(t,e);return Math.ceil((a+n)/7)},getTime:function(t){return this.getDateObject(t).getTime()},getFirstDay:function(t, e){return new Date(t,e-1,1).getDay()},getLastDay:function(t, e){return new Date(t,e,0).getDay()},getLastDate:function(t, e){return new Date(t,e,0).getDate()},getDateObject:function(t){return 3===arguments.length?new Date(arguments[0],arguments[1]-1,arguments[2]):new Date(t.year,t.month-1,t.date)},getRelativeDate:function(t, e, n, r){var i=r.year+t,s=r.month+e-1,o=r.date+n,l=new Date(i,s,o);return a.getDateHash(l)},prependLeadingZero:function(t){var e="";return t<10&&(e="0"),e+t},getConvertedTitle:function(t, e, a){return t=t.replace(a,function(t){return e[t]||""})}};t.exports=a}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vdHVpLWNvbXBvbmVudC1jYWxlbmRhci5taW4uanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGFmNjU1MjZmNDMxYzJmMmFmZGY3Iiwid2VicGFjazovLy8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY2FsZW5kYXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMuanMiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiQ2FsZW5kYXIiLCJ0dWkiLCJ1dGlsIiwiZGVmaW5lTmFtZXNwYWNlIiwiY2FsZW5kYXJVdGlscyIsIkNPTlNUQU5UUyIsImJpbmQiLCJleHRlbmQiLCJkZWZpbmVDbGFzcyIsImluaXQiLCJvcHRpb24iLCJ0aGlzIiwiX29wdGlvbiIsIl9zaG93bkRhdGUiLCJ5ZWFyIiwibW9udGgiLCJkYXRlIiwiJGVsZW1lbnQiLCIkIiwiZWxlbWVudCIsImFyZ3VtZW50cyIsIiRoZWFkZXIiLCIkdGl0bGUiLCIkdGl0bGVZZWFyIiwiJHRpdGxlTW9udGgiLCIkYm9keSIsIiR3ZWVrVGVtcGxhdGUiLCIkd2Vla0FwcGVuZFRhcmdldCIsIl8kZGF0ZUVsZW1lbnQiLCJfJGRhdGVDb250YWluZXJFbGVtZW50IiwiJGZvb3RlciIsIiR0b2RheSIsInNob3duTGF5ZXJJZHgiLCJkYXRhT2ZNb250aExheWVyIiwiZGF0YU9mWWVhckxheWVyIiwiaXNDbGlja2FibGVUaXRsZSIsImhhbmRsZXJzIiwiX3NldERlZmF1bHQiLCJfc2V0T3B0aW9uIiwiX2Fzc2lnbkhUTUxFbGVtZW50cyIsIl9hdHRhY2hFdmVudCIsImRyYXciLCJpbnN0YW5jZU9wdGlvbiIsInRvZGF5IiwiZ2V0RGF0ZUhhc2hUYWJsZSIsImRlZmF1bHRPcHRpb24iLCJjbGFzc1ByZWZpeCIsInRpdGxlRm9ybWF0IiwidG9kYXlGb3JtYXQiLCJ5ZWFyVGl0bGVGb3JtYXQiLCJtb250aFRpdGxlRm9ybWF0IiwibW9udGhUaXRsZXMiLCJkYXlUaXRsZXMiLCJpdGVtQ291bnRPZlllYXIiLCJjbGFzc1NlbGVjdG9yIiwiX2Fzc2lnbkhlYWRlciIsIl9hc3NpZ25Cb2R5IiwiX2Fzc2lnbkZvb3RlciIsImhlYWRlclRlbXBsYXRlIiwiZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwIiwiZmluZCIsImtleSIsInJlbGF0aXZlTW9udGhWYWx1ZUtleSIsImJ0bkNsYXNzTmFtZSIsImxlbmd0aCIsImNhbGVuZGFySGVhZGVyIiwicmVwbGFjZSIsImFwcGVuZCIsInByZXZZZWFyIiwiZGF0YSIsInByZXZNb250aCIsIm5leHRZZWFyIiwibmV4dE1vbnRoIiwiaGFzQ2xhc3MiLCJjbGlja2FibGUiLCJib2R5VGVtcGxhdGUiLCJjYWxlbmRhckJvZHkiLCJfYXNzaWduV2VlayIsIl9hc3NpZ25Nb250aExheWVyIiwiX2Fzc2lnblllYXJMYXllciIsImhpZGUiLCJjbG9uZSIsInBhcmVudCIsIiRtb250aHNUZW1wbGF0ZSIsImNvbHMiLCJyb3dzIiwiTWF0aCIsImNlaWwiLCJ0ZW1wbGF0ZSIsImFwcGVuZGVkVGFyZ2V0IiwiZnJhbWUiLCIkeWVhcnNUZW1wbGF0ZSIsImZvb3RlclRlbXBsYXRlIiwiY2FsZW5kYXJGb290ZXIiLCJjbGlja1JvbGxvdmVyQnRuIiwiX29uQ2xpY2tSb2xsb3ZlckJ1dHRvbiIsImF0dGFjaEV2ZW50VG9Sb2xsb3ZlckJ0biIsImNsaWNrVGl0bGUiLCJfb25DbGlja1RpdGxlIiwiY2xpY2tZZWFyTGF5ZXIiLCJfb25DbGlja1llYXJMYXllciIsImNsaWNrTW9udGhMYXllciIsIl9vbkNsaWNrTW9udGhMYXllciIsImF0dGFjaEV2ZW50VG9UaXRsZSIsImF0dGFjaEV2ZW50VG9Cb2R5Iiwic2VsZWN0b3IiLCJidG5zIiwib24iLCJkZXRhY2hFdmVudFRvUm9sbG92ZXJCdG4iLCJvZmYiLCJkZXRhY2hFdmVudFRvVGl0bGUiLCJ5ZWFyTGF5ZXIiLCJtb250aExheWVyIiwiZGV0YWNoRXZlbnRUb0JvZHkiLCJldmVudCIsInJlbGF0aXZlTW9udGhWYWx1ZSIsImN1cnJlbnRUYXJnZXQiLCJwcmV2ZW50RGVmYXVsdCIsImdldERhdGUiLCJfZ2V0RGF0ZUZvckRyYXdpbmciLCJpc1JlbGF0aXZlIiwicmVsYXRpdmVEYXRlIiwibkRhdGUiLCJpc051bWJlciIsImdldFJlbGF0aXZlRGF0ZSIsIl9pc05lY2Vzc2FyeUZvckRyYXdpbmciLCJzaG93bkRhdGUiLCJfc2V0Q2FsZW5kYXJUZXh0IiwiZGF0ZUZvckRyYXdpbmciLCJfc2V0Q2FsZW5kYXJUb2RheSIsIl9zZXRDYWxlbmRhclRpdGxlIiwiX2RyYXdEYXRlcyIsImRheUluV2VlayIsImRhdGVQcmV2TW9udGgiLCJkYXRlTmV4dE1vbnRoIiwiZGF0ZXMiLCJmaXJzdERheSIsImdldEZpcnN0RGF5IiwiaW5kZXhPZkxhc3REYXRlIiwiX2ZpbGxEYXRlcyIsImZvckVhY2giLCJpIiwiZXZlbnREYXRhIiwiaXNQcmV2TW9udGgiLCJpc05leHRNb250aCIsIiRkYXRlQ29udGFpbmVyIiwidGVtcFllYXIiLCJ0ZW1wTW9udGgiLCJhZGRDbGFzcyIsIl9zZXRXZWVrZW5kIiwiX2lzVG9kYXkiLCIkZGF0ZSIsImdldCIsImh0bWwiLCJ0b1N0cmluZyIsImZpcmUiLCJpc1llYXIiLCJpc01vbnRoIiwiaXNEYXRlIiwiX3NldFdlZWtzIiwiJGVsV2VlayIsIndlZWtzIiwiZ2V0V2Vla3MiLCJhcHBlbmRUbyIsIl93ZWVrRWxlbWVudHMiLCJwdXNoIiwibGFzdERheSIsImdldExhc3REYXkiLCJsYXN0RGF0ZSIsImdldExhc3REYXRlIiwicHJldk1vbnRoTGFzdERhdGUiLCJkYXkiLCJfY2xlYXIiLCJlbXB0eSIsInJlcGxhY2VNYXAiLCJyZWciLCJwcmVwZW5kTGVhZGluZ1plcm8iLCJfZ2V0UmVwbGFjZU1hcCIsInRpdGxlUmVnRXhwIiwiX3NldERhdGVUZXh0SW5DYWxlbmRhciIsInRpdGxlWWVhclJlZ0V4cCIsInRpdGxlTW9udGhSZWdFeHAiLCJmb3JtIiwibWFwIiwidGl0bGUiLCIkZWwiLCJnZXRDb252ZXJ0ZWRUaXRsZSIsInRleHQiLCJ5ZWFyU3ViIiwic3Vic3RyIiwibW9udGhMYWJlbCIsImxhYmVsS2V5IiwiRGF0ZSIsImdldERheSIsImRheUxhYmVsIiwieXl5eSIsInl5IiwibW0iLCJOdW1iZXIiLCJNIiwiZGQiLCJkIiwiRCIsInRvZGF5UmVnRXhwIiwiX3NldFRpdGxlT25ZZWFyTGF5ZXIiLCJfZ2V0SW5mb09mWWVhclJhbmdlIiwic3RhcnRZZWFyVGV4dCIsIl9nZXRDb252ZXJ0ZWRZZWFyVGl0bGUiLCJzdGFydFllYXIiLCJlbmRZZWFyVGV4dCIsImVuZFllYXIiLCJfc2V0Q2xhc3NOYW1lT25UaXRsZSIsImNsYXNzTmFtZSIsInJlbW92ZUNsYXNzIiwiZnJhbWVJbmZvIiwiYmFzZUlkeCIsImZsb29yIiwiX2dldEluZGV4T2ZTaG93bkxheWVyIiwidHlwZSIsImluQXJyYXkiLCJsYXllcktleXMiLCJfZHJhd0hlYWRlciIsInByZXZWYWx1ZSIsIm5leHRWYWx1ZSIsInByZXZCdG4iLCJwcmV2IiwibmV4dEJ0biIsIm5leHQiLCJfZHJhd0JvZHkiLCJfZHJhd0ZyYW1lT25Nb250aExheWVyIiwiX2RyYXdCdXR0b25zT2ZNb250aCIsIl9kcmF3RnJhbWVPblllYXJMYXllciIsIl9kcmF3QnV0dG9uc09mWWVhciIsIl9jaGFuZ2VTaG93bkxheWVyIiwiJG1vbnRoR3JvdXBFbCIsIiRidXR0b25FbCIsInJlbGF0aXZlTW9udGgiLCJzZWxlY3RlZE1vbnRoIiwiJG1vbnRoRWxzIiwiaWR4IiwiZXEiLCJzZWxlY3RlZCIsIiR5ZWFyR3JvdXBFbCIsImNudCIsIiR5ZWFyRWxzIiwicHJldnNob3duTGF5ZXJJZHgiLCIkYm9keXMiLCJzaG93Iiwic2hvd25UeXBlIiwiaXNSZWFkeUZvckRyYXdpbmciLCJpbnZva2UiLCJzZXREYXRlIiwiQ3VzdG9tRXZlbnRzIiwibWl4aW4iLCJqb2luIiwidXRpbHMiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0VG9kYXkiLCJnZXRUaW1lIiwiZ2V0RGF0ZU9iamVjdCIsImRhdGVPYmoiLCJuWWVhciIsIm5Nb250aCIsIm5EYXRlT2JqIiwibnVtYmVyIiwicHJlZml4Iiwic3RyIiwibWF0Y2hlZFN0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0NBTVMsU0FBVUEsR0NGbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFFLE9BR0EsSUFBQUMsR0FBQUYsRUFBQUQsSUFDQUUsV0FDQUUsR0FBQUosRUFDQUssUUFBQSxFQVVBLE9BTkFQLEdBQUFFLEdBQUFNLEtBQUFILEVBQUFELFFBQUFDLElBQUFELFFBQUFILEdBR0FJLEVBQUFFLFFBQUEsRUFHQUYsRUFBQUQsUUF2QkEsR0FBQUQsS0FxQ0EsT0FUQUYsR0FBQVEsRUFBQVQsRUFHQUMsRUFBQVMsRUFBQVAsRUFHQUYsRUFBQVUsRUFBQSxPQUdBVixFQUFBLEtEWU0sU0FBU0ksRUFBUUQsRUFBU0gsR0VsRGhDLFlBRUEsSUFBQVcsR0FBQVgsRUFBQSxFQUVBWSxLQUFBQyxLQUFBQyxnQkFBQSxpQkFDQUgsY0YwRE0sU0FBU1AsRUFBUUQsRUFBU0gsR0czRGhDLFlBRUEsSUFBQWUsR0FBQWYsRUFBQSxHQUNBZ0IsRUFBQWhCLEVBQUEsR0FFQWEsRUFBQUQsSUFBQUMsS0FDQUksRUFBQUosRUFBQUksS0FDQUMsRUFBQUwsRUFBQUssT0F3Q0FQLEVBQUFFLEVBQUFNLGFBQ0FDLEtBQUEsU0FBQUMsR0FpQkFDLEtBQUFDLFdBT0FELEtBQUFFLFlBQ0FDLEtBQUEsRUFDQUMsTUFBQSxFQUNBQyxLQUFBLEdBYUFMLEtBQUFNLFNBQUFDLEVBQUFSLEVBQUFTLFNBQUFDLFVBQUEsSUFPQVQsS0FBQVUsUUFBQSxLQU9BVixLQUFBVyxP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LEVBQUFSLEdBS0EsTUFKQTRGLEtBQUF6TSxRQUFBNkcsRUFBQSxTQUFBNkYsR0FDQSxNQUFBckYsR0FBQXFGLElBQUEsTUFPQW5SLEdBQUFELFFBQUF1USIsImZpbGUiOiJ0dWktY29tcG9uZW50LWNhbGVuZGFyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogdHVpLWNvbXBvbmVudC1jYWxlbmRhci5taW4uanNcbiAqIEB2ZXJzaW9uIDEuMi4wXG4gKiBAYXV0aG9yIE5ITkVudCBGRSBEZXZlbG9wbWVudCBMYWIgPGRsX2phdmFzY3JpcHRAbmhuZW50LmNvbT5cbiAqIEBsaWNlbnNlIE1JVFxuICovXG4vKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJkaXN0XCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgQ2FsZW5kYXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dHVpLnV0aWwuZGVmaW5lTmFtZXNwYWNlKCd0dWkuY29tcG9uZW50Jywge1xuXHQgICAgQ2FsZW5kYXI6IENhbGVuZGFyXG5cdH0pO1xuXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKipcblx0ICogQGZpbGVvdmVydmlldyBDYWxlbmRhciBjb21wb25lbnQoZnJvbSBQdWcgY29tcG9uZW50KVxuXHQgKiBAYXV0aG9yIE5ITiBFbnQuIEZFIGRldiBMYWIgPGRsX2phdmFzY3JpcHRAbmhuZW50LmNvbT5cblx0ICovXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBjYWxlbmRhclV0aWxzID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTtcblx0dmFyIENPTlNUQU5UUyA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR2YXIgdXRpbCA9IHR1aS51dGlsO1xuXHR2YXIgYmluZCA9IHV0aWwuYmluZDtcblx0dmFyIGV4dGVuZCA9IHV0aWwuZXh0ZW5kO1xuXHRcblx0LyoqXG5cdCAqIENhbGVuZGFyIGNvbXBvbmVudCBjbGFzc1xuXHQgKiBAY29uc3RydWN0b3Jcblx0ICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25dIEEgb3B0aW9ucyBmb3IgaW5pdGlhbGl6ZVxuXHQgKiAgICAgQHBhcmFtIHtIVE1MRWxlbWVudH0gb3B0aW9uLmVsZW1lbnQgQSByb290IGVsZW1lbnRcblx0ICogICAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLmNsYXNzUHJlZml4PVwiY2FsZW5kYXItXCJdIEEgcHJlZml4IGNsYXNzIGZvciBtYXJrdXAgc3RydWN0dXJlXG5cdCAqICAgICBAcGFyYW0ge251bWJlcn0gW29wdGlvbi55ZWFyPXRoaXMgeWVhcl0gQSB5ZWFyIGZvciBpbml0aWFsaXplXG5cdCAqICAgICBAcGFyYW0ge251bWJlcn0gW29wdGlvbi5tb250aD10aGlzIG1vbnRoXSBBIG1vbnRoIGZvciBpbml0aWFsaXplXG5cdCAqICAgICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbi50aXRsZUZvcm1hdD1cInl5eXktbW1cIl0gQSB0aXRsZSBmb3JtYXQuXG5cdCAqICAgICAgICAgICAgICAgICAgICAgVGhpcyBjb21wb25lbnQgZmluZCB0aXRsZSBlbGVtZW50IGJ5IGNsYXNzTmFtZSAnW3ByZWZpeF10aXRsZSdcblx0ICogICAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLnRvZGF5Rm9ybWF0ID0gXCJ5eXl5IFllYXIgbW0gTW9udGggZGQgRGF5IChEKVwiXSBBIHRvZGF5IGZvcm1hdC5cblx0ICogICAgICAgICAgICAgICAgICAgICBUaGlzIGNvbXBvbmVudCBmaW5kIHRvZGF5IGVsZW1lbnQgYnkgY2xhc3NOYW1lICdbcHJlZml4XXRvZGF5J1xuXHQgKiAgICAgQHBhcmFtIHtzdHJpbmd9IFtvcHRpb24ueWVhclRpdGxlRm9ybWF0ID0gXCJ5eXl5XCJdIEEgeWVhciB0aXRsZSBmb3JtYW50LlxuXHQgKiAgICAgICAgICAgICAgICAgICAgICBUaGlzIGNvbXBvbmVudCBmaW5kIHllYXIgdGl0bGUgZWxlbWVudCBieSBjbGFzc05hbWUgJ1twcmVmaXhdeWVhcidcblx0ICogICAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLm1vbnRoVGl0bGVGb3JtYXQgPSBcIm1cIl0gQSBtb250aCB0aXRsZSBmb3JtYXQuXG5cdCAqICAgICAgICAgICAgICAgICAgICAgVGhpcyBjb21wb25lbnQgZmluZCBtb250aCB0aXRsZSBlbGVtZW50IGJ5IGNsYXNzTmFtZeydtCAnW3ByZWZpeF1tb250aCdcblx0ICogICAgIEBwYXJhbSB7QXJyYXl9IFtvcHRpb24ubW9udGhUaXRsZXMgPSBbXCJKQU5cIixcIkZFQlwiLFwiTUFSXCIsXCJBUFJcIixcIk1BWVwiLFwiSlVOXCIsXCJKVUxcIixcIkFVR1wiLFwiU0VQXCIsXCJPQ1RcIixcIk5PVlwiLFwiREVDXCJdXVxuXHQgKiAgICAgICAgICAgICAgICAgICAgQSBsYWJlbCBvZiBlYWNoIG1vbnRoLlxuXHQgKiAgICAgQHBhcmFtIHtBcnJheX0gW29wdGlvbi5kYXlUaXRsZXMgPSBbXCJTdW5cIixcIk1vblwiLFwiVHVlXCIsXCJXZWRcIixcIlRodVwiLFwiRnJpXCIsXCJTYXRcIl1dIEEgbGFiZWwgZm9yIGRheS5cblx0ICogICAgICAgICAgICAgICAgICAgIElmIHlvdSBzZXQgdGhlIG90aGVyIG9wdGlvbiB0b2RheUZvcm1hdCAnRCcsIHlvdSBjYW4gdXNlIHRoaXMgbmFtZS5cblx0ICogQHR1dG9yaWFsIHNhbXBsZTFcblx0ICogQHR1dG9yaWFsIHNhbXBsZTJcblx0ICogQHR1dG9yaWFsIHNhbXBsZTNcblx0ICogQGV4YW1wbGVcblx0ICogdmFyIGNhbGVuZGFyID0gbmV3IHR1aS5jb21wb25lbnQuQ2FsZW5kYXIoe1xuXHQgKiAgICAgZWxlbWVudDogJyNsYXllcicsXG5cdCAqICAgICBjbGFzc1ByZWZpeDogXCJjYWxlbmRhci1cIixcblx0ICogICAgIHllYXI6IDE5ODMsXG5cdCAqICAgICBtb250aDogNSxcblx0ICogICAgIHRpdGxlRm9ybWF0OiBcInl5eXktbW1cIiwgLy8gdGl0bGVcblx0ICogICAgIHRvZGF5Rm9ybWF0OiBcInl5eXkgLyBtbSAvIGRkIChEKVwiIC8vIHRvZGF5XG5cdCAqICAgICB5ZWFyVGl0bGVGb3JtYXQ6IFwieXl5eVwiLCAvLyB5ZWFyIHRpdGxlXG5cdCAqICAgICBtb250aFRpdGxlRm9ybWF0OiBcIm1cIiwgLy8gbW9udGggdGl0bGVcblx0ICogICAgIG1vbnRoVGl0bGVzOiBbXCJKQU5cIiwgXCJGRUJcIiwgXCJNQVJcIiwgXCJBUFJcIiwgXCJNQVlcIiwgXCJKVU5cIiwgXCJKVUxcIiwgXCJBVUdcIiwgXCJTRVBcIiwgXCJPQ1RcIiwgXCJOT1ZcIiwgXCJERUNcIl0sXG5cdCAqICAgICBkYXlUaXRsZXM6IFsnc3VuJywgJ21vbicsICd0dWUnLCAnd2VkJywgJ3RodScsICdmcmknLCAnc2F0J10gLy8gZGF5c1xuXHQgKiAgICAgaXRlbUNvdW50T2ZZZWFyOiAxMlxuXHQgKiB9KTtcblx0ICovXG5cdHZhciBDYWxlbmRhciA9IHV0aWwuZGVmaW5lQ2xhc3MoLyoqIEBsZW5kcyBDYWxlbmRhci5wcm90b3R5cGUgKi8ge1xuXHQgICAgaW5pdDogZnVuY3Rpb24ob3B0aW9uKSB7XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogU2V0IG9wdGlvbnNcblx0ICAgICAgICAgKiBvcHRpb246IHtcblx0ICAgICAgICAgKiAgICAgY2xhc3NQcmVmaXg6IHN0cmluZyxcblx0ICAgICAgICAgKiAgICAgeWVhcjogbnVtYmVyXG5cdCAgICAgICAgICogICAgIG1vbnRoOiBudW1iZXJcblx0ICAgICAgICAgKiAgICAgdGl0bGVGb3JtYXQ6IHN0cmluZyxcblx0ICAgICAgICAgKiAgICAgdG9kYXlGb3JtYXQ6IHN0cmluZyxcblx0ICAgICAgICAgKiAgICAgeWVhclRpdGxlRm9ybWF0OiBzdHJpbmcsXG5cdCAgICAgICAgICogICAgIG1vbnRoVGl0bGVGb3JtYXQ6IHN0cmluZyxcblx0ICAgICAgICAgKiAgICAgbW9udGhUaXRsZXM6IEFycmF5LFxuXHQgICAgICAgICAqICAgICBkYXlUaXRsZXM6IEFycmF5LFxuXHQgICAgICAgICAqICAgICBpdGVtQ291bnRPZlllYXI6IG51bWJlclxuXHQgICAgICAgICAqIH1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuX29wdGlvbiA9IHt9O1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBBIGRheSB0aGF0IGlzIHNob3duXG5cdCAgICAgICAgICogQHR5cGUge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5fc2hvd25EYXRlID0ge1xuXHQgICAgICAgICAgICB5ZWFyOiAwLFxuXHQgICAgICAgICAgICBtb250aDogMSxcblx0ICAgICAgICAgICAgZGF0ZTogMVxuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cdCAgICAgICAgICogalF1ZXJ5IC0gSFRNTEVsZW1lbnRcblx0ICAgICAgICAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovXG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqID09PT09PT09PVJvb3QgRWxlbWVudD09PT09PT09PVxuXHQgICAgICAgICAqIElmIG9wdGlvbnMgZG8gbm90IGluY2x1ZGUgZWxlbWVudCwgdGhpcyBjb21wb25lbnQgamVkZ2UgaW5pdGlhbGl6ZSBlbGVtZW50IHdpdGhvdXQgb3B0aW9uc1xuXHQgICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLiRlbGVtZW50ID0gJChvcHRpb24uZWxlbWVudCB8fCBhcmd1bWVudHNbMF0pO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiA9PT09PT09PT1IZWFkZXI9PT09PT09PT1cblx0ICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy4kaGVhZGVyID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQSB0aWx0ZVxuXHQgICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLiR0aXRsZSA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqIEEgeWVhciB0aXRsZVxuXHQgICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLiR0aXRsZVllYXIgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBBIG1vbnRoIHRpdGxlXG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuJHRpdGxlTW9udGggPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiA9PT09PT09PT1Cb2R5PT09PT09PT09XG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuJGJvZHkgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBBIHRlbXBsYXRlIG9mIHdlZWtcblx0ICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy4kd2Vla1RlbXBsYXRlID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogQSB3ZWVrIHBhcmVudCBlbGVtZW50XG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuJHdlZWtBcHBlbmRUYXJnZXQgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBBIGRhdGUgZWxlbWVudFxuXHQgICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLl8kZGF0ZUVsZW1lbnQgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBBIGRhdGUgd3JhcHBlciBlbGVtZW50XG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuXyRkYXRlQ29udGFpbmVyRWxlbWVudCA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxuXHQgICAgICAgICAqID09PT09PT09PUZvb3Rlcj09PT09PT09PVxuXHQgICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLiRmb290ZXIgPSBudWxsO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBUb2RheSBlbGVtZW50XG5cdCAgICAgICAgICogQHR5cGUge2pRdWVyeX1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuJHRvZGF5ID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogSW5kZXggb2Ygc2hvd24gbGF5ZXJcblx0ICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5zaG93bkxheWVySWR4ID0gMDtcblx0XG5cdCAgICAgICAgLyoqXG5cdCAgICAgICAgICogRGF0YSBvZiBtb250aCdzIGxheWVyXG5cdCAgICAgICAgICogQHR5cGUge09iamVjdH1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuZGF0YU9mTW9udGhMYXllciA9IHt9O1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBEYXRhIG9mIHllYXIncyBsYXllclxuXHQgICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG5cdCAgICAgICAgICogQHByaXZhdGVcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLmRhdGFPZlllYXJMYXllciA9IHt9O1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBXaGV0aGVyIHRpdGxlIGlzIGNsaWNrYWJsZSBvciBub3Rcblx0ICAgICAgICAgKiBAdHlwZSB7Qm9vbGVhbn1cblx0ICAgICAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMuaXNDbGlja2FibGVUaXRsZSA9IGZhbHNlO1xuXHRcblx0ICAgICAgICAvKipcblx0ICAgICAgICAgKiBIYW5kbGVycyBiaW5kaW5nIGNvbnRleHRcblx0ICAgICAgICAgKiBAdHlwZSB7T2JqZWN0fVxuXHQgICAgICAgICAqIEBwcml2YXRlXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5oYW5kbGVycyA9IHt9O1xuXHRcblx0ICAgICAgICAvKiogU2V0IGRlZmF1bHQgb3B0aW9ucyAqL1xuXHQgICAgICAgIHRoaXMuX3NldERlZmF1bHQob3B0aW9uKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgZGVmdWxhdCBvcGl0b25zXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbl0gQSBvcHRpb25zIHRvIGluaXRpYWx6aWUgY29tcG9uZW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0RGVmYXVsdDogZnVuY3Rpb24ob3B0aW9uKSB7XG5cdCAgICAgICAgdGhpcy5fc2V0T3B0aW9uKG9wdGlvbik7XG5cdCAgICAgICAgdGhpcy5fYXNzaWduSFRNTEVsZW1lbnRzKCk7XG5cdCAgICAgICAgdGhpcy5fYXR0YWNoRXZlbnQoKTtcblx0ICAgICAgICB0aGlzLmRyYXcodGhpcy5fb3B0aW9uLnllYXIsIHRoaXMuX29wdGlvbi5tb250aCwgZmFsc2UsIDApO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNhdmUgb3B0aW9uc1xuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25dIEEgb3B0aW9ucyB0byBpbml0aWFsaXplIGNvbXBvbmVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3NldE9wdGlvbjogZnVuY3Rpb24ob3B0aW9uKSB7XG5cdCAgICAgICAgdmFyIGluc3RhbmNlT3B0aW9uID0gdGhpcy5fb3B0aW9uLFxuXHQgICAgICAgICAgICB0b2RheSA9IGNhbGVuZGFyVXRpbHMuZ2V0RGF0ZUhhc2hUYWJsZSgpO1xuXHRcblx0ICAgICAgICB2YXIgZGVmYXVsdE9wdGlvbiA9IHtcblx0ICAgICAgICAgICAgY2xhc3NQcmVmaXg6ICdjYWxlbmRhci0nLFxuXHQgICAgICAgICAgICB5ZWFyOiB0b2RheS55ZWFyLFxuXHQgICAgICAgICAgICBtb250aDogdG9kYXkubW9udGgsXG5cdCAgICAgICAgICAgIHRpdGxlRm9ybWF0OiAneXl5eS1tbScsXG5cdCAgICAgICAgICAgIHRvZGF5Rm9ybWF0OiAneXl5eS9tbS9kZCAoRCknLFxuXHQgICAgICAgICAgICB5ZWFyVGl0bGVGb3JtYXQ6ICd5eXl5Jyxcblx0ICAgICAgICAgICAgbW9udGhUaXRsZUZvcm1hdDogJ20nLFxuXHQgICAgICAgICAgICBtb250aFRpdGxlczogWydKQU4nLCAnRkVCJywgJ01BUicsICdBUFInLCAnTUFZJywgJ0pVTicsICdKVUwnLCAnQVVHJywgJ1NFUCcsICdPQ1QnLCAnTk9WJywgJ0RFQyddLFxuXHQgICAgICAgICAgICBkYXlUaXRsZXM6IFsnU3VuJywgJ01vbicsICdUdWUnLCAnV2VkJywgJ1RodScsICdGcmknLCAnU2F0J10sXG5cdCAgICAgICAgICAgIGl0ZW1Db3VudE9mWWVhcjogQ09OU1RBTlRTLml0ZW1Db3VudE9mWWVhclxuXHQgICAgICAgIH07XG5cdCAgICAgICAgZXh0ZW5kKGluc3RhbmNlT3B0aW9uLCBkZWZhdWx0T3B0aW9uLCBvcHRpb24pO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBlbGVtZW50IHRvIGZpbGVkXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYXNzaWduSFRNTEVsZW1lbnRzOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgY2xhc3NQcmVmaXggPSB0aGlzLl9vcHRpb24uY2xhc3NQcmVmaXgsXG5cdCAgICAgICAgICAgICRlbGVtZW50ID0gdGhpcy4kZWxlbWVudCxcblx0ICAgICAgICAgICAgY2xhc3NTZWxlY3RvciA9ICcuJyArIGNsYXNzUHJlZml4O1xuXHRcblx0ICAgICAgICB0aGlzLl9hc3NpZ25IZWFkZXIoJGVsZW1lbnQsIGNsYXNzU2VsZWN0b3IsIGNsYXNzUHJlZml4KTtcblx0ICAgICAgICB0aGlzLl9hc3NpZ25Cb2R5KCRlbGVtZW50LCBjbGFzc1NlbGVjdG9yLCBjbGFzc1ByZWZpeCk7XG5cdCAgICAgICAgdGhpcy5fYXNzaWduRm9vdGVyKCRlbGVtZW50LCBjbGFzc1NlbGVjdG9yLCBjbGFzc1ByZWZpeCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmVnaXN0ZXIgaGVhZGVyIGVsZW1lbnQuXG5cdCAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1lbnQgVGhlIHJvb3QgZWxlbWVudCBvZiBjb21wb25lbnRcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1NlbGVjdG9yIEEgY2xhc3Mgc2VsZWN0b3Jcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1ByZWZpeCBBIHByZWZpeCBmb3IgY2xhc3Ncblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9hc3NpZ25IZWFkZXI6IGZ1bmN0aW9uKCRlbGVtZW50LCBjbGFzc1NlbGVjdG9yLCBjbGFzc1ByZWZpeCkge1xuXHQgICAgICAgIHZhciAkaGVhZGVyID0gJGVsZW1lbnQuZmluZChjbGFzc1NlbGVjdG9yICsgJ2hlYWRlcicpLFxuXHQgICAgICAgICAgICBoZWFkZXJUZW1wbGF0ZSxcblx0ICAgICAgICAgICAgZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwLFxuXHQgICAgICAgICAgICBrZXkgPSBDT05TVEFOVFMucmVsYXRpdmVNb250aFZhbHVlS2V5LFxuXHQgICAgICAgICAgICBidG5DbGFzc05hbWUgPSAnYnRuLSc7XG5cdFxuXHQgICAgICAgIGlmICghJGhlYWRlci5sZW5ndGgpIHtcblx0ICAgICAgICAgICAgaGVhZGVyVGVtcGxhdGUgPSBDT05TVEFOVFMuY2FsZW5kYXJIZWFkZXI7XG5cdCAgICAgICAgICAgIGRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cCA9IENPTlNUQU5UUy5kZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHA7XG5cdFxuXHQgICAgICAgICAgICAkaGVhZGVyID0gJChoZWFkZXJUZW1wbGF0ZS5yZXBsYWNlKGRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cCwgY2xhc3NQcmVmaXgpKTtcblx0ICAgICAgICAgICAgJGVsZW1lbnQuYXBwZW5kKCRoZWFkZXIpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gYnV0dG9uXG5cdCAgICAgICAgJGhlYWRlci5maW5kKGNsYXNzU2VsZWN0b3IgKyBidG5DbGFzc05hbWUgKyBDT05TVEFOVFMucHJldlllYXIpLmRhdGEoa2V5LCAtMTIpO1xuXHQgICAgICAgICRoZWFkZXIuZmluZChjbGFzc1NlbGVjdG9yICsgYnRuQ2xhc3NOYW1lICsgQ09OU1RBTlRTLnByZXZNb250aCkuZGF0YShrZXksIC0xKTtcblx0ICAgICAgICAkaGVhZGVyLmZpbmQoY2xhc3NTZWxlY3RvciArIGJ0bkNsYXNzTmFtZSArIENPTlNUQU5UUy5uZXh0WWVhcikuZGF0YShrZXksIDEyKTtcblx0ICAgICAgICAkaGVhZGVyLmZpbmQoY2xhc3NTZWxlY3RvciArIGJ0bkNsYXNzTmFtZSArIENPTlNUQU5UUy5uZXh0TW9udGgpLmRhdGEoa2V5LCAxKTtcblx0XG5cdCAgICAgICAgLy8gdGl0bGUgdGV4dFxuXHQgICAgICAgIHRoaXMuJHRpdGxlID0gJGhlYWRlci5maW5kKGNsYXNzU2VsZWN0b3IgKyAndGl0bGUnKTtcblx0ICAgICAgICB0aGlzLiR0aXRsZVllYXIgPSAkaGVhZGVyLmZpbmQoY2xhc3NTZWxlY3RvciArICd0aXRsZS15ZWFyJyk7XG5cdCAgICAgICAgdGhpcy4kdGl0bGVNb250aCA9ICRoZWFkZXIuZmluZChjbGFzc1NlbGVjdG9yICsgJ3RpdGxlLW1vbnRoJyk7XG5cdFxuXHQgICAgICAgIHRoaXMuJGhlYWRlciA9ICRoZWFkZXI7XG5cdFxuXHQgICAgICAgIGlmICh0aGlzLiR0aXRsZS5oYXNDbGFzcyh0aGlzLl9vcHRpb24uY2xhc3NQcmVmaXggKyBDT05TVEFOVFMuY2xpY2thYmxlKSkge1xuXHQgICAgICAgICAgICB0aGlzLmlzQ2xpY2thYmxlVGl0bGUgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZWdpc3RlciBib2R5IGVsZW1lbnRcblx0ICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkZWxlbWVudCBUaGUgcm9vdCBlbG1lbnQgb2YgY29tcG9uZW50XG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NTZWxlY3RvciBBIHNlbGVjdG9yXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NQcmVmaXggQSBwcmVmaXggZm9yIGNsYXNzXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYXNzaWduQm9keTogZnVuY3Rpb24oJGVsZW1lbnQsIGNsYXNzU2VsZWN0b3IsIGNsYXNzUHJlZml4KSB7XG5cdCAgICAgICAgdmFyICRib2R5ID0gJGVsZW1lbnQuZmluZChjbGFzc1NlbGVjdG9yICsgJ2JvZHknKSxcblx0ICAgICAgICAgICAgYm9keVRlbXBsYXRlLFxuXHQgICAgICAgICAgICBkZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHA7XG5cdFxuXHQgICAgICAgIGlmICghJGJvZHkubGVuZ3RoKSB7XG5cdCAgICAgICAgICAgIGJvZHlUZW1wbGF0ZSA9IENPTlNUQU5UUy5jYWxlbmRhckJvZHk7XG5cdCAgICAgICAgICAgIGRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cCA9IENPTlNUQU5UUy5kZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHA7XG5cdFxuXHQgICAgICAgICAgICAkYm9keSA9ICQoYm9keVRlbXBsYXRlLnJlcGxhY2UoZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwLCBjbGFzc1ByZWZpeCkpO1xuXHQgICAgICAgICAgICAkZWxlbWVudC5hcHBlbmQoJGJvZHkpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5fYXNzaWduV2VlayhjbGFzc1NlbGVjdG9yKTtcblx0ICAgICAgICB0aGlzLl9hc3NpZ25Nb250aExheWVyKGNsYXNzU2VsZWN0b3IpO1xuXHQgICAgICAgIHRoaXMuX2Fzc2lnblllYXJMYXllcihjbGFzc1NlbGVjdG9yKTtcblx0XG5cdCAgICAgICAgdGhpcy4kYm9keSA9ICRib2R5LmhpZGUoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZWdpc3RlciB3ZWVrIGVsZW1udCBvbiBib2R5XG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NTZWxlY3RvciBBIHNlbGVjdG9yXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYXNzaWduV2VlazogZnVuY3Rpb24oY2xhc3NTZWxlY3Rvcikge1xuXHQgICAgICAgIHZhciAkYm9keSA9IHRoaXMuJGVsZW1lbnQuZmluZChjbGFzc1NlbGVjdG9yICsgJ2JvZHknKTtcblx0ICAgICAgICB2YXIgJHdlZWtUZW1wbGF0ZSA9ICRib2R5LmZpbmQoY2xhc3NTZWxlY3RvciArICd3ZWVrJyk7XG5cdFxuXHQgICAgICAgIHRoaXMuJHdlZWtUZW1wbGF0ZSA9ICR3ZWVrVGVtcGxhdGUuY2xvbmUodHJ1ZSk7XG5cdCAgICAgICAgdGhpcy4kd2Vla0FwcGVuZFRhcmdldCA9ICR3ZWVrVGVtcGxhdGUucGFyZW50KCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmVnaXN0ZXIgZWxlbWVudCBvZiBtb250aCdzIGxheWVyIGFuZCBzYXZlIGRyYXdpbmcgaW5mb1xuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzU2VsZWN0b3IgQSBzZWxlY3RvclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2Fzc2lnbk1vbnRoTGF5ZXI6IGZ1bmN0aW9uKGNsYXNzU2VsZWN0b3IpIHtcblx0ICAgICAgICB2YXIgJGJvZHkgPSB0aGlzLiRlbGVtZW50LmZpbmQoY2xhc3NTZWxlY3RvciArICdib2R5Jyk7XG5cdCAgICAgICAgdmFyICRtb250aHNUZW1wbGF0ZSA9ICRib2R5LmZpbmQoY2xhc3NTZWxlY3RvciArICdtb250aC1ncm91cCcpO1xuXHQgICAgICAgIHZhciBjb2xzID0gJG1vbnRoc1RlbXBsYXRlLmZpbmQoY2xhc3NTZWxlY3RvciArICdtb250aCcpLmxlbmd0aDtcblx0ICAgICAgICB2YXIgcm93cyA9IE1hdGguY2VpbCh0aGlzLl9vcHRpb24ubW9udGhUaXRsZXMubGVuZ3RoIC8gY29scyk7XG5cdFxuXHQgICAgICAgIHRoaXMuZGF0YU9mTW9udGhMYXllciA9IHtcblx0ICAgICAgICAgICAgdGVtcGxhdGU6ICRtb250aHNUZW1wbGF0ZS5jbG9uZSh0cnVlKSxcblx0ICAgICAgICAgICAgYXBwZW5kZWRUYXJnZXQ6ICRtb250aHNUZW1wbGF0ZS5wYXJlbnQoKSxcblx0ICAgICAgICAgICAgZnJhbWU6IHtcblx0ICAgICAgICAgICAgICAgIGNvbHM6IGNvbHMsXG5cdCAgICAgICAgICAgICAgICByb3dzOiByb3dzXG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJlZ2lzdGVyIGVsZW1lbnQgb2YgeWVhcidzIGxheWVyIGFuZCBzYXZlIGRyYXdpbmcgaW5mb1xuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzU2VsZWN0b3IgQSBzZWxlY3RvclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2Fzc2lnblllYXJMYXllcjogZnVuY3Rpb24oY2xhc3NTZWxlY3Rvcikge1xuXHQgICAgICAgIHZhciAkYm9keSA9IHRoaXMuJGVsZW1lbnQuZmluZChjbGFzc1NlbGVjdG9yICsgJ2JvZHknKTtcblx0ICAgICAgICB2YXIgJHllYXJzVGVtcGxhdGUgPSAkYm9keS5maW5kKGNsYXNzU2VsZWN0b3IgKyAneWVhci1ncm91cCcpO1xuXHQgICAgICAgIHZhciBjb2xzID0gJHllYXJzVGVtcGxhdGUuZmluZChjbGFzc1NlbGVjdG9yICsgJ3llYXInKS5sZW5ndGg7XG5cdCAgICAgICAgdmFyIHJvd3MgPSBNYXRoLmNlaWwodGhpcy5fb3B0aW9uLml0ZW1Db3VudE9mWWVhciAvIGNvbHMpO1xuXHRcblx0ICAgICAgICB0aGlzLmRhdGFPZlllYXJMYXllciA9IHtcblx0ICAgICAgICAgICAgdGVtcGxhdGU6ICR5ZWFyc1RlbXBsYXRlLmNsb25lKHRydWUpLFxuXHQgICAgICAgICAgICBhcHBlbmRlZFRhcmdldDogJHllYXJzVGVtcGxhdGUucGFyZW50KCksXG5cdCAgICAgICAgICAgIGZyYW1lOiB7XG5cdCAgICAgICAgICAgICAgICBjb2xzOiBjb2xzLFxuXHQgICAgICAgICAgICAgICAgcm93czogcm93c1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZWdpc3RlciBmb290ZXIgZWxlbWVudFxuXHQgICAgICogQHBhcmFtIHtqUXVlcnl9ICRlbGVtZW50IFRoZSByb290IGVsZW1lbnQgb2YgY29tcG9uZW50XG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NTZWxlY3RvciBBIHNlbGVjdG9yXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NQcmVmaXggQSBwcmVmaXggZm9yIGNsYXNzXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfYXNzaWduRm9vdGVyOiBmdW5jdGlvbigkZWxlbWVudCwgY2xhc3NTZWxlY3RvciwgY2xhc3NQcmVmaXgpIHtcblx0ICAgICAgICB2YXIgJGZvb3RlciA9ICRlbGVtZW50LmZpbmQoY2xhc3NTZWxlY3RvciArICdmb290ZXInKSxcblx0ICAgICAgICAgICAgZm9vdGVyVGVtcGxhdGUsXG5cdCAgICAgICAgICAgIGRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cDtcblx0XG5cdCAgICAgICAgaWYgKCEkZm9vdGVyLmxlbmd0aCkge1xuXHQgICAgICAgICAgICBmb290ZXJUZW1wbGF0ZSA9IENPTlNUQU5UUy5jYWxlbmRhckZvb3Rlcjtcblx0ICAgICAgICAgICAgZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwID0gQ09OU1RBTlRTLmRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cDtcblx0XG5cdCAgICAgICAgICAgICRmb290ZXIgPSAkKGZvb3RlclRlbXBsYXRlLnJlcGxhY2UoZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwLCBjbGFzc1ByZWZpeCkpO1xuXHQgICAgICAgICAgICAkZWxlbWVudC5hcHBlbmQoJGZvb3Rlcik7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMuJHRvZGF5ID0gJGZvb3Rlci5maW5kKGNsYXNzU2VsZWN0b3IgKyAndG9kYXknKTtcblx0ICAgICAgICB0aGlzLiRmb290ZXIgPSAkZm9vdGVyO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBldmVudCBoYW5kbGVycyBhbmQgYXR0YWNoIGV2ZW50IG9uIGVsZW1lbnRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9hdHRhY2hFdmVudDogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdGhpcy5oYW5kbGVycy5jbGlja1JvbGxvdmVyQnRuID0gYmluZCh0aGlzLl9vbkNsaWNrUm9sbG92ZXJCdXR0b24sIHRoaXMpO1xuXHRcblx0ICAgICAgICB0aGlzLmF0dGFjaEV2ZW50VG9Sb2xsb3ZlckJ0bigpO1xuXHRcblx0ICAgICAgICBleHRlbmQodGhpcy5oYW5kbGVycywge1xuXHQgICAgICAgICAgICBjbGlja1RpdGxlOiBiaW5kKHRoaXMuX29uQ2xpY2tUaXRsZSwgdGhpcyksXG5cdCAgICAgICAgICAgIGNsaWNrWWVhckxheWVyOiBiaW5kKHRoaXMuX29uQ2xpY2tZZWFyTGF5ZXIsIHRoaXMpLFxuXHQgICAgICAgICAgICBjbGlja01vbnRoTGF5ZXI6IGJpbmQodGhpcy5fb25DbGlja01vbnRoTGF5ZXIsIHRoaXMpXG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIGlmICh0aGlzLmlzQ2xpY2thYmxlVGl0bGUpIHtcblx0ICAgICAgICAgICAgdGhpcy5hdHRhY2hFdmVudFRvVGl0bGUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5hdHRhY2hFdmVudFRvQm9keSgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEF0dGFjaCBldmVudCBvbiByb2xsb3ZlciBidXR0b25zIGluIFwiaGVhZGVyXCIgZWxlbWVudFxuXHQgICAgICovXG5cdCAgICBhdHRhY2hFdmVudFRvUm9sbG92ZXJCdG46IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHZhciBzZWxlY3RvciA9ICcuJyArIHRoaXMuX29wdGlvbi5jbGFzc1ByZWZpeCArICdyb2xsb3Zlcic7XG5cdCAgICAgICAgdmFyIGJ0bnMgPSB0aGlzLiRoZWFkZXIuZmluZChzZWxlY3Rvcik7XG5cdFxuXHQgICAgICAgIGJ0bnMub24oJ2NsaWNrJywgdGhpcy5oYW5kbGVycy5jbGlja1JvbGxvdmVyQnRuKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBEZXRhY2ggZXZlbnQgb24gcm9sbG92ZXIgYnV0dG9ucyBpbiBcImhlYWRlclwiIGVsZW1lbnRcblx0ICAgICAqL1xuXHQgICAgZGV0YWNoRXZlbnRUb1JvbGxvdmVyQnRuOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgc2VsZWN0b3IgPSAnLicgKyB0aGlzLl9vcHRpb24uY2xhc3NQcmVmaXggKyAncm9sbG92ZXInO1xuXHQgICAgICAgIHZhciBidG5zID0gdGhpcy4kaGVhZGVyLmZpbmQoc2VsZWN0b3IpO1xuXHRcblx0ICAgICAgICBidG5zLm9mZignY2xpY2snLCB0aGlzLmhhbmRsZXJzLmNsaWNrUm9sbG92ZXJCdG4pO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEF0dGFjaCBldmVudCBvbiB0aXRsZSBpbiBcImhlYWRlclwiIGVsZW1lbnRcblx0ICAgICAqL1xuXHQgICAgYXR0YWNoRXZlbnRUb1RpdGxlOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aGlzLiR0aXRsZS5vbignY2xpY2snLCB0aGlzLmhhbmRsZXJzLmNsaWNrVGl0bGUpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERldGFjaCBldmVudCBvbiB0aXRsZSBpbiBcImhlYWRlclwiIGVsZW1lbnRcblx0ICAgICAqL1xuXHQgICAgZGV0YWNoRXZlbnRUb1RpdGxlOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB0aGlzLiR0aXRsZS5vZmYoJ2NsaWNrJywgdGhpcy5oYW5kbGVycy5jbGlja1RpdGxlKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBBdHRhY2ggZXZlbnQgb24gdGl0bGUgaW4gXCJib2R5XCIgZWxlbWVudCAobW9udGggJiB5ZWFyIGxheWVyKVxuXHQgICAgICovXG5cdCAgICBhdHRhY2hFdmVudFRvQm9keTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGNsYXNzUHJlZml4ID0gJy4nICsgdGhpcy5fb3B0aW9uLmNsYXNzUHJlZml4O1xuXHQgICAgICAgIHZhciB5ZWFyTGF5ZXIgPSB0aGlzLmRhdGFPZlllYXJMYXllci5hcHBlbmRlZFRhcmdldDtcblx0ICAgICAgICB2YXIgbW9udGhMYXllciA9IHRoaXMuZGF0YU9mTW9udGhMYXllci5hcHBlbmRlZFRhcmdldDtcblx0XG5cdCAgICAgICAgeWVhckxheWVyLm9uKCdjbGljaycsIGNsYXNzUHJlZml4ICsgJ3llYXInLCB0aGlzLmhhbmRsZXJzLmNsaWNrWWVhckxheWVyKTtcblx0ICAgICAgICBtb250aExheWVyLm9uKCdjbGljaycsIGNsYXNzUHJlZml4ICsgJ21vbnRoJywgdGhpcy5oYW5kbGVycy5jbGlja01vbnRoTGF5ZXIpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERldGFjaCBldmVudCBvbiB0aXRsZSBpbiBcImJvZHlcIiBlbGVtZW50IChtb250aCAmIHllYXIgbGF5ZXIpXG5cdCAgICAgKi9cblx0ICAgIGRldGFjaEV2ZW50VG9Cb2R5OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgY2xhc3NQcmVmaXggPSAnLicgKyB0aGlzLl9vcHRpb24uY2xhc3NQcmVmaXg7XG5cdCAgICAgICAgdmFyIHllYXJMYXllciA9IHRoaXMuZGF0YU9mWWVhckxheWVyLmFwcGVuZGVkVGFyZ2V0O1xuXHQgICAgICAgIHZhciBtb250aExheWVyID0gdGhpcy5kYXRhT2ZNb250aExheWVyLmFwcGVuZGVkVGFyZ2V0O1xuXHRcblx0ICAgICAgICB5ZWFyTGF5ZXIub2ZmKCdjbGljaycsIGNsYXNzUHJlZml4ICsgJ3llYXInLCB0aGlzLmhhbmRsZXJzLmNsaWNrWWVhckxheWVyKTtcblx0ICAgICAgICBtb250aExheWVyLm9mZignY2xpY2snLCBjbGFzc1ByZWZpeCArICdtb250aCcsIHRoaXMuaGFuZGxlcnMuY2xpY2tNb250aExheWVyKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIC0gY2xpY2sgb24gcm9sbG92ZXIgYnV0dG9uc1xuXHQgICAgICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudCAtIE1vdXNlIGV2ZW50XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfb25DbGlja1JvbGxvdmVyQnV0dG9uOiBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgIHZhciByZWxhdGl2ZU1vbnRoVmFsdWUgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoQ09OU1RBTlRTLnJlbGF0aXZlTW9udGhWYWx1ZUtleSk7XG5cdCAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICB0aGlzLmRyYXcoMCwgcmVsYXRpdmVNb250aFZhbHVlLCB0cnVlKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIC0gY2xpY2sgb24gdGl0bGVcblx0ICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZlbnQgLSBNb3VzZSBldmVudFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX29uQ2xpY2tUaXRsZTogZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICB2YXIgc2hvd25MYXllcklkeCA9IHRoaXMuc2hvd25MYXllcklkeDtcblx0ICAgICAgICB2YXIgZGF0ZTtcblx0XG5cdCAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XG5cdCAgICAgICAgaWYgKHNob3duTGF5ZXJJZHggPT09IDIpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgc2hvd25MYXllcklkeCA9IChzaG93bkxheWVySWR4ICE9PSAyKSA/IChzaG93bkxheWVySWR4ICsgMSkgOiAwO1xuXHQgICAgICAgIGRhdGUgPSB0aGlzLmdldERhdGUoKTtcblx0XG5cdCAgICAgICAgdGhpcy5kcmF3KGRhdGUueWVhciwgZGF0ZS5tb250aCwgZmFsc2UsIHNob3duTGF5ZXJJZHgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEV2ZW50IGhhbmRsZXIgLSBjbGljayBvbiBtb250aCdzIGxheWVyXG5cdCAgICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50IC0gTW91c2UgZXZlbnRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9vbkNsaWNrWWVhckxheWVyOiBmdW5jdGlvbihldmVudCkge1xuXHQgICAgICAgIHZhciByZWxhdGl2ZU1vbnRoVmFsdWUgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoQ09OU1RBTlRTLnJlbGF0aXZlTW9udGhWYWx1ZUtleSk7XG5cdCAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0ICAgICAgICB0aGlzLmRyYXcoMCwgcmVsYXRpdmVNb250aFZhbHVlLCB0cnVlLCAxKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBFdmVudCBoYW5kbGVyIC0gY2xpY2sgb24geWVhcidzIGxheWVyXG5cdCAgICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50IC0gTW91c2UgZXZlbnRcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9vbkNsaWNrTW9udGhMYXllcjogZnVuY3Rpb24oZXZlbnQpIHtcblx0ICAgICAgICB2YXIgcmVsYXRpdmVNb250aFZhbHVlID0gJChldmVudC5jdXJyZW50VGFyZ2V0KS5kYXRhKENPTlNUQU5UUy5yZWxhdGl2ZU1vbnRoVmFsdWVLZXkpO1xuXHQgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgdGhpcy5kcmF3KDAsIHJlbGF0aXZlTW9udGhWYWx1ZSwgdHJ1ZSwgMCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IEhhc2ggZGF0YSB0byBkcm93IGNhbGVuZGFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG5cdCAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc1JlbGF0aXZlXSAgV2hldGhlciBpcyByZWxhdGVkIG90aGVyIHZhbHVlIG9yIG5vdFxuXHQgICAgICogQHJldHVybnMge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBBIGRhdGUgaGFzaFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2dldERhdGVGb3JEcmF3aW5nOiBmdW5jdGlvbih5ZWFyLCBtb250aCwgaXNSZWxhdGl2ZSkge1xuXHQgICAgICAgIHZhciBuRGF0ZSA9IHRoaXMuZ2V0RGF0ZSgpLFxuXHQgICAgICAgICAgICByZWxhdGl2ZURhdGU7XG5cdFxuXHQgICAgICAgIG5EYXRlLmRhdGUgPSAxO1xuXHQgICAgICAgIGlmICghdXRpbC5pc051bWJlcih5ZWFyKSAmJiAhdXRpbC5pc051bWJlcihtb250aCkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIG5EYXRlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKGlzUmVsYXRpdmUpIHtcblx0ICAgICAgICAgICAgcmVsYXRpdmVEYXRlID0gY2FsZW5kYXJVdGlscy5nZXRSZWxhdGl2ZURhdGUoeWVhciwgbW9udGgsIDAsIG5EYXRlKTtcblx0ICAgICAgICAgICAgbkRhdGUueWVhciA9IHJlbGF0aXZlRGF0ZS55ZWFyO1xuXHQgICAgICAgICAgICBuRGF0ZS5tb250aCA9IHJlbGF0aXZlRGF0ZS5tb250aDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBuRGF0ZS55ZWFyID0geWVhciB8fCBuRGF0ZS55ZWFyO1xuXHQgICAgICAgICAgICBuRGF0ZS5tb250aCA9IG1vbnRoIHx8IG5EYXRlLm1vbnRoO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIG5EYXRlO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEp1ZGdlIHRvIHJlZHJhdyBjYWxlbmRhclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSB5ZWFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gbW9udGggQSBtb250aFxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlZmxvd1xuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2lzTmVjZXNzYXJ5Rm9yRHJhd2luZzogZnVuY3Rpb24oeWVhciwgbW9udGgpIHtcblx0ICAgICAgICB2YXIgc2hvd25EYXRlID0gdGhpcy5fc2hvd25EYXRlO1xuXHRcblx0ICAgICAgICByZXR1cm4gKHNob3duRGF0ZS55ZWFyICE9PSB5ZWFyIHx8IHNob3duRGF0ZS5tb250aCAhPT0gbW9udGgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERyYXcgY2FsZW5kYXIgdGV4dFxuXHQgICAgICogQHBhcmFtIHt7eWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyfX0gZGF0ZUZvckRyYXdpbmcgVGhhIGhhc2ggdGhhdCBzaG93IHVwIG9uIGNhbGVuZGFyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0Q2FsZW5kYXJUZXh0OiBmdW5jdGlvbihkYXRlRm9yRHJhd2luZykge1xuXHQgICAgICAgIHZhciB5ZWFyID0gZGF0ZUZvckRyYXdpbmcueWVhcixcblx0ICAgICAgICAgICAgbW9udGggPSBkYXRlRm9yRHJhd2luZy5tb250aDtcblx0XG5cdCAgICAgICAgdGhpcy5fc2V0Q2FsZW5kYXJUb2RheSgpO1xuXHQgICAgICAgIHRoaXMuX3NldENhbGVuZGFyVGl0bGUoeWVhciwgbW9udGgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERyYXcgZGF0ZXMgYnkgbW9udGguXG5cdCAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyBBIGRhdGUgdG8gZHJhd1xuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzUHJlZml4IEEgY2xhc3MgcHJlZml4XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfZHJhd0RhdGVzOiBmdW5jdGlvbihkYXRlRm9yRHJhd2luZywgY2xhc3NQcmVmaXgpIHtcblx0ICAgICAgICB2YXIgeWVhciA9IGRhdGVGb3JEcmF3aW5nLnllYXIsXG5cdCAgICAgICAgICAgIG1vbnRoID0gZGF0ZUZvckRyYXdpbmcubW9udGgsXG5cdCAgICAgICAgICAgIGRheUluV2VlayA9IDAsXG5cdCAgICAgICAgICAgIGRhdGVQcmV2TW9udGggPSBjYWxlbmRhclV0aWxzLmdldFJlbGF0aXZlRGF0ZSgwLCAtMSwgMCwgZGF0ZUZvckRyYXdpbmcpLFxuXHQgICAgICAgICAgICBkYXRlTmV4dE1vbnRoID0gY2FsZW5kYXJVdGlscy5nZXRSZWxhdGl2ZURhdGUoMCwgMSwgMCwgZGF0ZUZvckRyYXdpbmcpLFxuXHQgICAgICAgICAgICBkYXRlcyA9IFtdLFxuXHQgICAgICAgICAgICBmaXJzdERheSA9IGNhbGVuZGFyVXRpbHMuZ2V0Rmlyc3REYXkoeWVhciwgbW9udGgpLFxuXHQgICAgICAgICAgICBpbmRleE9mTGFzdERhdGUgPSB0aGlzLl9maWxsRGF0ZXMoeWVhciwgbW9udGgsIGRhdGVzKTtcblx0XG5cdCAgICAgICAgdXRpbC5mb3JFYWNoKGRhdGVzLCBmdW5jdGlvbihkYXRlLCBpKSB7XG5cdCAgICAgICAgICAgIHZhciBpc1ByZXZNb250aCA9IGZhbHNlLFxuXHQgICAgICAgICAgICAgICAgaXNOZXh0TW9udGggPSBmYWxzZSxcblx0ICAgICAgICAgICAgICAgICRkYXRlQ29udGFpbmVyID0gJCh0aGlzLl8kZGF0ZUNvbnRhaW5lckVsZW1lbnRbaV0pLFxuXHQgICAgICAgICAgICAgICAgdGVtcFllYXIgPSB5ZWFyLFxuXHQgICAgICAgICAgICAgICAgdGVtcE1vbnRoID0gbW9udGgsXG5cdCAgICAgICAgICAgICAgICBldmVudERhdGE7XG5cdFxuXHQgICAgICAgICAgICBpZiAoaSA8IGZpcnN0RGF5KSB7XG5cdCAgICAgICAgICAgICAgICBpc1ByZXZNb250aCA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAkZGF0ZUNvbnRhaW5lci5hZGRDbGFzcyhjbGFzc1ByZWZpeCArIENPTlNUQU5UUy5wcmV2TW9udGgpO1xuXHQgICAgICAgICAgICAgICAgdGVtcFllYXIgPSBkYXRlUHJldk1vbnRoLnllYXI7XG5cdCAgICAgICAgICAgICAgICB0ZW1wTW9udGggPSBkYXRlUHJldk1vbnRoLm1vbnRoO1xuXHQgICAgICAgICAgICB9IGVsc2UgaWYgKGkgPiBpbmRleE9mTGFzdERhdGUpIHtcblx0ICAgICAgICAgICAgICAgIGlzTmV4dE1vbnRoID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICRkYXRlQ29udGFpbmVyLmFkZENsYXNzKGNsYXNzUHJlZml4ICsgQ09OU1RBTlRTLm5leHRNb250aCk7XG5cdCAgICAgICAgICAgICAgICB0ZW1wWWVhciA9IGRhdGVOZXh0TW9udGgueWVhcjtcblx0ICAgICAgICAgICAgICAgIHRlbXBNb250aCA9IGRhdGVOZXh0TW9udGgubW9udGg7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIC8vIFdlZWtlbmRcblx0ICAgICAgICAgICAgdGhpcy5fc2V0V2Vla2VuZChkYXlJbldlZWssICRkYXRlQ29udGFpbmVyLCBjbGFzc1ByZWZpeCk7XG5cdFxuXHQgICAgICAgICAgICAvLyBUb2RheVxuXHQgICAgICAgICAgICBpZiAodGhpcy5faXNUb2RheSh0ZW1wWWVhciwgdGVtcE1vbnRoLCBkYXRlKSkge1xuXHQgICAgICAgICAgICAgICAgJGRhdGVDb250YWluZXIuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyAndG9kYXknKTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgZXZlbnREYXRhID0ge1xuXHQgICAgICAgICAgICAgICAgJGRhdGU6ICQodGhpcy5fJGRhdGVFbGVtZW50LmdldChpKSksXG5cdCAgICAgICAgICAgICAgICAkZGF0ZUNvbnRhaW5lcjogJGRhdGVDb250YWluZXIsXG5cdCAgICAgICAgICAgICAgICB5ZWFyOiB0ZW1wWWVhcixcblx0ICAgICAgICAgICAgICAgIG1vbnRoOiB0ZW1wTW9udGgsXG5cdCAgICAgICAgICAgICAgICBkYXRlOiBkYXRlLFxuXHQgICAgICAgICAgICAgICAgaXNQcmV2TW9udGg6IGlzUHJldk1vbnRoLFxuXHQgICAgICAgICAgICAgICAgaXNOZXh0TW9udGg6IGlzTmV4dE1vbnRoLFxuXHQgICAgICAgICAgICAgICAgaHRtbDogZGF0ZVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAkKGV2ZW50RGF0YS4kZGF0ZSkuaHRtbChldmVudERhdGEuaHRtbC50b1N0cmluZygpKTtcblx0ICAgICAgICAgICAgZGF5SW5XZWVrID0gKGRheUluV2VlayArIDEpICUgNztcblx0XG5cdCAgICAgICAgICAgIC8qKlxuXHQgICAgICAgICAgICAgKiBGaXJlIGRyYXcgZXZlbnQgd2hlbiBjYWxlbmRhciBkcmF3IGVhY2ggZGF0ZS5cblx0ICAgICAgICAgICAgICogQGFwaVxuXHQgICAgICAgICAgICAgKiBAZXZlbnQgQ2FsZW5kYXIjZHJhd1xuXHQgICAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBBIG5hbWUgb2YgY3VzdG9tIGV2ZW50XG5cdCAgICAgICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNQcmV2TW9udGggV2hldGhlciB0aGUgZHJhdyBkYXkgaXMgbGFzdCBtb250aCBvciBub3Rcblx0ICAgICAgICAgICAgICogQHBhcmFtIHtib29sZWFufSBpc05leHRNb250aCBXZWh0ZXIgdGhlIGRyYXcgZGF5IGlzIG5leHQgbW9udGggb3Igbm90XG5cdCAgICAgICAgICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkZGF0ZSBUaGUgZWxlbWVudCBoYXZlIGRhdGUgaHRtbFxuXHQgICAgICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGRhdGVDb250YWluZXIgQ2hpbGQgZWxlbWVudCB0aGF0IGhhcyBjbGFzc05hbWUgW3ByZWZpeF13ZWVrLlxuXHQgICAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSXQgaXMgcG9zc2libGUgdGhpcyBlbGVtZW50IGVxdWVsIGVsRGF0ZS5cblx0ICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUgQSBkcmF3IGRhdGVcblx0ICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgZHJhdyBtb250aFxuXHQgICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIGRyYXcgeWVhclxuXHQgICAgICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gaHRtbCBBIGh0bWwgc3RyaW5nXG5cdCAgICAgICAgICAgICAqIEBleGFtcGxlXG5cdCAgICAgICAgICAgICAqIC8vIGRyYXcgY3VzdG9tIGV2ZW4gaGFuZGxlcnNcblx0ICAgICAgICAgICAgICogY2FsZW5kYXIub24oJ2RyYXcnLCBmdW5jdGlvbihkcmF3RXZlbnQpeyAuLi4gfSk7XG5cdCAgICAgICAgICAgICAqKi9cblx0ICAgICAgICAgICAgdGhpcy5maXJlKCdkcmF3JywgZXZlbnREYXRhKTtcblx0ICAgICAgICB9LCB0aGlzKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBKZWRnZSB0aGUgaW5wdXQgZGF0ZSBpcyB0b2RheS5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlIEEgZGF0ZVxuXHQgICAgICogQHJldHVybnMge2Jvb2xlYW59XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfaXNUb2RheTogZnVuY3Rpb24oeWVhciwgbW9udGgsIGRhdGUpIHtcblx0ICAgICAgICB2YXIgdG9kYXkgPSBjYWxlbmRhclV0aWxzLmdldERhdGVIYXNoVGFibGUoKTtcblx0ICAgICAgICB2YXIgaXNZZWFyID0geWVhciA/ICh0b2RheS55ZWFyID09PSB5ZWFyKSA6IHRydWU7XG5cdCAgICAgICAgdmFyIGlzTW9udGggPSBtb250aCA/ICh0b2RheS5tb250aCA9PT0gbW9udGgpIDogdHJ1ZTtcblx0ICAgICAgICB2YXIgaXNEYXRlID0gZGF0ZSA/ICh0b2RheS5kYXRlID09PSBkYXRlKSA6IHRydWU7XG5cdFxuXHQgICAgICAgIHJldHVybiBpc1llYXIgJiYgaXNNb250aCAmJiBpc0RhdGU7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTWFrZSBvbmUgd2VlayB0ZW1wYXRlLlxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgIEEgeWVhclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXRXZWVrczogZnVuY3Rpb24oeWVhciwgbW9udGgpIHtcblx0ICAgICAgICB2YXIgJGVsV2Vlayxcblx0ICAgICAgICAgICAgd2Vla3MgPSBjYWxlbmRhclV0aWxzLmdldFdlZWtzKHllYXIsIG1vbnRoKSxcblx0ICAgICAgICAgICAgaTtcblx0ICAgICAgICBmb3IgKGkgPSAwOyBpIDwgd2Vla3M7IGkgKz0gMSkge1xuXHQgICAgICAgICAgICAkZWxXZWVrID0gdGhpcy4kd2Vla1RlbXBsYXRlLmNsb25lKHRydWUpO1xuXHQgICAgICAgICAgICAkZWxXZWVrLmFwcGVuZFRvKHRoaXMuJHdlZWtBcHBlbmRUYXJnZXQpO1xuXHQgICAgICAgICAgICB0aGlzLl93ZWVrRWxlbWVudHMucHVzaCgkZWxXZWVrKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2F2ZSBkcmF3IGRhdGVzIHRvIGFycmF5XG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30geWVhciBBIGRyYXcgeWVhclxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IG1vbnRoIEEgZHJhdyBtb250aFxuXHQgICAgICogQHBhcmFtIHtBcnJheX0gZGF0ZXMgQSBkcmF3IGRhdGVcblx0ICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IGluZGV4IG9mIGxhc3QgZGF0ZVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2ZpbGxEYXRlczogZnVuY3Rpb24oeWVhciwgbW9udGgsIGRhdGVzKSB7XG5cdCAgICAgICAgdmFyIGZpcnN0RGF5ID0gY2FsZW5kYXJVdGlscy5nZXRGaXJzdERheSh5ZWFyLCBtb250aCksXG5cdCAgICAgICAgICAgIGxhc3REYXkgPSBjYWxlbmRhclV0aWxzLmdldExhc3REYXkoeWVhciwgbW9udGgpLFxuXHQgICAgICAgICAgICBsYXN0RGF0ZSA9IGNhbGVuZGFyVXRpbHMuZ2V0TGFzdERhdGUoeWVhciwgbW9udGgpLFxuXHQgICAgICAgICAgICBkYXRlUHJldk1vbnRoID0gY2FsZW5kYXJVdGlscy5nZXRSZWxhdGl2ZURhdGUoMCwgLTEsIDAsIHtcblx0ICAgICAgICAgICAgICAgIHllYXI6IHllYXIsXG5cdCAgICAgICAgICAgICAgICBtb250aDogbW9udGgsXG5cdCAgICAgICAgICAgICAgICBkYXRlOiAxXG5cdCAgICAgICAgICAgIH0pLFxuXHQgICAgICAgICAgICBwcmV2TW9udGhMYXN0RGF0ZSA9IGNhbGVuZGFyVXRpbHMuZ2V0TGFzdERhdGUoZGF0ZVByZXZNb250aC55ZWFyLCBkYXRlUHJldk1vbnRoLm1vbnRoKSxcblx0ICAgICAgICAgICAgaW5kZXhPZkxhc3REYXRlLFxuXHQgICAgICAgICAgICBpO1xuXHRcblx0ICAgICAgICBpZiAoZmlyc3REYXkgPiAwKSB7XG5cdCAgICAgICAgICAgIGZvciAoaSA9IHByZXZNb250aExhc3REYXRlIC0gZmlyc3REYXk7IGkgPCBwcmV2TW9udGhMYXN0RGF0ZTsgaSArPSAxKSB7XG5cdCAgICAgICAgICAgICAgICBkYXRlcy5wdXNoKGkgKyAxKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBmb3IgKGkgPSAxOyBpIDwgbGFzdERhdGUgKyAxOyBpICs9IDEpIHtcblx0ICAgICAgICAgICAgZGF0ZXMucHVzaChpKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaW5kZXhPZkxhc3REYXRlID0gZGF0ZXMubGVuZ3RoIC0gMTtcblx0ICAgICAgICBmb3IgKGkgPSAxOyBpIDwgNyAtIGxhc3REYXk7IGkgKz0gMSkge1xuXHQgICAgICAgICAgICBkYXRlcy5wdXNoKGkpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGluZGV4T2ZMYXN0RGF0ZTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgd2Vla2VuZFxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IGRheSBBIGRhdGVcblx0ICAgICAqIEBwYXJhbSB7alF1ZXJ5fSAkZGF0ZUNvbnRhaW5lciBBIGNvbnRhaW5lciBlbGVtZW50IGZvciBkYXRlXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NQcmVmaXggQSBwcmVmaXggb2YgY2xhc3Ncblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXRXZWVrZW5kOiBmdW5jdGlvbihkYXksICRkYXRlQ29udGFpbmVyLCBjbGFzc1ByZWZpeCkge1xuXHQgICAgICAgIGlmIChkYXkgPT09IDApIHtcblx0ICAgICAgICAgICAgJGRhdGVDb250YWluZXIuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyAnc3VuJyk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChkYXkgPT09IDYpIHtcblx0ICAgICAgICAgICAgJGRhdGVDb250YWluZXIuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyAnc2F0Jyk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENsZWFyIGNhbGVuZGFyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfY2xlYXI6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHRoaXMuX3dlZWtFbGVtZW50cyA9IFtdO1xuXHQgICAgICAgIHRoaXMuJHdlZWtBcHBlbmRUYXJnZXQuZW1wdHkoKTtcblx0ICAgICAgICB0aGlzLmRhdGFPZk1vbnRoTGF5ZXIuYXBwZW5kZWRUYXJnZXQuZW1wdHkoKTtcblx0ICAgICAgICB0aGlzLmRhdGFPZlllYXJMYXllci5hcHBlbmRlZFRhcmdldC5lbXB0eSgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERyYXcgdGl0bGUgd2l0aCBmb3JtYXQgb3B0aW9uLlxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSB2YWx1ZSBvZiB5ZWFyIChleC4gMjAwOClcblx0ICAgICAqIEBwYXJhbSB7KG51bWJlcnxzdHJpbmcpfSBtb250aCBBIG1vbnRoICgxIH4gMTIpXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICoqL1xuXHQgICAgX3NldENhbGVuZGFyVGl0bGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG5cdCAgICAgICAgdmFyIG9wdGlvbiA9IHRoaXMuX29wdGlvbixcblx0ICAgICAgICAgICAgdGl0bGVGb3JtYXQgPSBvcHRpb24udGl0bGVGb3JtYXQsXG5cdCAgICAgICAgICAgIHJlcGxhY2VNYXAsXG5cdCAgICAgICAgICAgIHJlZztcblx0XG5cdCAgICAgICAgbW9udGggPSBjYWxlbmRhclV0aWxzLnByZXBlbmRMZWFkaW5nWmVybyhtb250aCk7XG5cdCAgICAgICAgcmVwbGFjZU1hcCA9IHRoaXMuX2dldFJlcGxhY2VNYXAoeWVhciwgbW9udGgpO1xuXHRcblx0ICAgICAgICByZWcgPSBDT05TVEFOVFMudGl0bGVSZWdFeHA7XG5cdCAgICAgICAgdGhpcy5fc2V0RGF0ZVRleHRJbkNhbGVuZGFyKHRoaXMuJHRpdGxlLCB0aXRsZUZvcm1hdCwgcmVwbGFjZU1hcCwgcmVnKTtcblx0XG5cdCAgICAgICAgcmVnID0gQ09OU1RBTlRTLnRpdGxlWWVhclJlZ0V4cDtcblx0ICAgICAgICB0aGlzLl9zZXREYXRlVGV4dEluQ2FsZW5kYXIodGhpcy4kdGl0bGVZZWFyLCBvcHRpb24ueWVhclRpdGxlRm9ybWF0LCByZXBsYWNlTWFwLCByZWcpO1xuXHRcblx0ICAgICAgICByZWcgPSBDT05TVEFOVFMudGl0bGVNb250aFJlZ0V4cDtcblx0ICAgICAgICB0aGlzLl9zZXREYXRlVGV4dEluQ2FsZW5kYXIodGhpcy4kdGl0bGVNb250aCwgb3B0aW9uLm1vbnRoVGl0bGVGb3JtYXQsIHJlcGxhY2VNYXAsIHJlZyk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogVXBkYXRlIHRpdGxlXG5cdCAgICAgKiBAcGFyYW0ge2pRdWVyeXxIVE1MRWxlbWVudH0gZWxlbWVudCBBIHVwZGF0ZSBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gZm9ybSBBIHVwZGF0ZSBmb3JtXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gbWFwIEEgb2JqZWN0IHRoYXQgaGFzIHZhbHVlIG1hdGNoZWQgcmVnRXhwXG5cdCAgICAgKiBAcGFyYW0ge1JlZ0V4cH0gcmVnIEEgcmVnRXhwIHRvIGNoYWduZSBmb3JtXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0RGF0ZVRleHRJbkNhbGVuZGFyOiBmdW5jdGlvbihlbGVtZW50LCBmb3JtLCBtYXAsIHJlZykge1xuXHQgICAgICAgIHZhciB0aXRsZSxcblx0ICAgICAgICAgICAgJGVsID0gJChlbGVtZW50KTtcblx0XG5cdCAgICAgICAgaWYgKCEkZWwubGVuZ3RoKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGl0bGUgPSBjYWxlbmRhclV0aWxzLmdldENvbnZlcnRlZFRpdGxlKGZvcm0sIG1hcCwgcmVnKTtcblx0ICAgICAgICAkZWwudGV4dCh0aXRsZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IG1hcCBkYXRhIGZvciBmb3JtXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IHllYXIgQSB5ZWFyXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IG1vbnRoIEEgbW9udGhcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gW2RhdGVdIEEgZGF5XG5cdCAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXBsYWNlTWFwXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfZ2V0UmVwbGFjZU1hcDogZnVuY3Rpb24oeWVhciwgbW9udGgsIGRhdGUpIHtcblx0ICAgICAgICB2YXIgb3B0aW9uID0gdGhpcy5fb3B0aW9uLFxuXHQgICAgICAgICAgICB5ZWFyU3ViID0gKHllYXIudG9TdHJpbmcoKSkuc3Vic3RyKDIsIDIpLFxuXHQgICAgICAgICAgICBtb250aExhYmVsID0gb3B0aW9uLm1vbnRoVGl0bGVzW21vbnRoIC0gMV0sXG5cdCAgICAgICAgICAgIGxhYmVsS2V5ID0gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXRlIHx8IDEpLmdldERheSgpLFxuXHQgICAgICAgICAgICBkYXlMYWJlbCA9IG9wdGlvbi5kYXlUaXRsZXNbbGFiZWxLZXldO1xuXHRcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICB5eXl5OiB5ZWFyLFxuXHQgICAgICAgICAgICB5eTogeWVhclN1Yixcblx0ICAgICAgICAgICAgbW06IG1vbnRoLFxuXHQgICAgICAgICAgICBtOiBOdW1iZXIobW9udGgpLFxuXHQgICAgICAgICAgICBNOiBtb250aExhYmVsLFxuXHQgICAgICAgICAgICBkZDogZGF0ZSxcblx0ICAgICAgICAgICAgZDogTnVtYmVyKGRhdGUpLFxuXHQgICAgICAgICAgICBEOiBkYXlMYWJlbFxuXHQgICAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2V0IHRvZGF5XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfc2V0Q2FsZW5kYXJUb2RheTogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyICR0b2RheSA9IHRoaXMuJHRvZGF5LFxuXHQgICAgICAgICAgICB0b2RheUZvcm1hdCxcblx0ICAgICAgICAgICAgdG9kYXksXG5cdCAgICAgICAgICAgIHllYXIsXG5cdCAgICAgICAgICAgIG1vbnRoLFxuXHQgICAgICAgICAgICBkYXRlLFxuXHQgICAgICAgICAgICByZXBsYWNlTWFwLFxuXHQgICAgICAgICAgICByZWc7XG5cdFxuXHQgICAgICAgIGlmICghJHRvZGF5Lmxlbmd0aCkge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0b2RheSA9IGNhbGVuZGFyVXRpbHMuZ2V0RGF0ZUhhc2hUYWJsZSgpO1xuXHQgICAgICAgIHllYXIgPSB0b2RheS55ZWFyO1xuXHQgICAgICAgIG1vbnRoID0gY2FsZW5kYXJVdGlscy5wcmVwZW5kTGVhZGluZ1plcm8odG9kYXkubW9udGgpO1xuXHQgICAgICAgIGRhdGUgPSBjYWxlbmRhclV0aWxzLnByZXBlbmRMZWFkaW5nWmVybyh0b2RheS5kYXRlKTtcblx0ICAgICAgICB0b2RheUZvcm1hdCA9IHRoaXMuX29wdGlvbi50b2RheUZvcm1hdDtcblx0ICAgICAgICByZXBsYWNlTWFwID0gdGhpcy5fZ2V0UmVwbGFjZU1hcCh5ZWFyLCBtb250aCwgZGF0ZSk7XG5cdCAgICAgICAgcmVnID0gQ09OU1RBTlRTLnRvZGF5UmVnRXhwO1xuXHQgICAgICAgIHRoaXMuX3NldERhdGVUZXh0SW5DYWxlbmRhcigkdG9kYXksIHRvZGF5Rm9ybWF0LCByZXBsYWNlTWFwLCByZWcpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCB0aXRsZSBvbiB5ZWFyJ3MgbGF5ZXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIC0gWWVhclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX3NldFRpdGxlT25ZZWFyTGF5ZXI6IGZ1bmN0aW9uKHllYXIpIHtcblx0ICAgICAgICB2YXIgaXRlbUNvdW50T2ZZZWFyID0gdGhpcy5fZ2V0SW5mb09mWWVhclJhbmdlKHllYXIpO1xuXHQgICAgICAgIHZhciBzdGFydFllYXJUZXh0ID0gdGhpcy5fZ2V0Q29udmVydGVkWWVhclRpdGxlKGl0ZW1Db3VudE9mWWVhci5zdGFydFllYXIpO1xuXHQgICAgICAgIHZhciBlbmRZZWFyVGV4dCA9IHRoaXMuX2dldENvbnZlcnRlZFllYXJUaXRsZShpdGVtQ291bnRPZlllYXIuZW5kWWVhcik7XG5cdCAgICAgICAgdmFyIHRpdGxlID0gc3RhcnRZZWFyVGV4dCArICcgLSAnICsgZW5kWWVhclRleHQ7XG5cdFxuXHQgICAgICAgIHRoaXMuJHRpdGxlLnRleHQodGl0bGUpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNldCBjbGFzcyBuYW1lIG9uIHRpdGxlXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gc2hvd25MYXllcklkeCAtIFllYXJcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9zZXRDbGFzc05hbWVPblRpdGxlOiBmdW5jdGlvbihzaG93bkxheWVySWR4KSB7XG5cdCAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRoaXMuX29wdGlvbi5jbGFzc1ByZWZpeCArIENPTlNUQU5UUy5jbGlja2FibGU7XG5cdFxuXHQgICAgICAgIGlmICghdGhpcy5pc0NsaWNrYWJsZVRpdGxlKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChzaG93bkxheWVySWR4ICE9PSAyKSB7XG5cdCAgICAgICAgICAgIHRoaXMuJHRpdGxlLmFkZENsYXNzKGNsYXNzTmFtZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgdGhpcy4kdGl0bGUucmVtb3ZlQ2xhc3MoY2xhc3NOYW1lKTtcblx0ICAgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IGNvbnZlcnRlZCB5ZWFyIHRleHQgb24geWVhciBhbmQgbW9udGggbGF5ZXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIC0gWWVhclxuXHQgICAgICogQHJldHVybnMge3N0cmluZ30gQ29udmVydGVkIHllYXIgdGV4dFxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2dldENvbnZlcnRlZFllYXJUaXRsZTogZnVuY3Rpb24oeWVhcikge1xuXHQgICAgICAgIHZhciBvcHRpb24gPSB0aGlzLl9vcHRpb247XG5cdCAgICAgICAgdmFyIHJlcGxhY2VNYXAsIHJlZztcblx0XG5cdCAgICAgICAgcmVwbGFjZU1hcCA9IHRoaXMuX2dldFJlcGxhY2VNYXAoeWVhcik7XG5cdCAgICAgICAgcmVnID0gQ09OU1RBTlRTLnRpdGxlWWVhclJlZ0V4cDtcblx0XG5cdCAgICAgICAgcmV0dXJuIGNhbGVuZGFyVXRpbHMuZ2V0Q29udmVydGVkVGl0bGUob3B0aW9uLnllYXJUaXRsZUZvcm1hdCwgcmVwbGFjZU1hcCwgcmVnKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgeWVhcnMgaW5mbyBieSBcIml0ZW1Db3VudE9mWWVhclwiIG9wdGlvblxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgLSBZZWFyXG5cdCAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBJbmZvIG9mIHllYXIncyByYW5nZVxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2dldEluZm9PZlllYXJSYW5nZTogZnVuY3Rpb24oeWVhcikge1xuXHQgICAgICAgIHZhciBmcmFtZUluZm8gPSB0aGlzLmRhdGFPZlllYXJMYXllci5mcmFtZTtcblx0ICAgICAgICB2YXIgY29scyA9IGZyYW1lSW5mby5jb2xzO1xuXHQgICAgICAgIHZhciByb3dzID0gZnJhbWVJbmZvLnJvd3M7XG5cdCAgICAgICAgdmFyIGJhc2VJZHggPSAoY29scyAqIE1hdGguZmxvb3Iocm93cyAvIDIpKSArIE1hdGguZmxvb3IoY29scyAvIDIpO1xuXHQgICAgICAgIHZhciBzdGFydFllYXIgPSB5ZWFyIC0gYmFzZUlkeDtcblx0ICAgICAgICB2YXIgZW5kWWVhciA9IHN0YXJ0WWVhciArIChjb2xzICogcm93cykgLSAxO1xuXHRcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICBzdGFydFllYXI6IHN0YXJ0WWVhcixcblx0ICAgICAgICAgICAgZW5kWWVhcjogZW5kWWVhclxuXHQgICAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IGluZGV4IG9mIGN1cnJlbnQgc2hvd24gbGF5ZXIgYnkgbGF5ZXIncyB0eXBlXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IHR5cGUgLSBUeXBlIG9mIGxheWVyXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBJbmRleCBvZiBzaG93biBsYXllclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2dldEluZGV4T2ZTaG93bkxheWVyOiBmdW5jdGlvbih0eXBlKSB7XG5cdCAgICAgICAgcmV0dXJuICh0eXBlID8gdXRpbC5pbkFycmF5KHR5cGUsIENPTlNUQU5UUy5sYXllcktleXMpIDogdGhpcy5zaG93bkxheWVySWR4KTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBEcmF3IGhlYWRlciBlbGVtZW50XG5cdCAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyAtIFRoZSBoYXNoIHRoYXQgc2hvdyB1cCBvbiBjYWxlbmRhclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHNob3duTGF5ZXJJZHggLSBJbmRleCBvZiBzaG93biBsYXllclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2RyYXdIZWFkZXI6IGZ1bmN0aW9uKGRhdGVGb3JEcmF3aW5nLCBzaG93bkxheWVySWR4KSB7XG5cdCAgICAgICAgdmFyIGNsYXNzU2VsZWN0b3IgPSAnLicgKyB0aGlzLl9vcHRpb24uY2xhc3NQcmVmaXggKyAnYnRuLSc7XG5cdCAgICAgICAgdmFyIHByZXZCdG4gPSB0aGlzLiRoZWFkZXIuZmluZChjbGFzc1NlbGVjdG9yICsgQ09OU1RBTlRTLnByZXYpO1xuXHQgICAgICAgIHZhciBuZXh0QnRuID0gdGhpcy4kaGVhZGVyLmZpbmQoY2xhc3NTZWxlY3RvciArIENPTlNUQU5UUy5uZXh0KTtcblx0ICAgICAgICB2YXIga2V5ID0gQ09OU1RBTlRTLnJlbGF0aXZlTW9udGhWYWx1ZUtleTtcblx0ICAgICAgICB2YXIgaXRlbUNvdW50T2ZZZWFyID0gdGhpcy5fb3B0aW9uLml0ZW1Db3VudE9mWWVhcjtcblx0ICAgICAgICB2YXIgcHJldlZhbHVlLCBuZXh0VmFsdWU7XG5cdFxuXHQgICAgICAgIHRoaXMuX3NldENsYXNzTmFtZU9uVGl0bGUoc2hvd25MYXllcklkeCk7XG5cdFxuXHQgICAgICAgIHN3aXRjaCAoc2hvd25MYXllcklkeCkge1xuXHQgICAgICAgICAgICBjYXNlIDA6XG5cdCAgICAgICAgICAgICAgICB0aGlzLl9zZXRDYWxlbmRhclRleHQoZGF0ZUZvckRyYXdpbmcpO1xuXHQgICAgICAgICAgICAgICAgcHJldlZhbHVlID0gLTE7XG5cdCAgICAgICAgICAgICAgICBuZXh0VmFsdWUgPSAxO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGNhc2UgMTpcblx0ICAgICAgICAgICAgICAgIHRoaXMuJHRpdGxlLnRleHQodGhpcy5fZ2V0Q29udmVydGVkWWVhclRpdGxlKGRhdGVGb3JEcmF3aW5nLnllYXIpKTtcblx0ICAgICAgICAgICAgICAgIHByZXZWYWx1ZSA9IC0xMjtcblx0ICAgICAgICAgICAgICAgIG5leHRWYWx1ZSA9IDEyO1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgIGNhc2UgMjpcblx0ICAgICAgICAgICAgICAgIHRoaXMuX3NldFRpdGxlT25ZZWFyTGF5ZXIoZGF0ZUZvckRyYXdpbmcueWVhcik7XG5cdCAgICAgICAgICAgICAgICBwcmV2VmFsdWUgPSAtMTIgKiBpdGVtQ291bnRPZlllYXI7XG5cdCAgICAgICAgICAgICAgICBuZXh0VmFsdWUgPSAxMiAqIGl0ZW1Db3VudE9mWWVhcjtcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICBkZWZhdWx0OiAvLyBAdG9kbyBXaHkgZG9lcyBub3QgdXNlICdyZXR1cm4nIGJ1dCAnYnJlYWsnP1xuXHQgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBwcmV2QnRuLmRhdGEoa2V5LCBwcmV2VmFsdWUpO1xuXHQgICAgICAgIG5leHRCdG4uZGF0YShrZXksIG5leHRWYWx1ZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRHJhdyBib2R5IGVsZW1lbnRzXG5cdCAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyAtIFRoZSBoYXNoIHRoYXQgc2hvdyB1cCBvbiBjYWxlbmRhclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IHNob3duTGF5ZXJJZHggLSBJbmRleCBvZiBzaG93biBsYXllclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2RyYXdCb2R5OiBmdW5jdGlvbihkYXRlRm9yRHJhd2luZywgc2hvd25MYXllcklkeCkge1xuXHQgICAgICAgIHZhciB5ZWFyID0gZGF0ZUZvckRyYXdpbmcueWVhcjtcblx0ICAgICAgICB2YXIgbW9udGggPSBkYXRlRm9yRHJhd2luZy5tb250aDtcblx0ICAgICAgICB2YXIgY2xhc3NQcmVmaXggPSB0aGlzLl9vcHRpb24uY2xhc3NQcmVmaXg7XG5cdFxuXHQgICAgICAgIC8vIHdlZWtzXG5cdCAgICAgICAgdGhpcy5fc2V0V2Vla3MoeWVhciwgbW9udGgpO1xuXHQgICAgICAgIHRoaXMuXyRkYXRlRWxlbWVudCA9ICQoJy4nICsgY2xhc3NQcmVmaXggKyAnZGF0ZScsIHRoaXMuJHdlZWtBcHBlbmRUYXJnZXQpO1xuXHQgICAgICAgIHRoaXMuXyRkYXRlQ29udGFpbmVyRWxlbWVudCA9ICQoJy4nICsgY2xhc3NQcmVmaXggKyAnd2VlayA+IConLCB0aGlzLiR3ZWVrQXBwZW5kVGFyZ2V0KTtcblx0XG5cdCAgICAgICAgLy8gZGF0ZXNcblx0ICAgICAgICB0aGlzLl9kcmF3RGF0ZXMoZGF0ZUZvckRyYXdpbmcsIGNsYXNzUHJlZml4KTtcblx0XG5cdCAgICAgICAgLy8gbW9udGggbGF5ZXJcblx0ICAgICAgICB0aGlzLl9kcmF3RnJhbWVPbk1vbnRoTGF5ZXIoKTtcblx0ICAgICAgICB0aGlzLl9kcmF3QnV0dG9uc09mTW9udGgoZGF0ZUZvckRyYXdpbmcsIGNsYXNzUHJlZml4KTtcblx0XG5cdCAgICAgICAgLy8geWVhciBsYXllclxuXHQgICAgICAgIHRoaXMuX2RyYXdGcmFtZU9uWWVhckxheWVyKCk7XG5cdCAgICAgICAgdGhpcy5fZHJhd0J1dHRvbnNPZlllYXIoZGF0ZUZvckRyYXdpbmcsIGNsYXNzUHJlZml4KTtcblx0XG5cdCAgICAgICAgLy8gc2hvdyBsYXllclxuXHQgICAgICAgIHRoaXMuX2NoYW5nZVNob3duTGF5ZXIoc2hvd25MYXllcklkeCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRHJhdyBmcmFtZSBjb250YWluaW5nIGJ1dHRvbnMgb24gbW9udGgncyBsYXllclxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXHQgICAgX2RyYXdGcmFtZU9uTW9udGhMYXllcjogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGkgPSAwO1xuXHQgICAgICAgIHZhciByb3dzID0gdGhpcy5kYXRhT2ZNb250aExheWVyLmZyYW1lLnJvd3M7XG5cdCAgICAgICAgdmFyIGRhdGFPZk1vbnRoTGF5ZXIgPSB0aGlzLmRhdGFPZk1vbnRoTGF5ZXI7XG5cdCAgICAgICAgdmFyICRtb250aEdyb3VwRWw7XG5cdFxuXHQgICAgICAgIGZvciAoOyBpIDwgcm93czsgaSArPSAxKSB7XG5cdCAgICAgICAgICAgICRtb250aEdyb3VwRWwgPSBkYXRhT2ZNb250aExheWVyLnRlbXBsYXRlLmNsb25lKHRydWUpO1xuXHQgICAgICAgICAgICAkbW9udGhHcm91cEVsLmFwcGVuZFRvKGRhdGFPZk1vbnRoTGF5ZXIuYXBwZW5kZWRUYXJnZXQpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBEcmF3IHNlbGVjdGFibGUgYnV0dG9ucyBvbiBtb250aCdzIGxheWVyXG5cdCAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyAtIFRoZSBoYXNoIHRoYXQgc2hvdyB1cCBvbiBjYWxlbmRhclxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzUHJlZml4IC0gQSBjbGFzcyBwcmVmaXhcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9kcmF3QnV0dG9uc09mTW9udGg6IGZ1bmN0aW9uKGRhdGVGb3JEcmF3aW5nLCBjbGFzc1ByZWZpeCkge1xuXHQgICAgICAgIHZhciBrZXkgPSBDT05TVEFOVFMucmVsYXRpdmVNb250aFZhbHVlS2V5O1xuXHQgICAgICAgIHZhciBzZWxlY3RlZE1vbnRoID0gZGF0ZUZvckRyYXdpbmcubW9udGg7XG5cdCAgICAgICAgdmFyIG1vbnRoVGl0bGVzID0gdGhpcy5fb3B0aW9uLm1vbnRoVGl0bGVzO1xuXHQgICAgICAgIHZhciAkbW9udGhFbHMgPSB0aGlzLmRhdGFPZk1vbnRoTGF5ZXIuYXBwZW5kZWRUYXJnZXQuZmluZCgnLicgKyBjbGFzc1ByZWZpeCArICdtb250aCcpO1xuXHQgICAgICAgIHZhciAkYnV0dG9uRWwsIG1vbnRoLCByZWxhdGl2ZU1vbnRoO1xuXHQgICAgICAgIHZhciBldmVudERhdGE7XG5cdFxuXHQgICAgICAgIHV0aWwuZm9yRWFjaChtb250aFRpdGxlcywgZnVuY3Rpb24odGl0bGUsIGlkeCkge1xuXHQgICAgICAgICAgICAkYnV0dG9uRWwgPSAkbW9udGhFbHMuZXEoaWR4KTtcblx0ICAgICAgICAgICAgbW9udGggPSBpZHggKyAxO1xuXHRcblx0ICAgICAgICAgICAgaWYgKG1vbnRoID09PSBzZWxlY3RlZE1vbnRoKSB7XG5cdCAgICAgICAgICAgICAgICAkYnV0dG9uRWwuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyBDT05TVEFOVFMuc2VsZWN0ZWQpO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5faXNUb2RheSh0aGlzLl9zaG93bkRhdGUueWVhciwgbW9udGgpKSB7XG5cdCAgICAgICAgICAgICAgICAkYnV0dG9uRWwuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyBDT05TVEFOVFMudG9kYXkpO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICByZWxhdGl2ZU1vbnRoID0gbW9udGggLSBzZWxlY3RlZE1vbnRoO1xuXHRcblx0ICAgICAgICAgICAgJGJ1dHRvbkVsLmRhdGEoa2V5LCByZWxhdGl2ZU1vbnRoKS5odG1sKHRpdGxlKTtcblx0XG5cdCAgICAgICAgICAgIGV2ZW50RGF0YSA9IHtcblx0ICAgICAgICAgICAgICAgICRkYXRlOiAkYnV0dG9uRWwsXG5cdCAgICAgICAgICAgICAgICAkZGF0ZUNvbnRhaW5lcjogJGJ1dHRvbkVsLFxuXHQgICAgICAgICAgICAgICAgeWVhcjogZGF0ZUZvckRyYXdpbmcueWVhcixcblx0ICAgICAgICAgICAgICAgIG1vbnRoOiBtb250aCxcblx0ICAgICAgICAgICAgICAgIGRhdGU6IDAsXG5cdCAgICAgICAgICAgICAgICBodG1sOiB0aXRsZVxuXHQgICAgICAgICAgICB9O1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5maXJlKCdkcmF3JywgZXZlbnREYXRhKTtcblx0ICAgICAgICB9LCB0aGlzKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBEcmF3IGZyYW1lIGNvbnRhaW5pbmcgYnV0dG9ucyBvbiB5ZWFyJ3MgbGF5ZXJcblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblx0ICAgIF9kcmF3RnJhbWVPblllYXJMYXllcjogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGkgPSAwO1xuXHQgICAgICAgIHZhciByb3dzID0gdGhpcy5kYXRhT2ZNb250aExheWVyLmZyYW1lLnJvd3M7XG5cdCAgICAgICAgdmFyIGRhdGFPZlllYXJMYXllciA9IHRoaXMuZGF0YU9mWWVhckxheWVyO1xuXHQgICAgICAgIHZhciAkeWVhckdyb3VwRWw7XG5cdFxuXHQgICAgICAgIGZvciAoOyBpIDwgcm93czsgaSArPSAxKSB7XG5cdCAgICAgICAgICAgICR5ZWFyR3JvdXBFbCA9IGRhdGFPZlllYXJMYXllci50ZW1wbGF0ZS5jbG9uZSh0cnVlKTtcblx0ICAgICAgICAgICAgJHllYXJHcm91cEVsLmFwcGVuZFRvKGRhdGFPZlllYXJMYXllci5hcHBlbmRlZFRhcmdldCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERyYXcgc2VsZWN0YWJsZSBidXR0b25zIG9uIHllYXIncyBsYXllclxuXHQgICAgICogQHBhcmFtIHt7eWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyfX0gZGF0ZUZvckRyYXdpbmcgLSBUaGUgaGFzaCB0aGF0IHNob3cgdXAgb24gY2FsZW5kYXJcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1ByZWZpeCAtIEEgY2xhc3MgcHJlZml4XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfZHJhd0J1dHRvbnNPZlllYXI6IGZ1bmN0aW9uKGRhdGVGb3JEcmF3aW5nLCBjbGFzc1ByZWZpeCkge1xuXHQgICAgICAgIHZhciBrZXkgPSBDT05TVEFOVFMucmVsYXRpdmVNb250aFZhbHVlS2V5O1xuXHQgICAgICAgIHZhciB5ZWFyID0gZGF0ZUZvckRyYXdpbmcueWVhcjtcblx0ICAgICAgICB2YXIgaXRlbUNvdW50T2ZZZWFyID0gdGhpcy5fZ2V0SW5mb09mWWVhclJhbmdlKHllYXIpO1xuXHQgICAgICAgIHZhciBzdGFydFllYXIgPSBpdGVtQ291bnRPZlllYXIuc3RhcnRZZWFyO1xuXHQgICAgICAgIHZhciBlbmRZZWFyID0gaXRlbUNvdW50T2ZZZWFyLmVuZFllYXI7XG5cdCAgICAgICAgdmFyIGNudCA9IDA7XG5cdCAgICAgICAgdmFyICR5ZWFyRWxzID0gdGhpcy5kYXRhT2ZZZWFyTGF5ZXIuYXBwZW5kZWRUYXJnZXQuZmluZCgnLicgKyBjbGFzc1ByZWZpeCArICd5ZWFyJyk7XG5cdCAgICAgICAgdmFyICRidXR0b25FbCwgcmVsYXRpdmVNb250aDtcblx0ICAgICAgICB2YXIgZXZlbnREYXRhO1xuXHRcblx0ICAgICAgICBmb3IgKDsgc3RhcnRZZWFyIDw9IGVuZFllYXI7IHN0YXJ0WWVhciArPSAxKSB7XG5cdCAgICAgICAgICAgICRidXR0b25FbCA9ICR5ZWFyRWxzLmVxKGNudCk7XG5cdFxuXHQgICAgICAgICAgICBpZiAoc3RhcnRZZWFyID09PSB5ZWFyKSB7XG5cdCAgICAgICAgICAgICAgICAkYnV0dG9uRWwuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyBDT05TVEFOVFMuc2VsZWN0ZWQpO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5faXNUb2RheShzdGFydFllYXIpKSB7XG5cdCAgICAgICAgICAgICAgICAkYnV0dG9uRWwuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyBDT05TVEFOVFMudG9kYXkpO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICByZWxhdGl2ZU1vbnRoID0gKHN0YXJ0WWVhciAtIHllYXIpICogMTI7XG5cdFxuXHQgICAgICAgICAgICAkYnV0dG9uRWwuZGF0YShrZXksIHJlbGF0aXZlTW9udGgpLmh0bWwoc3RhcnRZZWFyKTtcblx0XG5cdCAgICAgICAgICAgIGNudCArPSAxO1xuXHRcblx0ICAgICAgICAgICAgZXZlbnREYXRhID0ge1xuXHQgICAgICAgICAgICAgICAgJGRhdGU6ICRidXR0b25FbCxcblx0ICAgICAgICAgICAgICAgICRkYXRlQ29udGFpbmVyOiAkYnV0dG9uRWwsXG5cdCAgICAgICAgICAgICAgICB5ZWFyOiBzdGFydFllYXIsXG5cdCAgICAgICAgICAgICAgICBtb250aDogMCxcblx0ICAgICAgICAgICAgICAgIGRhdGU6IDAsXG5cdCAgICAgICAgICAgICAgICBodG1sOiBzdGFydFllYXJcblx0ICAgICAgICAgICAgfTtcblx0XG5cdCAgICAgICAgICAgIHRoaXMuZmlyZSgnZHJhdycsIGV2ZW50RGF0YSk7XG5cdCAgICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENoYW5nZSBjdXJyZW50IHNob3duIGxheWVyIG9uIGNhbGVuZGFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gc2hvd25MYXllcklkeCAtIEluZGV4IG9mIHNob3duIGxheWVyXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBfY2hhbmdlU2hvd25MYXllcjogZnVuY3Rpb24oc2hvd25MYXllcklkeCkge1xuXHQgICAgICAgIHZhciBjbGFzc1ByZWZpeCA9IHRoaXMuX29wdGlvbi5jbGFzc1ByZWZpeDtcblx0ICAgICAgICB2YXIgcHJldnNob3duTGF5ZXJJZHggPSB0aGlzLnNob3duTGF5ZXJJZHg7XG5cdCAgICAgICAgdmFyICRib2R5cyA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLicgKyBjbGFzc1ByZWZpeCArICdib2R5Jyk7XG5cdFxuXHQgICAgICAgIHRoaXMuc2hvd25MYXllcklkeCA9IHNob3duTGF5ZXJJZHg7XG5cdFxuXHQgICAgICAgICRib2R5cy5lcShwcmV2c2hvd25MYXllcklkeCkuaGlkZSgpO1xuXHQgICAgICAgICRib2R5cy5lcShzaG93bkxheWVySWR4KS5zaG93KCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRHJhdyBjYWxlbmRhclxuXHQgICAgICogQGFwaVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IFt5ZWFyXSBBIHllYXIgKGV4LiAyMDA4KVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IFttb250aF0gQSBtb250aCAoMSB+IDEyKVxuXHQgICAgICogQHBhcmFtIHtCb29sZWFufSBbaXNSZWxhdGl2ZV0gQSB5ZWFyIGFuZCBtb250aCBpcyByZWxhdGVkXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3Nob3duVHlwZV0gU2hvd24gdHlwZSBvZiBsYXllciAoZXguIFtkYXksIG1vbnRoLCB5ZWFyXSB8IFswXSB+IDJdKVxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqIGNhbGVuZGFyLmRyYXcoKTsgLy8gRHJhdyB3aXRoIG5vdyBkYXRlLlxuXHQgICAgICogY2FsZW5kYXIuZHJhdygyMDA4LCAxMik7IC8vIERyYXcgMjAwOC8xMlxuXHQgICAgICogY2FsZW5kYXIuZHJhdyhudWxsLCAxMik7IC8vIERyYXcgY3VycmVudCB5ZWFyLzEyXG5cdCAgICAgKiBjYWxlbmRhci5kcmF3KDIwMTAsIG51bGwpOyAvLyBEcmF3IDIwMTAvY3VycmVudCBtb250aFxuXHQgICAgICogY2FsZW5kYXIuZHJhdygwLCAxLCB0cnVlKTsgLy8gRHJhdyBuZXh0IG1vbnRoXG5cdCAgICAgKiBjYWxlbmRhci5kcmF3KC0xLCBudWxsLCB0cnVlKTsgLy8gRHJhdyBwcmV2IHllYXJcblx0ICAgICAqIGNhbGVuZGFyLmRyYXcoMCwgMCwgZmFsc2UsICdkYXRlJyk7IC8vIERyYXcgdG9kYXkgd2l0aCBkYXRlJ3MgbGF5ZXJcblx0ICAgICAqIGNhbGVuZGFyLmRyYXcoMjAxMCwgMTAsIGZhbHNlLCAnbW9udGgnKTsgLy8gRHJhdyAyMDEwLzEwIHdpdGggbW9udGgncyBsYXllclxuXHQgICAgICogY2FsZW5kYXIuZHJhdygyMDE2LCBudWxsLCBmYWxzZSwgJ3llYXInKTsgLy8gRHJhdyAyMDE2L21vbnRoIHdpdGggeWVhcidzIGxheWVyXG5cdCAgICAgKiovXG5cdCAgICBkcmF3OiBmdW5jdGlvbih5ZWFyLCBtb250aCwgaXNSZWxhdGl2ZSwgc2hvd25UeXBlKSB7XG5cdCAgICAgICAgdmFyIGRhdGVGb3JEcmF3aW5nID0gdGhpcy5fZ2V0RGF0ZUZvckRyYXdpbmcoeWVhciwgbW9udGgsIGlzUmVsYXRpdmUpO1xuXHQgICAgICAgIHZhciBpc1JlYWR5Rm9yRHJhd2luZyA9IHRoaXMuaW52b2tlKCdiZWZvcmVEcmF3JywgZGF0ZUZvckRyYXdpbmcpO1xuXHQgICAgICAgIHZhciBzaG93bkxheWVySWR4O1xuXHRcblx0ICAgICAgICAvKiA9PT09PT09PT09PT09PT1cblx0ICAgICAgICAgKiBiZWZvcmVEcmF3XG5cdCAgICAgICAgICogPT09PT09PT09PT09PT09PT0qL1xuXHQgICAgICAgIGlmICghaXNSZWFkeUZvckRyYXdpbmcpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyogPT09PT09PT09PT09PT09XG5cdCAgICAgICAgICogZHJhd1xuXHQgICAgICAgICAqID09PT09PT09PT09PT09PT09Ki9cblx0ICAgICAgICBzaG93bkxheWVySWR4ID0gdXRpbC5pc051bWJlcihzaG93blR5cGUpID8gc2hvd25UeXBlIDogdGhpcy5fZ2V0SW5kZXhPZlNob3duTGF5ZXIoc2hvd25UeXBlKTtcblx0XG5cdCAgICAgICAgeWVhciA9IGRhdGVGb3JEcmF3aW5nLnllYXI7XG5cdCAgICAgICAgbW9udGggPSBkYXRlRm9yRHJhd2luZy5tb250aDtcblx0XG5cdCAgICAgICAgdGhpcy5zZXREYXRlKHllYXIsIG1vbnRoKTtcblx0XG5cdCAgICAgICAgdGhpcy5fY2xlYXIoKTtcblx0ICAgICAgICB0aGlzLl9kcmF3SGVhZGVyKGRhdGVGb3JEcmF3aW5nLCBzaG93bkxheWVySWR4KTtcblx0ICAgICAgICB0aGlzLl9kcmF3Qm9keShkYXRlRm9yRHJhd2luZywgc2hvd25MYXllcklkeCk7XG5cdFxuXHQgICAgICAgIC8qID09PT09PT09PT09PT09PVxuXHQgICAgICAgICAqIGFmdGVyRHJhd1xuXHQgICAgICAgICAqID09PT09PT09PT09PT09PT0qL1xuXHQgICAgICAgIHRoaXMuZmlyZSgnYWZ0ZXJEcmF3JywgZGF0ZUZvckRyYXdpbmcpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybiBjdXJyZW50IHllYXIgYW5kIG1vbnRoKGp1c3Qgc2hvd24pLlxuXHQgICAgICogQGFwaVxuXHQgICAgICogQHJldHVybnMge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fVxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqICBnZXREYXRlKCk7ID0+IHsgeWVhcjogeHh4eCwgbW9udGg6IHh4IH07XG5cdCAgICAgKi9cblx0ICAgIGdldERhdGU6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIHllYXI6IHRoaXMuX3Nob3duRGF0ZS55ZWFyLFxuXHQgICAgICAgICAgICBtb250aDogdGhpcy5fc2hvd25EYXRlLm1vbnRoXG5cdCAgICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTZXQgZGF0ZVxuXHQgICAgICogQGFwaVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IFt5ZWFyXSBBIHllYXIgKGV4LiAyMDA4KVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IFttb250aF0gQSBtb250aCAoMSB+IDEyKVxuXHQgICAgICogQGV4YW1wbGVcblx0ICAgICAqICBzZXREYXRlKDE5ODQsIDA0KTtcblx0ICAgICAqKi9cblx0ICAgIHNldERhdGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG5cdCAgICAgICAgdmFyIGRhdGUgPSB0aGlzLl9zaG93bkRhdGU7XG5cdCAgICAgICAgZGF0ZS55ZWFyID0gdXRpbC5pc051bWJlcih5ZWFyKSA/IHllYXIgOiBkYXRlLnllYXI7XG5cdCAgICAgICAgZGF0ZS5tb250aCA9IHV0aWwuaXNOdW1iZXIobW9udGgpID8gbW9udGggOiBkYXRlLm1vbnRoO1xuXHQgICAgfVxuXHR9KTtcblx0XG5cdHV0aWwuQ3VzdG9tRXZlbnRzLm1peGluKENhbGVuZGFyKTtcblx0bW9kdWxlLmV4cG9ydHMgPSBDYWxlbmRhcjtcblxuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIENPTlNUQU5UUyA9IHtcblx0ICAgIHJlbGF0aXZlTW9udGhWYWx1ZUtleTogJ3JlbGF0aXZlTW9udGhWYWx1ZScsXG5cdCAgICBwcmV2OiAncHJldicsXG5cdCAgICBwcmV2WWVhcjogJ3ByZXYteWVhcicsXG5cdCAgICBwcmV2TW9udGg6ICdwcmV2LW1vbnRoJyxcblx0ICAgIG5leHQ6ICduZXh0Jyxcblx0ICAgIG5leHRZZWFyOiAnbmV4dC15ZWFyJyxcblx0ICAgIG5leHRNb250aDogJ25leHQtbW9udGgnLFxuXHQgICAgc2VsZWN0ZWQ6ICdzZWxlY3RlZCcsXG5cdCAgICB0b2RheTogJ3RvZGF5Jyxcblx0ICAgIGNsaWNrYWJsZTogJ2NsaWNrYWJsZS10aXRsZScsXG5cdCAgICBjYWxlbmRhckhlYWRlcjogbnVsbCxcblx0ICAgIGNhbGVuZGFyQm9keTogbnVsbCxcblx0ICAgIGNhbGVuZGFyRm9vdGVyOiBudWxsLFxuXHQgICAgZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwOiAvY2FsZW5kYXItL2csXG5cdCAgICB0aXRsZVJlZ0V4cDogL3l5eXl8eXl8bW18bXxNL2csXG5cdCAgICB0aXRsZVllYXJSZWdFeHA6IC95eXl5fHl5L2csXG5cdCAgICB0aXRsZU1vbnRoUmVnRXhwOiAvbW18bXxNL2csXG5cdCAgICB0b2RheVJlZ0V4cDogL3l5eXl8eXl8bW18bXxNfGRkfGR8RC9nLFxuXHQgICAgaXRlbUNvdW50T2ZZZWFyOiAxMixcblx0ICAgIGxheWVyS2V5czogWydkYXRlJywgJ21vbnRoJywgJ3llYXInXVxuXHR9O1xuXHRcblx0LyogZXNsaW50LWRpc2FibGUgKi9cblx0Q09OU1RBTlRTLmNhbGVuZGFySGVhZGVyID0gW1xuXHQgICAgJzxkaXYgY2xhc3M9XCJjYWxlbmRhci1oZWFkZXJcIj4nLFxuXHQgICAgICAgICc8YSBocmVmPVwiI1wiIGNsYXNzPVwiY2FsZW5kYXItcm9sbG92ZXIgY2FsZW5kYXItYnRuLScgKyBDT05TVEFOVFMucHJldiArICdcIj5QcmV2PC9hPicsXG5cdCAgICAgICAgJzxzdHJvbmcgY2xhc3M9XCJjYWxlbmRhci10aXRsZSBjYWxlbmRhci1jbGlja2FibGUtdGl0bGVcIj48L3N0cm9uZz4nLFxuXHQgICAgICAgICc8YSBocmVmPVwiI1wiIGNsYXNzPVwiY2FsZW5kYXItcm9sbG92ZXIgY2FsZW5kYXItYnRuLScgKyBDT05TVEFOVFMubmV4dCArICdcIj5OZXh0PC9hPicsXG5cdCAgICAnPC9kaXY+J10uam9pbignJyk7XG5cdFxuXHRDT05TVEFOVFMuY2FsZW5kYXJCb2R5ID0gW1xuXHQgICAgJzxkaXYgY2xhc3M9XCJjYWxlbmRhci1ib2R5XCI+Jyxcblx0ICAgICAgICAnPHRhYmxlPicsXG5cdCAgICAgICAgICAgICc8dGhlYWQ+Jyxcblx0ICAgICAgICAgICAgICAgICc8dHI+Jyxcblx0ICAgICAgICAgICAgICAgICAgICc8dGggY2xhc3M9XCJjYWxlbmRhci1zdW5cIj5TdTwvdGg+PHRoPk1vPC90aD48dGg+VHU8L3RoPjx0aD5XZTwvdGg+PHRoPlRoPC90aD48dGg+RmE8L3RoPjx0aCBjbGFzcz1cImNhbGVuZGFyLXNhdFwiPlNhPC90aD4nLFxuXHQgICAgICAgICAgICAgICAgJzwvdHI+Jyxcblx0ICAgICAgICAgICAgJzwvdGhlYWQ+Jyxcblx0ICAgICAgICAgICAgJzx0Ym9keT4nLFxuXHQgICAgICAgICAgICAgICAgJzx0ciBjbGFzcz1cImNhbGVuZGFyLXdlZWtcIj4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgJzwvdHI+Jyxcblx0ICAgICAgICAgICAgJzwvdGJvZHk+Jyxcblx0ICAgICAgICAnPC90YWJsZT4nLFxuXHQgICAgJzwvZGl2PicsXG5cdCAgICAnPGRpdiBjbGFzcz1cImNhbGVuZGFyLWJvZHlcIj4nLFxuXHQgICAgICAgICc8dGFibGU+Jyxcblx0ICAgICAgICAgICAgJzx0Ym9keT4nLFxuXHQgICAgICAgICAgICAgICAgJzx0ciBjbGFzcz1cImNhbGVuZGFyLW1vbnRoLWdyb3VwXCI+Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXItbW9udGhcIj48L3RkPicsXG5cdCAgICAgICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImNhbGVuZGFyLW1vbnRoXCI+PC90ZD4nLFxuXHQgICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1tb250aFwiPjwvdGQ+Jyxcblx0ICAgICAgICAgICAgICAgICc8L3RyPicsXG5cdCAgICAgICAgICAgICc8L3Rib2R5PicsXG5cdCAgICAgICAgJzwvdGFibGU+Jyxcblx0ICAgICc8L2Rpdj4nLFxuXHQgICAgJzxkaXYgY2xhc3M9XCJjYWxlbmRhci1ib2R5XCI+Jyxcblx0ICAgICAgICAnPHRhYmxlPicsXG5cdCAgICAgICAgICAgICc8dGJvZHk+Jyxcblx0ICAgICAgICAgICAgICAgICc8dHIgY2xhc3M9XCJjYWxlbmRhci15ZWFyLWdyb3VwXCI+Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXIteWVhclwiPjwvdGQ+Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXIteWVhclwiPjwvdGQ+Jyxcblx0ICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXIteWVhclwiPjwvdGQ+Jyxcblx0ICAgICAgICAgICAgICAgICc8L3RyPicsXG5cdCAgICAgICAgICAgICc8L3Rib2R5PicsXG5cdCAgICAgICAgJzwvdGFibGU+Jyxcblx0ICAgICc8L2Rpdj4nXS5qb2luKCcnKTtcblx0XG5cdENPTlNUQU5UUy5jYWxlbmRhckZvb3RlciA9IFtcblx0ICAgICc8ZGl2IGNsYXNzPVwiY2FsZW5kYXItZm9vdGVyXCI+Jyxcblx0ICAgICAgICAnPHA+7Jik64qYIDxlbSBjbGFzcz1cImNhbGVuZGFyLXRvZGF5XCI+PC9lbT48L3A+Jyxcblx0ICAgICc8L2Rpdj4nXS5qb2luKCcnKTtcblx0LyogZXNsaW50LWVuYWJsZSAqL1xuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBDT05TVEFOVFM7XG5cblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8qKlxuXHQgKiBAZmlsZW92ZXJ2aWV3IFV0aWxzIGZvciBjYWxlbmRhciBjb21wb25lbnRcblx0ICogQGF1dGhvciBOSE4gTmV0LiBGRSBkZXYgTGFiIDxkbF9qYXZhc2NyaXB0QG5obmVudC5jb20+XG5cdCAqIEBkZXBlbmRlbmN5IHR1aS1jb2RlLXNuaXBwZXQgfjEuMC4yXG5cdCAqL1xuXHRcblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0LyoqXG5cdCAqIFV0aWxzIG9mIGNhbGVuZGFyXG5cdCAqIEBuYW1lc3BhY2UgY2FsZW5kYXJVdGlsc1xuXHQgKiBAaWdub3JlXG5cdCAqL1xuXHR2YXIgdXRpbHMgPSB7XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybiBkYXRlIGhhc2ggYnkgcGFyYW1ldGVyLlxuXHQgICAgICogIGlmIHRoZXJlIGFyZSAzIHBhcmFtZXRlciwgdGhlIHBhcmFtZXRlciBpcyBjb3Jnbml6ZWQgRGF0ZSBvYmplY3Rcblx0ICAgICAqICBpZiB0aGVyZSBhcmUgbm8gcGFyYW1ldGVyLCByZXR1cm4gdG9kYXkncyBoYXNoIGRhdGVcblx0ICAgICAqIEBmdW5jdGlvbiBnZXREYXRlSGFzaFRhYmxlXG5cdCAgICAgKiBAbWVtYmVyb2YgY2FsZW5kYXJVdGlsc1xuXHQgICAgICogQHBhcmFtIHtEYXRlfG51bWJlcn0gW3llYXJdIEEgZGF0ZSBpbnN0YW5jZSBvciB5ZWFyXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gW21vbnRoXSBBIG1vbnRoXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gW2RhdGVdIEEgZGF0ZVxuXHQgICAgICogQHJldHVybnMge3t5ZWFyOiAqLCBtb250aDogKiwgZGF0ZTogKn19XG5cdCAgICAgKi9cblx0ICAgIGdldERhdGVIYXNoVGFibGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlKSB7XG5cdCAgICAgICAgdmFyIG5EYXRlO1xuXHRcblx0ICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDMpIHtcblx0ICAgICAgICAgICAgbkRhdGUgPSBhcmd1bWVudHNbMF0gfHwgbmV3IERhdGUoKTtcblx0XG5cdCAgICAgICAgICAgIHllYXIgPSBuRGF0ZS5nZXRGdWxsWWVhcigpO1xuXHQgICAgICAgICAgICBtb250aCA9IG5EYXRlLmdldE1vbnRoKCkgKyAxO1xuXHQgICAgICAgICAgICBkYXRlID0gbkRhdGUuZ2V0RGF0ZSgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgeWVhcjogeWVhcixcblx0ICAgICAgICAgICAgbW9udGg6IG1vbnRoLFxuXHQgICAgICAgICAgICBkYXRlOiBkYXRlXG5cdCAgICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm4gdG9kYXkgdGhhdCBzYXZlZCBvbiBjb21wb25lbnQgb3IgY3JlYXRlIG5ldyBkYXRlLlxuXHQgICAgICogQGZ1bmN0aW9uIGdldFRvZGF5XG5cdCAgICAgKiBAcmV0dXJucyB7e3llYXI6ICosIG1vbnRoOiAqLCBkYXRlOiAqfX1cblx0ICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG5cdCAgICAgKi9cblx0ICAgIGdldFRvZGF5OiBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZXR1cm4gdXRpbHMuZ2V0RGF0ZUhhc2hUYWJsZSgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdldCB3ZWVrcyBjb3VudCBieSBwYXJhbWVudGVyXG5cdCAgICAgKiBAZnVuY3Rpb24gZ2V0V2Vla3Ncblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcblx0ICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IOyjvCAoNH42KVxuXHQgICAgICogQG1lbWJlcm9mIGNhbGVuZGFyVXRpbHNcblx0ICAgICAqKi9cblx0ICAgIGdldFdlZWtzOiBmdW5jdGlvbih5ZWFyLCBtb250aCkge1xuXHQgICAgICAgIHZhciBmaXJzdERheSA9IHRoaXMuZ2V0Rmlyc3REYXkoeWVhciwgbW9udGgpLFxuXHQgICAgICAgICAgICBsYXN0RGF0ZSA9IHRoaXMuZ2V0TGFzdERhdGUoeWVhciwgbW9udGgpO1xuXHRcblx0ICAgICAgICByZXR1cm4gTWF0aC5jZWlsKChmaXJzdERheSArIGxhc3REYXRlKSAvIDcpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdldCB1bml4IHRpbWUgZnJvbSBkYXRlIGhhc2hcblx0ICAgICAqIEBmdW5jdGlvbiBnZXRUaW1lXG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0ZSBBIGRhdGUgaGFzaFxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUueWVhciBBIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlLm1vbnRoIEEgbW9udGhcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlLmRhdGUgQSBkYXRlXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuXHQgICAgICogQG1lbWJlcm9mIHV0aWxzXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogdXRpbHMuZ2V0VGltZSh7eWVhcjoyMDEwLCBtb250aDo1LCBkYXRlOjEyfSk7IC8vIDEyNzM1OTAwMDAwMDBcblx0ICAgICAqKi9cblx0ICAgIGdldFRpbWU6IGZ1bmN0aW9uKGRhdGUpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5nZXREYXRlT2JqZWN0KGRhdGUpLmdldFRpbWUoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgd2hpY2ggZGF5IGlzIGZpcnN0IGJ5IHBhcmFtZXRlcnMgdGhhdCBpbmNsdWRlIHllYXIgYW5kIG1vbnRoIGluZm9ybWF0aW9uLlxuXHQgICAgICogQGZ1bmN0aW9uIGdldEZpcnN0RGF5XG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMH42KVxuXHQgICAgICogQG1lbWJlcm9mIGNhbGVuZGFyVXRpbHNcblx0ICAgICAqKi9cblx0ICAgIGdldEZpcnN0RGF5OiBmdW5jdGlvbih5ZWFyLCBtb250aCkge1xuXHQgICAgICAgIHJldHVybiBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIDEpLmdldERheSgpO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEdldCB3aGljaCBkYXkgaXMgbGFzdCBieSBwYXJhbWV0ZXJzIHRoYXQgaW5jbHVkZSB5ZWFyIGFuZCBtb250aCBpbmZvcm1hdGlvbi5cblx0ICAgICAqIEBmdW5jdGlvbiBnZXRMYXN0RGF5XG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMH42KVxuXHQgICAgICogQG1lbWJlcm9mIGNhbGVuZGFyVXRpbHNcblx0ICAgICAqKi9cblx0ICAgIGdldExhc3REYXk6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIG1vbnRoLCAwKS5nZXREYXkoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgbGFzdCBkYXRlIGJ5IHBhcmFtZXRlcnMgdGhhdCBpbmNsdWRlIHllYXIgYW5kIG1vbnRoIGluZm9ybWF0aW9uLlxuXHQgICAgICogQGZ1bmN0aW9uXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHllYXJcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG5cdCAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMX4zMSlcblx0ICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG5cdCAgICAgKiovXG5cdCAgICBnZXRMYXN0RGF0ZTogZnVuY3Rpb24oeWVhciwgbW9udGgpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGgsIDApLmdldERhdGUoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBHZXQgZGF0ZSBpbnN0YW5jZS5cblx0ICAgICAqIEBmdW5jdGlvbiBnZXREYXRlT2JqZWN0XG5cdCAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0ZSBBIGRhdGUgaGFzaFxuXHQgICAgICogQHJldHVybnMge0RhdGV9IERhdGVcblx0ICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogIGNhbGVuZGFyVXRpbHMuZ2V0RGF0ZU9iamVjdCh7eWVhcjoyMDEwLCBtb250aDo1LCBkYXRlOjEyfSk7XG5cdCAgICAgKiAgY2FsZW5kYXJVdGlscy5nZXREYXRlT2JqZWN0KDIwMTAsIDUsIDEyKTsgLy95ZWFyLG1vbnRoLGRhdGVcblx0ICAgICAqKi9cblx0ICAgIGdldERhdGVPYmplY3Q6IGZ1bmN0aW9uKGRhdGUpIHtcblx0ICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykge1xuXHQgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0gLSAxLCBhcmd1bWVudHNbMl0pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUueWVhciwgZGF0ZS5tb250aCAtIDEsIGRhdGUuZGF0ZSk7XG5cdCAgICB9LFxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogR2V0IHJlbGF0ZWQgZGF0ZSBoYXNoIHdpdGggcGFyYW1ldGVycyB0aGF0IGluY2x1ZGUgZGF0ZSBpbmZvcm1hdGlvbi5cblx0ICAgICAqIEBmdW5jdGlvbiBnZXRSZWxhdGl2ZURhdGVcblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgcmVsYXRlZCB2YWx1ZSBmb3IgeWVhcih5b3UgY2FuIHVzZSArLy0pXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gbW9udGggQSByZWxhdGVkIHZhbHVlIGZvciBtb250aCAoeW91IGNhbiB1c2UgKy8tKVxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUgQSByZWxhdGVkIHZhbHVlIGZvciBkYXkgKHlvdSBjYW4gdXNlICsvLSlcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRlT2JqIHN0YW5kYXJkIGRhdGUgaGFzaFxuXHQgICAgICogQHJldHVybnMge09iamVjdH0gZGF0ZU9ialxuXHQgICAgICogQG1lbWJlcm9mIGNhbGVuZGFyVXRpbHNcblx0ICAgICAqIEBleGFtcGxlXG5cdCAgICAgKiAgY2FsZW5kYXJVdGlscy5nZXRSZWxhdGl2ZURhdGUoMSwgMCwgMCwge3llYXI6MjAwMCwgbW9udGg6MSwgZGF0ZToxfSk7IC8vIHt5ZWFyOjIwMDEsIG1vbnRoOjEsIGRhdGU6MX1cblx0ICAgICAqICBjYWxlbmRhclV0aWxzLmdldFJlbGF0aXZlRGF0ZSgwLCAwLCAtMSwge3llYXI6MjAxMCwgbW9udGg6MSwgZGF0ZToxfSk7IC8vIHt5ZWFyOjIwMDksIG1vbnRoOjEyLCBkYXRlOjMxfVxuXHQgICAgICoqL1xuXHQgICAgZ2V0UmVsYXRpdmVEYXRlOiBmdW5jdGlvbih5ZWFyLCBtb250aCwgZGF0ZSwgZGF0ZU9iaikge1xuXHQgICAgICAgIHZhciBuWWVhciA9IChkYXRlT2JqLnllYXIgKyB5ZWFyKSxcblx0ICAgICAgICAgICAgbk1vbnRoID0gKGRhdGVPYmoubW9udGggKyBtb250aCAtIDEpLFxuXHQgICAgICAgICAgICBuRGF0ZSA9IChkYXRlT2JqLmRhdGUgKyBkYXRlKSxcblx0ICAgICAgICAgICAgbkRhdGVPYmogPSBuZXcgRGF0ZShuWWVhciwgbk1vbnRoLCBuRGF0ZSk7XG5cdFxuXHQgICAgICAgIHJldHVybiB1dGlscy5nZXREYXRlSGFzaFRhYmxlKG5EYXRlT2JqKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDaGFnbmUgbnVtYmVyIDB+OSB0byAnMDB+MDknXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gbnVtYmVyIG51bWJlclxuXHQgICAgICogQHJldHVybnMge3N0cmluZ31cblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKiBAZXhhbXBsZVxuXHQgICAgICogIGNhbGVuZGFyVXRpbHMucHJlcGVuZExlYWRpbmdaZXJvKDApOyAvLyAgJzAwJ1xuXHQgICAgICogIGNhbGVuZGFyVXRpbHMucHJlcGVuZExlYWRpbmdaZXJvKDkpOyAvLyAgJzA5J1xuXHQgICAgICogIGNhbGVuZGFyVXRpbHMucHJlcGVuZExlYWRpbmdaZXJvKDEyKTsgLy8gICcxMidcblx0ICAgICAqL1xuXHQgICAgcHJlcGVuZExlYWRpbmdaZXJvOiBmdW5jdGlvbihudW1iZXIpIHtcblx0ICAgICAgICB2YXIgcHJlZml4ID0gJyc7XG5cdFxuXHQgICAgICAgIGlmIChudW1iZXIgPCAxMCkge1xuXHQgICAgICAgICAgICBwcmVmaXggPSAnMCc7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gcHJlZml4ICsgbnVtYmVyO1xuXHQgICAgfSxcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENoYWdlIHRleHQgYW5kIHJldHVybi5cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQSB0ZXh0IHRvIGNoYWduZVxuXHQgICAgICogQHBhcmFtIHtPYmplY3R9IG1hcCBBIGNoYWduZSBrZXksIHZhbHVlIHNldFxuXHQgICAgICogQHBhcmFtIHtSZWdFeHB9IHJlZyBBIHJlZ0V4cCB0byBjaGFnbmVcblx0ICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cdCAgICBnZXRDb252ZXJ0ZWRUaXRsZTogZnVuY3Rpb24oc3RyLCBtYXAsIHJlZykge1xuXHQgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKHJlZywgZnVuY3Rpb24obWF0Y2hlZFN0cmluZykge1xuXHQgICAgICAgICAgICByZXR1cm4gbWFwW21hdGNoZWRTdHJpbmddIHx8ICcnO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gc3RyO1xuXHQgICAgfVxuXHR9O1xuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSB1dGlscztcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gdHVpLWNvbXBvbmVudC1jYWxlbmRhci5taW4uanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJkaXN0XCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgYWY2NTUyNmY0MzFjMmYyYWZkZjciLCIndXNlIHN0cmljdCc7XG5cbnZhciBDYWxlbmRhciA9IHJlcXVpcmUoJy4vY2FsZW5kYXInKTtcblxudHVpLnV0aWwuZGVmaW5lTmFtZXNwYWNlKCd0dWkuY29tcG9uZW50Jywge1xuICAgIENhbGVuZGFyOiBDYWxlbmRhclxufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIEBmaWxlb3ZlcnZpZXcgQ2FsZW5kYXIgY29tcG9uZW50KGZyb20gUHVnIGNvbXBvbmVudClcbiAqIEBhdXRob3IgTkhOIEVudC4gRkUgZGV2IExhYiA8ZGxfamF2YXNjcmlwdEBuaG5lbnQuY29tPlxuICovXG4ndXNlIHN0cmljdCc7XG5cbnZhciBjYWxlbmRhclV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xudmFyIENPTlNUQU5UUyA9IHJlcXVpcmUoJy4vY29uc3RhbnRzJyk7XG5cbnZhciB1dGlsID0gdHVpLnV0aWw7XG52YXIgYmluZCA9IHV0aWwuYmluZDtcbnZhciBleHRlbmQgPSB1dGlsLmV4dGVuZDtcblxuLyoqXG4gKiBDYWxlbmRhciBjb21wb25lbnQgY2xhc3NcbiAqIEBjb25zdHJ1Y3RvclxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25dIEEgb3B0aW9ucyBmb3IgaW5pdGlhbGl6ZVxuICogICAgIEBwYXJhbSB7SFRNTEVsZW1lbnR9IG9wdGlvbi5lbGVtZW50IEEgcm9vdCBlbGVtZW50XG4gKiAgICAgQHBhcmFtIHtzdHJpbmd9IFtvcHRpb24uY2xhc3NQcmVmaXg9XCJjYWxlbmRhci1cIl0gQSBwcmVmaXggY2xhc3MgZm9yIG1hcmt1cCBzdHJ1Y3R1cmVcbiAqICAgICBAcGFyYW0ge251bWJlcn0gW29wdGlvbi55ZWFyPXRoaXMgeWVhcl0gQSB5ZWFyIGZvciBpbml0aWFsaXplXG4gKiAgICAgQHBhcmFtIHtudW1iZXJ9IFtvcHRpb24ubW9udGg9dGhpcyBtb250aF0gQSBtb250aCBmb3IgaW5pdGlhbGl6ZVxuICogICAgIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9uLnRpdGxlRm9ybWF0PVwieXl5eS1tbVwiXSBBIHRpdGxlIGZvcm1hdC5cbiAqICAgICAgICAgICAgICAgICAgICAgVGhpcyBjb21wb25lbnQgZmluZCB0aXRsZSBlbGVtZW50IGJ5IGNsYXNzTmFtZSAnW3ByZWZpeF10aXRsZSdcbiAqICAgICBAcGFyYW0ge3N0cmluZ30gW29wdGlvbi50b2RheUZvcm1hdCA9IFwieXl5eSBZZWFyIG1tIE1vbnRoIGRkIERheSAoRClcIl0gQSB0b2RheSBmb3JtYXQuXG4gKiAgICAgICAgICAgICAgICAgICAgIFRoaXMgY29tcG9uZW50IGZpbmQgdG9kYXkgZWxlbWVudCBieSBjbGFzc05hbWUgJ1twcmVmaXhddG9kYXknXG4gKiAgICAgQHBhcmFtIHtzdHJpbmd9IFtvcHRpb24ueWVhclRpdGxlRm9ybWF0ID0gXCJ5eXl5XCJdIEEgeWVhciB0aXRsZSBmb3JtYW50LlxuICogICAgICAgICAgICAgICAgICAgICAgVGhpcyBjb21wb25lbnQgZmluZCB5ZWFyIHRpdGxlIGVsZW1lbnQgYnkgY2xhc3NOYW1lICdbcHJlZml4XXllYXInXG4gKiAgICAgQHBhcmFtIHtzdHJpbmd9IFtvcHRpb24ubW9udGhUaXRsZUZvcm1hdCA9IFwibVwiXSBBIG1vbnRoIHRpdGxlIGZvcm1hdC5cbiAqICAgICAgICAgICAgICAgICAgICAgVGhpcyBjb21wb25lbnQgZmluZCBtb250aCB0aXRsZSBlbGVtZW50IGJ5IGNsYXNzTmFtZeydtCAnW3ByZWZpeF1tb250aCdcbiAqICAgICBAcGFyYW0ge0FycmF5fSBbb3B0aW9uLm1vbnRoVGl0bGVzID0gW1wiSkFOXCIsXCJGRUJcIixcIk1BUlwiLFwiQVBSXCIsXCJNQVlcIixcIkpVTlwiLFwiSlVMXCIsXCJBVUdcIixcIlNFUFwiLFwiT0NUXCIsXCJOT1ZcIixcIkRFQ1wiXV1cbiAqICAgICAgICAgICAgICAgICAgICBBIGxhYmVsIG9mIGVhY2ggbW9udGguXG4gKiAgICAgQHBhcmFtIHtBcnJheX0gW29wdGlvbi5kYXlUaXRsZXMgPSBbXCJTdW5cIixcIk1vblwiLFwiVHVlXCIsXCJXZWRcIixcIlRodVwiLFwiRnJpXCIsXCJTYXRcIl1dIEEgbGFiZWwgZm9yIGRheS5cbiAqICAgICAgICAgICAgICAgICAgICBJZiB5b3Ugc2V0IHRoZSBvdGhlciBvcHRpb24gdG9kYXlGb3JtYXQgJ0QnLCB5b3UgY2FuIHVzZSB0aGlzIG5hbWUuXG4gKiBAdHV0b3JpYWwgc2FtcGxlMVxuICogQHR1dG9yaWFsIHNhbXBsZTJcbiAqIEB0dXRvcmlhbCBzYW1wbGUzXG4gKiBAZXhhbXBsZVxuICogdmFyIGNhbGVuZGFyID0gbmV3IHR1aS5jb21wb25lbnQuQ2FsZW5kYXIoe1xuICogICAgIGVsZW1lbnQ6ICcjbGF5ZXInLFxuICogICAgIGNsYXNzUHJlZml4OiBcImNhbGVuZGFyLVwiLFxuICogICAgIHllYXI6IDE5ODMsXG4gKiAgICAgbW9udGg6IDUsXG4gKiAgICAgdGl0bGVGb3JtYXQ6IFwieXl5eS1tbVwiLCAvLyB0aXRsZVxuICogICAgIHRvZGF5Rm9ybWF0OiBcInl5eXkgLyBtbSAvIGRkIChEKVwiIC8vIHRvZGF5XG4gKiAgICAgeWVhclRpdGxlRm9ybWF0OiBcInl5eXlcIiwgLy8geWVhciB0aXRsZVxuICogICAgIG1vbnRoVGl0bGVGb3JtYXQ6IFwibVwiLCAvLyBtb250aCB0aXRsZVxuICogICAgIG1vbnRoVGl0bGVzOiBbXCJKQU5cIiwgXCJGRUJcIiwgXCJNQVJcIiwgXCJBUFJcIiwgXCJNQVlcIiwgXCJKVU5cIiwgXCJKVUxcIiwgXCJBVUdcIiwgXCJTRVBcIiwgXCJPQ1RcIiwgXCJOT1ZcIiwgXCJERUNcIl0sXG4gKiAgICAgZGF5VGl0bGVzOiBbJ3N1bicsICdtb24nLCAndHVlJywgJ3dlZCcsICd0aHUnLCAnZnJpJywgJ3NhdCddIC8vIGRheXNcbiAqICAgICBpdGVtQ291bnRPZlllYXI6IDEyXG4gKiB9KTtcbiAqL1xudmFyIENhbGVuZGFyID0gdXRpbC5kZWZpbmVDbGFzcygvKiogQGxlbmRzIENhbGVuZGFyLnByb3RvdHlwZSAqLyB7XG4gICAgaW5pdDogZnVuY3Rpb24ob3B0aW9uKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgb3B0aW9uc1xuICAgICAgICAgKiBvcHRpb246IHtcbiAgICAgICAgICogICAgIGNsYXNzUHJlZml4OiBzdHJpbmcsXG4gICAgICAgICAqICAgICB5ZWFyOiBudW1iZXJcbiAgICAgICAgICogICAgIG1vbnRoOiBudW1iZXJcbiAgICAgICAgICogICAgIHRpdGxlRm9ybWF0OiBzdHJpbmcsXG4gICAgICAgICAqICAgICB0b2RheUZvcm1hdDogc3RyaW5nLFxuICAgICAgICAgKiAgICAgeWVhclRpdGxlRm9ybWF0OiBzdHJpbmcsXG4gICAgICAgICAqICAgICBtb250aFRpdGxlRm9ybWF0OiBzdHJpbmcsXG4gICAgICAgICAqICAgICBtb250aFRpdGxlczogQXJyYXksXG4gICAgICAgICAqICAgICBkYXlUaXRsZXM6IEFycmF5LFxuICAgICAgICAgKiAgICAgaXRlbUNvdW50T2ZZZWFyOiBudW1iZXJcbiAgICAgICAgICogfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fb3B0aW9uID0ge307XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgZGF5IHRoYXQgaXMgc2hvd25cbiAgICAgICAgICogQHR5cGUge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fc2hvd25EYXRlID0ge1xuICAgICAgICAgICAgeWVhcjogMCxcbiAgICAgICAgICAgIG1vbnRoOiAxLFxuICAgICAgICAgICAgZGF0ZTogMVxuICAgICAgICB9O1xuXG4gICAgICAgIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgICAqIGpRdWVyeSAtIEhUTUxFbGVtZW50XG4gICAgICAgICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ki9cblxuICAgICAgICAvKipcbiAgICAgICAgICogPT09PT09PT09Um9vdCBFbGVtZW50PT09PT09PT09XG4gICAgICAgICAqIElmIG9wdGlvbnMgZG8gbm90IGluY2x1ZGUgZWxlbWVudCwgdGhpcyBjb21wb25lbnQgamVkZ2UgaW5pdGlhbGl6ZSBlbGVtZW50IHdpdGhvdXQgb3B0aW9uc1xuICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy4kZWxlbWVudCA9ICQob3B0aW9uLmVsZW1lbnQgfHwgYXJndW1lbnRzWzBdKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogPT09PT09PT09SGVhZGVyPT09PT09PT09XG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiRoZWFkZXIgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHRpbHRlXG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiR0aXRsZSA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgeWVhciB0aXRsZVxuICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy4kdGl0bGVZZWFyID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQSBtb250aCB0aXRsZVxuICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy4kdGl0bGVNb250aCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqID09PT09PT09PUJvZHk9PT09PT09PT1cbiAgICAgICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuJGJvZHkgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHRlbXBsYXRlIG9mIHdlZWtcbiAgICAgICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuJHdlZWtUZW1wbGF0ZSA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgd2VlayBwYXJlbnQgZWxlbWVudFxuICAgICAgICAgKiBAdHlwZSB7alF1ZXJ5fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy4kd2Vla0FwcGVuZFRhcmdldCA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgZGF0ZSBlbGVtZW50XG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl8kZGF0ZUVsZW1lbnQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGRhdGUgd3JhcHBlciBlbGVtZW50XG4gICAgICAgICAqIEB0eXBlIHtqUXVlcnl9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl8kZGF0ZUNvbnRhaW5lckVsZW1lbnQgPSBudWxsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA9PT09PT09PT1Gb290ZXI9PT09PT09PT1cbiAgICAgICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuJGZvb3RlciA9IG51bGw7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRvZGF5IGVsZW1lbnRcbiAgICAgICAgICogQHR5cGUge2pRdWVyeX1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuJHRvZGF5ID0gbnVsbDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5kZXggb2Ygc2hvd24gbGF5ZXJcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc2hvd25MYXllcklkeCA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERhdGEgb2YgbW9udGgncyBsYXllclxuICAgICAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5kYXRhT2ZNb250aExheWVyID0ge307XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERhdGEgb2YgeWVhcidzIGxheWVyXG4gICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmRhdGFPZlllYXJMYXllciA9IHt9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIHRpdGxlIGlzIGNsaWNrYWJsZSBvciBub3RcbiAgICAgICAgICogQHR5cGUge0Jvb2xlYW59XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmlzQ2xpY2thYmxlVGl0bGUgPSBmYWxzZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlcnMgYmluZGluZyBjb250ZXh0XG4gICAgICAgICAqIEB0eXBlIHtPYmplY3R9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmhhbmRsZXJzID0ge307XG5cbiAgICAgICAgLyoqIFNldCBkZWZhdWx0IG9wdGlvbnMgKi9cbiAgICAgICAgdGhpcy5fc2V0RGVmYXVsdChvcHRpb24pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXQgZGVmdWxhdCBvcGl0b25zXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25dIEEgb3B0aW9ucyB0byBpbml0aWFsemllIGNvbXBvbmVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldERlZmF1bHQ6IGZ1bmN0aW9uKG9wdGlvbikge1xuICAgICAgICB0aGlzLl9zZXRPcHRpb24ob3B0aW9uKTtcbiAgICAgICAgdGhpcy5fYXNzaWduSFRNTEVsZW1lbnRzKCk7XG4gICAgICAgIHRoaXMuX2F0dGFjaEV2ZW50KCk7XG4gICAgICAgIHRoaXMuZHJhdyh0aGlzLl9vcHRpb24ueWVhciwgdGhpcy5fb3B0aW9uLm1vbnRoLCBmYWxzZSwgMCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNhdmUgb3B0aW9uc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uXSBBIG9wdGlvbnMgdG8gaW5pdGlhbGl6ZSBjb21wb25lbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXRPcHRpb246IGZ1bmN0aW9uKG9wdGlvbikge1xuICAgICAgICB2YXIgaW5zdGFuY2VPcHRpb24gPSB0aGlzLl9vcHRpb24sXG4gICAgICAgICAgICB0b2RheSA9IGNhbGVuZGFyVXRpbHMuZ2V0RGF0ZUhhc2hUYWJsZSgpO1xuXG4gICAgICAgIHZhciBkZWZhdWx0T3B0aW9uID0ge1xuICAgICAgICAgICAgY2xhc3NQcmVmaXg6ICdjYWxlbmRhci0nLFxuICAgICAgICAgICAgeWVhcjogdG9kYXkueWVhcixcbiAgICAgICAgICAgIG1vbnRoOiB0b2RheS5tb250aCxcbiAgICAgICAgICAgIHRpdGxlRm9ybWF0OiAneXl5eS1tbScsXG4gICAgICAgICAgICB0b2RheUZvcm1hdDogJ3l5eXkvbW0vZGQgKEQpJyxcbiAgICAgICAgICAgIHllYXJUaXRsZUZvcm1hdDogJ3l5eXknLFxuICAgICAgICAgICAgbW9udGhUaXRsZUZvcm1hdDogJ20nLFxuICAgICAgICAgICAgbW9udGhUaXRsZXM6IFsnSkFOJywgJ0ZFQicsICdNQVInLCAnQVBSJywgJ01BWScsICdKVU4nLCAnSlVMJywgJ0FVRycsICdTRVAnLCAnT0NUJywgJ05PVicsICdERUMnXSxcbiAgICAgICAgICAgIGRheVRpdGxlczogWydTdW4nLCAnTW9uJywgJ1R1ZScsICdXZWQnLCAnVGh1JywgJ0ZyaScsICdTYXQnXSxcbiAgICAgICAgICAgIGl0ZW1Db3VudE9mWWVhcjogQ09OU1RBTlRTLml0ZW1Db3VudE9mWWVhclxuICAgICAgICB9O1xuICAgICAgICBleHRlbmQoaW5zdGFuY2VPcHRpb24sIGRlZmF1bHRPcHRpb24sIG9wdGlvbik7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBlbGVtZW50IHRvIGZpbGVkXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYXNzaWduSFRNTEVsZW1lbnRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsYXNzUHJlZml4ID0gdGhpcy5fb3B0aW9uLmNsYXNzUHJlZml4LFxuICAgICAgICAgICAgJGVsZW1lbnQgPSB0aGlzLiRlbGVtZW50LFxuICAgICAgICAgICAgY2xhc3NTZWxlY3RvciA9ICcuJyArIGNsYXNzUHJlZml4O1xuXG4gICAgICAgIHRoaXMuX2Fzc2lnbkhlYWRlcigkZWxlbWVudCwgY2xhc3NTZWxlY3RvciwgY2xhc3NQcmVmaXgpO1xuICAgICAgICB0aGlzLl9hc3NpZ25Cb2R5KCRlbGVtZW50LCBjbGFzc1NlbGVjdG9yLCBjbGFzc1ByZWZpeCk7XG4gICAgICAgIHRoaXMuX2Fzc2lnbkZvb3RlcigkZWxlbWVudCwgY2xhc3NTZWxlY3RvciwgY2xhc3NQcmVmaXgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBoZWFkZXIgZWxlbWVudC5cbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1lbnQgVGhlIHJvb3QgZWxlbWVudCBvZiBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NTZWxlY3RvciBBIGNsYXNzIHNlbGVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzUHJlZml4IEEgcHJlZml4IGZvciBjbGFzc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2Fzc2lnbkhlYWRlcjogZnVuY3Rpb24oJGVsZW1lbnQsIGNsYXNzU2VsZWN0b3IsIGNsYXNzUHJlZml4KSB7XG4gICAgICAgIHZhciAkaGVhZGVyID0gJGVsZW1lbnQuZmluZChjbGFzc1NlbGVjdG9yICsgJ2hlYWRlcicpLFxuICAgICAgICAgICAgaGVhZGVyVGVtcGxhdGUsXG4gICAgICAgICAgICBkZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHAsXG4gICAgICAgICAgICBrZXkgPSBDT05TVEFOVFMucmVsYXRpdmVNb250aFZhbHVlS2V5LFxuICAgICAgICAgICAgYnRuQ2xhc3NOYW1lID0gJ2J0bi0nO1xuXG4gICAgICAgIGlmICghJGhlYWRlci5sZW5ndGgpIHtcbiAgICAgICAgICAgIGhlYWRlclRlbXBsYXRlID0gQ09OU1RBTlRTLmNhbGVuZGFySGVhZGVyO1xuICAgICAgICAgICAgZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwID0gQ09OU1RBTlRTLmRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cDtcblxuICAgICAgICAgICAgJGhlYWRlciA9ICQoaGVhZGVyVGVtcGxhdGUucmVwbGFjZShkZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHAsIGNsYXNzUHJlZml4KSk7XG4gICAgICAgICAgICAkZWxlbWVudC5hcHBlbmQoJGhlYWRlcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBidXR0b25cbiAgICAgICAgJGhlYWRlci5maW5kKGNsYXNzU2VsZWN0b3IgKyBidG5DbGFzc05hbWUgKyBDT05TVEFOVFMucHJldlllYXIpLmRhdGEoa2V5LCAtMTIpO1xuICAgICAgICAkaGVhZGVyLmZpbmQoY2xhc3NTZWxlY3RvciArIGJ0bkNsYXNzTmFtZSArIENPTlNUQU5UUy5wcmV2TW9udGgpLmRhdGEoa2V5LCAtMSk7XG4gICAgICAgICRoZWFkZXIuZmluZChjbGFzc1NlbGVjdG9yICsgYnRuQ2xhc3NOYW1lICsgQ09OU1RBTlRTLm5leHRZZWFyKS5kYXRhKGtleSwgMTIpO1xuICAgICAgICAkaGVhZGVyLmZpbmQoY2xhc3NTZWxlY3RvciArIGJ0bkNsYXNzTmFtZSArIENPTlNUQU5UUy5uZXh0TW9udGgpLmRhdGEoa2V5LCAxKTtcblxuICAgICAgICAvLyB0aXRsZSB0ZXh0XG4gICAgICAgIHRoaXMuJHRpdGxlID0gJGhlYWRlci5maW5kKGNsYXNzU2VsZWN0b3IgKyAndGl0bGUnKTtcbiAgICAgICAgdGhpcy4kdGl0bGVZZWFyID0gJGhlYWRlci5maW5kKGNsYXNzU2VsZWN0b3IgKyAndGl0bGUteWVhcicpO1xuICAgICAgICB0aGlzLiR0aXRsZU1vbnRoID0gJGhlYWRlci5maW5kKGNsYXNzU2VsZWN0b3IgKyAndGl0bGUtbW9udGgnKTtcblxuICAgICAgICB0aGlzLiRoZWFkZXIgPSAkaGVhZGVyO1xuXG4gICAgICAgIGlmICh0aGlzLiR0aXRsZS5oYXNDbGFzcyh0aGlzLl9vcHRpb24uY2xhc3NQcmVmaXggKyBDT05TVEFOVFMuY2xpY2thYmxlKSkge1xuICAgICAgICAgICAgdGhpcy5pc0NsaWNrYWJsZVRpdGxlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBib2R5IGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1lbnQgVGhlIHJvb3QgZWxtZW50IG9mIGNvbXBvbmVudFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1NlbGVjdG9yIEEgc2VsZWN0b3JcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NQcmVmaXggQSBwcmVmaXggZm9yIGNsYXNzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYXNzaWduQm9keTogZnVuY3Rpb24oJGVsZW1lbnQsIGNsYXNzU2VsZWN0b3IsIGNsYXNzUHJlZml4KSB7XG4gICAgICAgIHZhciAkYm9keSA9ICRlbGVtZW50LmZpbmQoY2xhc3NTZWxlY3RvciArICdib2R5JyksXG4gICAgICAgICAgICBib2R5VGVtcGxhdGUsXG4gICAgICAgICAgICBkZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHA7XG5cbiAgICAgICAgaWYgKCEkYm9keS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGJvZHlUZW1wbGF0ZSA9IENPTlNUQU5UUy5jYWxlbmRhckJvZHk7XG4gICAgICAgICAgICBkZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHAgPSBDT05TVEFOVFMuZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwO1xuXG4gICAgICAgICAgICAkYm9keSA9ICQoYm9keVRlbXBsYXRlLnJlcGxhY2UoZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwLCBjbGFzc1ByZWZpeCkpO1xuICAgICAgICAgICAgJGVsZW1lbnQuYXBwZW5kKCRib2R5KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2Fzc2lnbldlZWsoY2xhc3NTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2Fzc2lnbk1vbnRoTGF5ZXIoY2xhc3NTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2Fzc2lnblllYXJMYXllcihjbGFzc1NlbGVjdG9yKTtcblxuICAgICAgICB0aGlzLiRib2R5ID0gJGJvZHkuaGlkZSgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciB3ZWVrIGVsZW1udCBvbiBib2R5XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzU2VsZWN0b3IgQSBzZWxlY3RvclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2Fzc2lnbldlZWs6IGZ1bmN0aW9uKGNsYXNzU2VsZWN0b3IpIHtcbiAgICAgICAgdmFyICRib2R5ID0gdGhpcy4kZWxlbWVudC5maW5kKGNsYXNzU2VsZWN0b3IgKyAnYm9keScpO1xuICAgICAgICB2YXIgJHdlZWtUZW1wbGF0ZSA9ICRib2R5LmZpbmQoY2xhc3NTZWxlY3RvciArICd3ZWVrJyk7XG5cbiAgICAgICAgdGhpcy4kd2Vla1RlbXBsYXRlID0gJHdlZWtUZW1wbGF0ZS5jbG9uZSh0cnVlKTtcbiAgICAgICAgdGhpcy4kd2Vla0FwcGVuZFRhcmdldCA9ICR3ZWVrVGVtcGxhdGUucGFyZW50KCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIGVsZW1lbnQgb2YgbW9udGgncyBsYXllciBhbmQgc2F2ZSBkcmF3aW5nIGluZm9cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NTZWxlY3RvciBBIHNlbGVjdG9yXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYXNzaWduTW9udGhMYXllcjogZnVuY3Rpb24oY2xhc3NTZWxlY3Rvcikge1xuICAgICAgICB2YXIgJGJvZHkgPSB0aGlzLiRlbGVtZW50LmZpbmQoY2xhc3NTZWxlY3RvciArICdib2R5Jyk7XG4gICAgICAgIHZhciAkbW9udGhzVGVtcGxhdGUgPSAkYm9keS5maW5kKGNsYXNzU2VsZWN0b3IgKyAnbW9udGgtZ3JvdXAnKTtcbiAgICAgICAgdmFyIGNvbHMgPSAkbW9udGhzVGVtcGxhdGUuZmluZChjbGFzc1NlbGVjdG9yICsgJ21vbnRoJykubGVuZ3RoO1xuICAgICAgICB2YXIgcm93cyA9IE1hdGguY2VpbCh0aGlzLl9vcHRpb24ubW9udGhUaXRsZXMubGVuZ3RoIC8gY29scyk7XG5cbiAgICAgICAgdGhpcy5kYXRhT2ZNb250aExheWVyID0ge1xuICAgICAgICAgICAgdGVtcGxhdGU6ICRtb250aHNUZW1wbGF0ZS5jbG9uZSh0cnVlKSxcbiAgICAgICAgICAgIGFwcGVuZGVkVGFyZ2V0OiAkbW9udGhzVGVtcGxhdGUucGFyZW50KCksXG4gICAgICAgICAgICBmcmFtZToge1xuICAgICAgICAgICAgICAgIGNvbHM6IGNvbHMsXG4gICAgICAgICAgICAgICAgcm93czogcm93c1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBlbGVtZW50IG9mIHllYXIncyBsYXllciBhbmQgc2F2ZSBkcmF3aW5nIGluZm9cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NTZWxlY3RvciBBIHNlbGVjdG9yXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfYXNzaWduWWVhckxheWVyOiBmdW5jdGlvbihjbGFzc1NlbGVjdG9yKSB7XG4gICAgICAgIHZhciAkYm9keSA9IHRoaXMuJGVsZW1lbnQuZmluZChjbGFzc1NlbGVjdG9yICsgJ2JvZHknKTtcbiAgICAgICAgdmFyICR5ZWFyc1RlbXBsYXRlID0gJGJvZHkuZmluZChjbGFzc1NlbGVjdG9yICsgJ3llYXItZ3JvdXAnKTtcbiAgICAgICAgdmFyIGNvbHMgPSAkeWVhcnNUZW1wbGF0ZS5maW5kKGNsYXNzU2VsZWN0b3IgKyAneWVhcicpLmxlbmd0aDtcbiAgICAgICAgdmFyIHJvd3MgPSBNYXRoLmNlaWwodGhpcy5fb3B0aW9uLml0ZW1Db3VudE9mWWVhciAvIGNvbHMpO1xuXG4gICAgICAgIHRoaXMuZGF0YU9mWWVhckxheWVyID0ge1xuICAgICAgICAgICAgdGVtcGxhdGU6ICR5ZWFyc1RlbXBsYXRlLmNsb25lKHRydWUpLFxuICAgICAgICAgICAgYXBwZW5kZWRUYXJnZXQ6ICR5ZWFyc1RlbXBsYXRlLnBhcmVudCgpLFxuICAgICAgICAgICAgZnJhbWU6IHtcbiAgICAgICAgICAgICAgICBjb2xzOiBjb2xzLFxuICAgICAgICAgICAgICAgIHJvd3M6IHJvd3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXIgZm9vdGVyIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGVsZW1lbnQgVGhlIHJvb3QgZWxlbWVudCBvZiBjb21wb25lbnRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2xhc3NTZWxlY3RvciBBIHNlbGVjdG9yXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNsYXNzUHJlZml4IEEgcHJlZml4IGZvciBjbGFzc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2Fzc2lnbkZvb3RlcjogZnVuY3Rpb24oJGVsZW1lbnQsIGNsYXNzU2VsZWN0b3IsIGNsYXNzUHJlZml4KSB7XG4gICAgICAgIHZhciAkZm9vdGVyID0gJGVsZW1lbnQuZmluZChjbGFzc1NlbGVjdG9yICsgJ2Zvb3RlcicpLFxuICAgICAgICAgICAgZm9vdGVyVGVtcGxhdGUsXG4gICAgICAgICAgICBkZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHA7XG5cbiAgICAgICAgaWYgKCEkZm9vdGVyLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9vdGVyVGVtcGxhdGUgPSBDT05TVEFOVFMuY2FsZW5kYXJGb290ZXI7XG4gICAgICAgICAgICBkZWZhdWx0Q2xhc3NQcmVmaXhSZWdFeHAgPSBDT05TVEFOVFMuZGVmYXVsdENsYXNzUHJlZml4UmVnRXhwO1xuXG4gICAgICAgICAgICAkZm9vdGVyID0gJChmb290ZXJUZW1wbGF0ZS5yZXBsYWNlKGRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cCwgY2xhc3NQcmVmaXgpKTtcbiAgICAgICAgICAgICRlbGVtZW50LmFwcGVuZCgkZm9vdGVyKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiR0b2RheSA9ICRmb290ZXIuZmluZChjbGFzc1NlbGVjdG9yICsgJ3RvZGF5Jyk7XG4gICAgICAgIHRoaXMuJGZvb3RlciA9ICRmb290ZXI7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBldmVudCBoYW5kbGVycyBhbmQgYXR0YWNoIGV2ZW50IG9uIGVsZW1lbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9hdHRhY2hFdmVudDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuY2xpY2tSb2xsb3ZlckJ0biA9IGJpbmQodGhpcy5fb25DbGlja1JvbGxvdmVyQnV0dG9uLCB0aGlzKTtcblxuICAgICAgICB0aGlzLmF0dGFjaEV2ZW50VG9Sb2xsb3ZlckJ0bigpO1xuXG4gICAgICAgIGV4dGVuZCh0aGlzLmhhbmRsZXJzLCB7XG4gICAgICAgICAgICBjbGlja1RpdGxlOiBiaW5kKHRoaXMuX29uQ2xpY2tUaXRsZSwgdGhpcyksXG4gICAgICAgICAgICBjbGlja1llYXJMYXllcjogYmluZCh0aGlzLl9vbkNsaWNrWWVhckxheWVyLCB0aGlzKSxcbiAgICAgICAgICAgIGNsaWNrTW9udGhMYXllcjogYmluZCh0aGlzLl9vbkNsaWNrTW9udGhMYXllciwgdGhpcylcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMuaXNDbGlja2FibGVUaXRsZSkge1xuICAgICAgICAgICAgdGhpcy5hdHRhY2hFdmVudFRvVGl0bGUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmF0dGFjaEV2ZW50VG9Cb2R5KCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEF0dGFjaCBldmVudCBvbiByb2xsb3ZlciBidXR0b25zIGluIFwiaGVhZGVyXCIgZWxlbWVudFxuICAgICAqL1xuICAgIGF0dGFjaEV2ZW50VG9Sb2xsb3ZlckJ0bjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzZWxlY3RvciA9ICcuJyArIHRoaXMuX29wdGlvbi5jbGFzc1ByZWZpeCArICdyb2xsb3Zlcic7XG4gICAgICAgIHZhciBidG5zID0gdGhpcy4kaGVhZGVyLmZpbmQoc2VsZWN0b3IpO1xuXG4gICAgICAgIGJ0bnMub24oJ2NsaWNrJywgdGhpcy5oYW5kbGVycy5jbGlja1JvbGxvdmVyQnRuKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRGV0YWNoIGV2ZW50IG9uIHJvbGxvdmVyIGJ1dHRvbnMgaW4gXCJoZWFkZXJcIiBlbGVtZW50XG4gICAgICovXG4gICAgZGV0YWNoRXZlbnRUb1JvbGxvdmVyQnRuOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGVjdG9yID0gJy4nICsgdGhpcy5fb3B0aW9uLmNsYXNzUHJlZml4ICsgJ3JvbGxvdmVyJztcbiAgICAgICAgdmFyIGJ0bnMgPSB0aGlzLiRoZWFkZXIuZmluZChzZWxlY3Rvcik7XG5cbiAgICAgICAgYnRucy5vZmYoJ2NsaWNrJywgdGhpcy5oYW5kbGVycy5jbGlja1JvbGxvdmVyQnRuKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQXR0YWNoIGV2ZW50IG9uIHRpdGxlIGluIFwiaGVhZGVyXCIgZWxlbWVudFxuICAgICAqL1xuICAgIGF0dGFjaEV2ZW50VG9UaXRsZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJHRpdGxlLm9uKCdjbGljaycsIHRoaXMuaGFuZGxlcnMuY2xpY2tUaXRsZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERldGFjaCBldmVudCBvbiB0aXRsZSBpbiBcImhlYWRlclwiIGVsZW1lbnRcbiAgICAgKi9cbiAgICBkZXRhY2hFdmVudFRvVGl0bGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiR0aXRsZS5vZmYoJ2NsaWNrJywgdGhpcy5oYW5kbGVycy5jbGlja1RpdGxlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQXR0YWNoIGV2ZW50IG9uIHRpdGxlIGluIFwiYm9keVwiIGVsZW1lbnQgKG1vbnRoICYgeWVhciBsYXllcilcbiAgICAgKi9cbiAgICBhdHRhY2hFdmVudFRvQm9keTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjbGFzc1ByZWZpeCA9ICcuJyArIHRoaXMuX29wdGlvbi5jbGFzc1ByZWZpeDtcbiAgICAgICAgdmFyIHllYXJMYXllciA9IHRoaXMuZGF0YU9mWWVhckxheWVyLmFwcGVuZGVkVGFyZ2V0O1xuICAgICAgICB2YXIgbW9udGhMYXllciA9IHRoaXMuZGF0YU9mTW9udGhMYXllci5hcHBlbmRlZFRhcmdldDtcblxuICAgICAgICB5ZWFyTGF5ZXIub24oJ2NsaWNrJywgY2xhc3NQcmVmaXggKyAneWVhcicsIHRoaXMuaGFuZGxlcnMuY2xpY2tZZWFyTGF5ZXIpO1xuICAgICAgICBtb250aExheWVyLm9uKCdjbGljaycsIGNsYXNzUHJlZml4ICsgJ21vbnRoJywgdGhpcy5oYW5kbGVycy5jbGlja01vbnRoTGF5ZXIpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEZXRhY2ggZXZlbnQgb24gdGl0bGUgaW4gXCJib2R5XCIgZWxlbWVudCAobW9udGggJiB5ZWFyIGxheWVyKVxuICAgICAqL1xuICAgIGRldGFjaEV2ZW50VG9Cb2R5OiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsYXNzUHJlZml4ID0gJy4nICsgdGhpcy5fb3B0aW9uLmNsYXNzUHJlZml4O1xuICAgICAgICB2YXIgeWVhckxheWVyID0gdGhpcy5kYXRhT2ZZZWFyTGF5ZXIuYXBwZW5kZWRUYXJnZXQ7XG4gICAgICAgIHZhciBtb250aExheWVyID0gdGhpcy5kYXRhT2ZNb250aExheWVyLmFwcGVuZGVkVGFyZ2V0O1xuXG4gICAgICAgIHllYXJMYXllci5vZmYoJ2NsaWNrJywgY2xhc3NQcmVmaXggKyAneWVhcicsIHRoaXMuaGFuZGxlcnMuY2xpY2tZZWFyTGF5ZXIpO1xuICAgICAgICBtb250aExheWVyLm9mZignY2xpY2snLCBjbGFzc1ByZWZpeCArICdtb250aCcsIHRoaXMuaGFuZGxlcnMuY2xpY2tNb250aExheWVyKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRXZlbnQgaGFuZGxlciAtIGNsaWNrIG9uIHJvbGxvdmVyIGJ1dHRvbnNcbiAgICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50IC0gTW91c2UgZXZlbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9vbkNsaWNrUm9sbG92ZXJCdXR0b246IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHZhciByZWxhdGl2ZU1vbnRoVmFsdWUgPSAkKGV2ZW50LmN1cnJlbnRUYXJnZXQpLmRhdGEoQ09OU1RBTlRTLnJlbGF0aXZlTW9udGhWYWx1ZUtleSk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuZHJhdygwLCByZWxhdGl2ZU1vbnRoVmFsdWUsIHRydWUpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBFdmVudCBoYW5kbGVyIC0gY2xpY2sgb24gdGl0bGVcbiAgICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50IC0gTW91c2UgZXZlbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9vbkNsaWNrVGl0bGU6IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIHZhciBzaG93bkxheWVySWR4ID0gdGhpcy5zaG93bkxheWVySWR4O1xuICAgICAgICB2YXIgZGF0ZTtcblxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGlmIChzaG93bkxheWVySWR4ID09PSAyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBzaG93bkxheWVySWR4ID0gKHNob3duTGF5ZXJJZHggIT09IDIpID8gKHNob3duTGF5ZXJJZHggKyAxKSA6IDA7XG4gICAgICAgIGRhdGUgPSB0aGlzLmdldERhdGUoKTtcblxuICAgICAgICB0aGlzLmRyYXcoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoLCBmYWxzZSwgc2hvd25MYXllcklkeCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgLSBjbGljayBvbiBtb250aCdzIGxheWVyXG4gICAgICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudCAtIE1vdXNlIGV2ZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfb25DbGlja1llYXJMYXllcjogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgdmFyIHJlbGF0aXZlTW9udGhWYWx1ZSA9ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZGF0YShDT05TVEFOVFMucmVsYXRpdmVNb250aFZhbHVlS2V5KTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5kcmF3KDAsIHJlbGF0aXZlTW9udGhWYWx1ZSwgdHJ1ZSwgMSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXIgLSBjbGljayBvbiB5ZWFyJ3MgbGF5ZXJcbiAgICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50IC0gTW91c2UgZXZlbnRcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9vbkNsaWNrTW9udGhMYXllcjogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgdmFyIHJlbGF0aXZlTW9udGhWYWx1ZSA9ICQoZXZlbnQuY3VycmVudFRhcmdldCkuZGF0YShDT05TVEFOVFMucmVsYXRpdmVNb250aFZhbHVlS2V5KTtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5kcmF3KDAsIHJlbGF0aXZlTW9udGhWYWx1ZSwgdHJ1ZSwgMCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBIYXNoIGRhdGEgdG8gZHJvdyBjYWxlbmRhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNSZWxhdGl2ZV0gIFdoZXRoZXIgaXMgcmVsYXRlZCBvdGhlciB2YWx1ZSBvciBub3RcbiAgICAgKiBAcmV0dXJucyB7e3llYXI6IG51bWJlciwgbW9udGg6IG51bWJlcn19IEEgZGF0ZSBoYXNoXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZ2V0RGF0ZUZvckRyYXdpbmc6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBpc1JlbGF0aXZlKSB7XG4gICAgICAgIHZhciBuRGF0ZSA9IHRoaXMuZ2V0RGF0ZSgpLFxuICAgICAgICAgICAgcmVsYXRpdmVEYXRlO1xuXG4gICAgICAgIG5EYXRlLmRhdGUgPSAxO1xuICAgICAgICBpZiAoIXV0aWwuaXNOdW1iZXIoeWVhcikgJiYgIXV0aWwuaXNOdW1iZXIobW9udGgpKSB7XG4gICAgICAgICAgICByZXR1cm4gbkRhdGU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNSZWxhdGl2ZSkge1xuICAgICAgICAgICAgcmVsYXRpdmVEYXRlID0gY2FsZW5kYXJVdGlscy5nZXRSZWxhdGl2ZURhdGUoeWVhciwgbW9udGgsIDAsIG5EYXRlKTtcbiAgICAgICAgICAgIG5EYXRlLnllYXIgPSByZWxhdGl2ZURhdGUueWVhcjtcbiAgICAgICAgICAgIG5EYXRlLm1vbnRoID0gcmVsYXRpdmVEYXRlLm1vbnRoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbkRhdGUueWVhciA9IHllYXIgfHwgbkRhdGUueWVhcjtcbiAgICAgICAgICAgIG5EYXRlLm1vbnRoID0gbW9udGggfHwgbkRhdGUubW9udGg7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbkRhdGU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEp1ZGdlIHRvIHJlZHJhdyBjYWxlbmRhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHJlZmxvd1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2lzTmVjZXNzYXJ5Rm9yRHJhd2luZzogZnVuY3Rpb24oeWVhciwgbW9udGgpIHtcbiAgICAgICAgdmFyIHNob3duRGF0ZSA9IHRoaXMuX3Nob3duRGF0ZTtcblxuICAgICAgICByZXR1cm4gKHNob3duRGF0ZS55ZWFyICE9PSB5ZWFyIHx8IHNob3duRGF0ZS5tb250aCAhPT0gbW9udGgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEcmF3IGNhbGVuZGFyIHRleHRcbiAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyBUaGEgaGFzaCB0aGF0IHNob3cgdXAgb24gY2FsZW5kYXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXRDYWxlbmRhclRleHQ6IGZ1bmN0aW9uKGRhdGVGb3JEcmF3aW5nKSB7XG4gICAgICAgIHZhciB5ZWFyID0gZGF0ZUZvckRyYXdpbmcueWVhcixcbiAgICAgICAgICAgIG1vbnRoID0gZGF0ZUZvckRyYXdpbmcubW9udGg7XG5cbiAgICAgICAgdGhpcy5fc2V0Q2FsZW5kYXJUb2RheSgpO1xuICAgICAgICB0aGlzLl9zZXRDYWxlbmRhclRpdGxlKHllYXIsIG1vbnRoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRHJhdyBkYXRlcyBieSBtb250aC5cbiAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyBBIGRhdGUgdG8gZHJhd1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1ByZWZpeCBBIGNsYXNzIHByZWZpeFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2RyYXdEYXRlczogZnVuY3Rpb24oZGF0ZUZvckRyYXdpbmcsIGNsYXNzUHJlZml4KSB7XG4gICAgICAgIHZhciB5ZWFyID0gZGF0ZUZvckRyYXdpbmcueWVhcixcbiAgICAgICAgICAgIG1vbnRoID0gZGF0ZUZvckRyYXdpbmcubW9udGgsXG4gICAgICAgICAgICBkYXlJbldlZWsgPSAwLFxuICAgICAgICAgICAgZGF0ZVByZXZNb250aCA9IGNhbGVuZGFyVXRpbHMuZ2V0UmVsYXRpdmVEYXRlKDAsIC0xLCAwLCBkYXRlRm9yRHJhd2luZyksXG4gICAgICAgICAgICBkYXRlTmV4dE1vbnRoID0gY2FsZW5kYXJVdGlscy5nZXRSZWxhdGl2ZURhdGUoMCwgMSwgMCwgZGF0ZUZvckRyYXdpbmcpLFxuICAgICAgICAgICAgZGF0ZXMgPSBbXSxcbiAgICAgICAgICAgIGZpcnN0RGF5ID0gY2FsZW5kYXJVdGlscy5nZXRGaXJzdERheSh5ZWFyLCBtb250aCksXG4gICAgICAgICAgICBpbmRleE9mTGFzdERhdGUgPSB0aGlzLl9maWxsRGF0ZXMoeWVhciwgbW9udGgsIGRhdGVzKTtcblxuICAgICAgICB1dGlsLmZvckVhY2goZGF0ZXMsIGZ1bmN0aW9uKGRhdGUsIGkpIHtcbiAgICAgICAgICAgIHZhciBpc1ByZXZNb250aCA9IGZhbHNlLFxuICAgICAgICAgICAgICAgIGlzTmV4dE1vbnRoID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgJGRhdGVDb250YWluZXIgPSAkKHRoaXMuXyRkYXRlQ29udGFpbmVyRWxlbWVudFtpXSksXG4gICAgICAgICAgICAgICAgdGVtcFllYXIgPSB5ZWFyLFxuICAgICAgICAgICAgICAgIHRlbXBNb250aCA9IG1vbnRoLFxuICAgICAgICAgICAgICAgIGV2ZW50RGF0YTtcblxuICAgICAgICAgICAgaWYgKGkgPCBmaXJzdERheSkge1xuICAgICAgICAgICAgICAgIGlzUHJldk1vbnRoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAkZGF0ZUNvbnRhaW5lci5hZGRDbGFzcyhjbGFzc1ByZWZpeCArIENPTlNUQU5UUy5wcmV2TW9udGgpO1xuICAgICAgICAgICAgICAgIHRlbXBZZWFyID0gZGF0ZVByZXZNb250aC55ZWFyO1xuICAgICAgICAgICAgICAgIHRlbXBNb250aCA9IGRhdGVQcmV2TW9udGgubW9udGg7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGkgPiBpbmRleE9mTGFzdERhdGUpIHtcbiAgICAgICAgICAgICAgICBpc05leHRNb250aCA9IHRydWU7XG4gICAgICAgICAgICAgICAgJGRhdGVDb250YWluZXIuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyBDT05TVEFOVFMubmV4dE1vbnRoKTtcbiAgICAgICAgICAgICAgICB0ZW1wWWVhciA9IGRhdGVOZXh0TW9udGgueWVhcjtcbiAgICAgICAgICAgICAgICB0ZW1wTW9udGggPSBkYXRlTmV4dE1vbnRoLm1vbnRoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBXZWVrZW5kXG4gICAgICAgICAgICB0aGlzLl9zZXRXZWVrZW5kKGRheUluV2VlaywgJGRhdGVDb250YWluZXIsIGNsYXNzUHJlZml4KTtcblxuICAgICAgICAgICAgLy8gVG9kYXlcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1RvZGF5KHRlbXBZZWFyLCB0ZW1wTW9udGgsIGRhdGUpKSB7XG4gICAgICAgICAgICAgICAgJGRhdGVDb250YWluZXIuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyAndG9kYXknKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXZlbnREYXRhID0ge1xuICAgICAgICAgICAgICAgICRkYXRlOiAkKHRoaXMuXyRkYXRlRWxlbWVudC5nZXQoaSkpLFxuICAgICAgICAgICAgICAgICRkYXRlQ29udGFpbmVyOiAkZGF0ZUNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICB5ZWFyOiB0ZW1wWWVhcixcbiAgICAgICAgICAgICAgICBtb250aDogdGVtcE1vbnRoLFxuICAgICAgICAgICAgICAgIGRhdGU6IGRhdGUsXG4gICAgICAgICAgICAgICAgaXNQcmV2TW9udGg6IGlzUHJldk1vbnRoLFxuICAgICAgICAgICAgICAgIGlzTmV4dE1vbnRoOiBpc05leHRNb250aCxcbiAgICAgICAgICAgICAgICBodG1sOiBkYXRlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJChldmVudERhdGEuJGRhdGUpLmh0bWwoZXZlbnREYXRhLmh0bWwudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBkYXlJbldlZWsgPSAoZGF5SW5XZWVrICsgMSkgJSA3O1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEZpcmUgZHJhdyBldmVudCB3aGVuIGNhbGVuZGFyIGRyYXcgZWFjaCBkYXRlLlxuICAgICAgICAgICAgICogQGFwaVxuICAgICAgICAgICAgICogQGV2ZW50IENhbGVuZGFyI2RyYXdcbiAgICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIEEgbmFtZSBvZiBjdXN0b20gZXZlbnRcbiAgICAgICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNQcmV2TW9udGggV2hldGhlciB0aGUgZHJhdyBkYXkgaXMgbGFzdCBtb250aCBvciBub3RcbiAgICAgICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNOZXh0TW9udGggV2VodGVyIHRoZSBkcmF3IGRheSBpcyBuZXh0IG1vbnRoIG9yIG5vdFxuICAgICAgICAgICAgICogQHBhcmFtIHtqUXVlcnl9ICRkYXRlIFRoZSBlbGVtZW50IGhhdmUgZGF0ZSBodG1sXG4gICAgICAgICAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGRhdGVDb250YWluZXIgQ2hpbGQgZWxlbWVudCB0aGF0IGhhcyBjbGFzc05hbWUgW3ByZWZpeF13ZWVrLlxuICAgICAgICAgICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0IGlzIHBvc3NpYmxlIHRoaXMgZWxlbWVudCBlcXVlbCBlbERhdGUuXG4gICAgICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gZGF0ZSBBIGRyYXcgZGF0ZVxuICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgZHJhdyBtb250aFxuICAgICAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSBkcmF3IHllYXJcbiAgICAgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBodG1sIEEgaHRtbCBzdHJpbmdcbiAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgKiAvLyBkcmF3IGN1c3RvbSBldmVuIGhhbmRsZXJzXG4gICAgICAgICAgICAgKiBjYWxlbmRhci5vbignZHJhdycsIGZ1bmN0aW9uKGRyYXdFdmVudCl7IC4uLiB9KTtcbiAgICAgICAgICAgICAqKi9cbiAgICAgICAgICAgIHRoaXMuZmlyZSgnZHJhdycsIGV2ZW50RGF0YSk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBKZWRnZSB0aGUgaW5wdXQgZGF0ZSBpcyB0b2RheS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHllYXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbW9udGggQSBtb250aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlIEEgZGF0ZVxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2lzVG9kYXk6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlKSB7XG4gICAgICAgIHZhciB0b2RheSA9IGNhbGVuZGFyVXRpbHMuZ2V0RGF0ZUhhc2hUYWJsZSgpO1xuICAgICAgICB2YXIgaXNZZWFyID0geWVhciA/ICh0b2RheS55ZWFyID09PSB5ZWFyKSA6IHRydWU7XG4gICAgICAgIHZhciBpc01vbnRoID0gbW9udGggPyAodG9kYXkubW9udGggPT09IG1vbnRoKSA6IHRydWU7XG4gICAgICAgIHZhciBpc0RhdGUgPSBkYXRlID8gKHRvZGF5LmRhdGUgPT09IGRhdGUpIDogdHJ1ZTtcblxuICAgICAgICByZXR1cm4gaXNZZWFyICYmIGlzTW9udGggJiYgaXNEYXRlO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBNYWtlIG9uZSB3ZWVrIHRlbXBhdGUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgIEEgeWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0V2Vla3M6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHZhciAkZWxXZWVrLFxuICAgICAgICAgICAgd2Vla3MgPSBjYWxlbmRhclV0aWxzLmdldFdlZWtzKHllYXIsIG1vbnRoKSxcbiAgICAgICAgICAgIGk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB3ZWVrczsgaSArPSAxKSB7XG4gICAgICAgICAgICAkZWxXZWVrID0gdGhpcy4kd2Vla1RlbXBsYXRlLmNsb25lKHRydWUpO1xuICAgICAgICAgICAgJGVsV2Vlay5hcHBlbmRUbyh0aGlzLiR3ZWVrQXBwZW5kVGFyZ2V0KTtcbiAgICAgICAgICAgIHRoaXMuX3dlZWtFbGVtZW50cy5wdXNoKCRlbFdlZWspO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNhdmUgZHJhdyBkYXRlcyB0byBhcnJheVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB5ZWFyIEEgZHJhdyB5ZWFyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1vbnRoIEEgZHJhdyBtb250aFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGRhdGVzIEEgZHJhdyBkYXRlXG4gICAgICogQHJldHVybnMge251bWJlcn0gaW5kZXggb2YgbGFzdCBkYXRlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZmlsbERhdGVzOiBmdW5jdGlvbih5ZWFyLCBtb250aCwgZGF0ZXMpIHtcbiAgICAgICAgdmFyIGZpcnN0RGF5ID0gY2FsZW5kYXJVdGlscy5nZXRGaXJzdERheSh5ZWFyLCBtb250aCksXG4gICAgICAgICAgICBsYXN0RGF5ID0gY2FsZW5kYXJVdGlscy5nZXRMYXN0RGF5KHllYXIsIG1vbnRoKSxcbiAgICAgICAgICAgIGxhc3REYXRlID0gY2FsZW5kYXJVdGlscy5nZXRMYXN0RGF0ZSh5ZWFyLCBtb250aCksXG4gICAgICAgICAgICBkYXRlUHJldk1vbnRoID0gY2FsZW5kYXJVdGlscy5nZXRSZWxhdGl2ZURhdGUoMCwgLTEsIDAsIHtcbiAgICAgICAgICAgICAgICB5ZWFyOiB5ZWFyLFxuICAgICAgICAgICAgICAgIG1vbnRoOiBtb250aCxcbiAgICAgICAgICAgICAgICBkYXRlOiAxXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIHByZXZNb250aExhc3REYXRlID0gY2FsZW5kYXJVdGlscy5nZXRMYXN0RGF0ZShkYXRlUHJldk1vbnRoLnllYXIsIGRhdGVQcmV2TW9udGgubW9udGgpLFxuICAgICAgICAgICAgaW5kZXhPZkxhc3REYXRlLFxuICAgICAgICAgICAgaTtcblxuICAgICAgICBpZiAoZmlyc3REYXkgPiAwKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSBwcmV2TW9udGhMYXN0RGF0ZSAtIGZpcnN0RGF5OyBpIDwgcHJldk1vbnRoTGFzdERhdGU7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgIGRhdGVzLnB1c2goaSArIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoaSA9IDE7IGkgPCBsYXN0RGF0ZSArIDE7IGkgKz0gMSkge1xuICAgICAgICAgICAgZGF0ZXMucHVzaChpKTtcbiAgICAgICAgfVxuICAgICAgICBpbmRleE9mTGFzdERhdGUgPSBkYXRlcy5sZW5ndGggLSAxO1xuICAgICAgICBmb3IgKGkgPSAxOyBpIDwgNyAtIGxhc3REYXk7IGkgKz0gMSkge1xuICAgICAgICAgICAgZGF0ZXMucHVzaChpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpbmRleE9mTGFzdERhdGU7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCB3ZWVrZW5kXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRheSBBIGRhdGVcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gJGRhdGVDb250YWluZXIgQSBjb250YWluZXIgZWxlbWVudCBmb3IgZGF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1ByZWZpeCBBIHByZWZpeCBvZiBjbGFzc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldFdlZWtlbmQ6IGZ1bmN0aW9uKGRheSwgJGRhdGVDb250YWluZXIsIGNsYXNzUHJlZml4KSB7XG4gICAgICAgIGlmIChkYXkgPT09IDApIHtcbiAgICAgICAgICAgICRkYXRlQ29udGFpbmVyLmFkZENsYXNzKGNsYXNzUHJlZml4ICsgJ3N1bicpO1xuICAgICAgICB9IGVsc2UgaWYgKGRheSA9PT0gNikge1xuICAgICAgICAgICAgJGRhdGVDb250YWluZXIuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyAnc2F0Jyk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgY2FsZW5kYXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jbGVhcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuX3dlZWtFbGVtZW50cyA9IFtdO1xuICAgICAgICB0aGlzLiR3ZWVrQXBwZW5kVGFyZ2V0LmVtcHR5KCk7XG4gICAgICAgIHRoaXMuZGF0YU9mTW9udGhMYXllci5hcHBlbmRlZFRhcmdldC5lbXB0eSgpO1xuICAgICAgICB0aGlzLmRhdGFPZlllYXJMYXllci5hcHBlbmRlZFRhcmdldC5lbXB0eSgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEcmF3IHRpdGxlIHdpdGggZm9ybWF0IG9wdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHZhbHVlIG9mIHllYXIgKGV4LiAyMDA4KVxuICAgICAqIEBwYXJhbSB7KG51bWJlcnxzdHJpbmcpfSBtb250aCBBIG1vbnRoICgxIH4gMTIpXG4gICAgICogQHByaXZhdGVcbiAgICAgKiovXG4gICAgX3NldENhbGVuZGFyVGl0bGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHZhciBvcHRpb24gPSB0aGlzLl9vcHRpb24sXG4gICAgICAgICAgICB0aXRsZUZvcm1hdCA9IG9wdGlvbi50aXRsZUZvcm1hdCxcbiAgICAgICAgICAgIHJlcGxhY2VNYXAsXG4gICAgICAgICAgICByZWc7XG5cbiAgICAgICAgbW9udGggPSBjYWxlbmRhclV0aWxzLnByZXBlbmRMZWFkaW5nWmVybyhtb250aCk7XG4gICAgICAgIHJlcGxhY2VNYXAgPSB0aGlzLl9nZXRSZXBsYWNlTWFwKHllYXIsIG1vbnRoKTtcblxuICAgICAgICByZWcgPSBDT05TVEFOVFMudGl0bGVSZWdFeHA7XG4gICAgICAgIHRoaXMuX3NldERhdGVUZXh0SW5DYWxlbmRhcih0aGlzLiR0aXRsZSwgdGl0bGVGb3JtYXQsIHJlcGxhY2VNYXAsIHJlZyk7XG5cbiAgICAgICAgcmVnID0gQ09OU1RBTlRTLnRpdGxlWWVhclJlZ0V4cDtcbiAgICAgICAgdGhpcy5fc2V0RGF0ZVRleHRJbkNhbGVuZGFyKHRoaXMuJHRpdGxlWWVhciwgb3B0aW9uLnllYXJUaXRsZUZvcm1hdCwgcmVwbGFjZU1hcCwgcmVnKTtcblxuICAgICAgICByZWcgPSBDT05TVEFOVFMudGl0bGVNb250aFJlZ0V4cDtcbiAgICAgICAgdGhpcy5fc2V0RGF0ZVRleHRJbkNhbGVuZGFyKHRoaXMuJHRpdGxlTW9udGgsIG9wdGlvbi5tb250aFRpdGxlRm9ybWF0LCByZXBsYWNlTWFwLCByZWcpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGl0bGVcbiAgICAgKiBAcGFyYW0ge2pRdWVyeXxIVE1MRWxlbWVudH0gZWxlbWVudCBBIHVwZGF0ZSBlbGVtZW50XG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGZvcm0gQSB1cGRhdGUgZm9ybVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBtYXAgQSBvYmplY3QgdGhhdCBoYXMgdmFsdWUgbWF0Y2hlZCByZWdFeHBcbiAgICAgKiBAcGFyYW0ge1JlZ0V4cH0gcmVnIEEgcmVnRXhwIHRvIGNoYWduZSBmb3JtXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0RGF0ZVRleHRJbkNhbGVuZGFyOiBmdW5jdGlvbihlbGVtZW50LCBmb3JtLCBtYXAsIHJlZykge1xuICAgICAgICB2YXIgdGl0bGUsXG4gICAgICAgICAgICAkZWwgPSAkKGVsZW1lbnQpO1xuXG4gICAgICAgIGlmICghJGVsLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRpdGxlID0gY2FsZW5kYXJVdGlscy5nZXRDb252ZXJ0ZWRUaXRsZShmb3JtLCBtYXAsIHJlZyk7XG4gICAgICAgICRlbC50ZXh0KHRpdGxlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0IG1hcCBkYXRhIGZvciBmb3JtXG4gICAgICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSB5ZWFyIEEgeWVhclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gbW9udGggQSBtb250aFxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gW2RhdGVdIEEgZGF5XG4gICAgICogQHJldHVybnMge09iamVjdH0gUmVwbGFjZU1hcFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2dldFJlcGxhY2VNYXA6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlKSB7XG4gICAgICAgIHZhciBvcHRpb24gPSB0aGlzLl9vcHRpb24sXG4gICAgICAgICAgICB5ZWFyU3ViID0gKHllYXIudG9TdHJpbmcoKSkuc3Vic3RyKDIsIDIpLFxuICAgICAgICAgICAgbW9udGhMYWJlbCA9IG9wdGlvbi5tb250aFRpdGxlc1ttb250aCAtIDFdLFxuICAgICAgICAgICAgbGFiZWxLZXkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRhdGUgfHwgMSkuZ2V0RGF5KCksXG4gICAgICAgICAgICBkYXlMYWJlbCA9IG9wdGlvbi5kYXlUaXRsZXNbbGFiZWxLZXldO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB5eXl5OiB5ZWFyLFxuICAgICAgICAgICAgeXk6IHllYXJTdWIsXG4gICAgICAgICAgICBtbTogbW9udGgsXG4gICAgICAgICAgICBtOiBOdW1iZXIobW9udGgpLFxuICAgICAgICAgICAgTTogbW9udGhMYWJlbCxcbiAgICAgICAgICAgIGRkOiBkYXRlLFxuICAgICAgICAgICAgZDogTnVtYmVyKGRhdGUpLFxuICAgICAgICAgICAgRDogZGF5TGFiZWxcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0IHRvZGF5XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0Q2FsZW5kYXJUb2RheTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciAkdG9kYXkgPSB0aGlzLiR0b2RheSxcbiAgICAgICAgICAgIHRvZGF5Rm9ybWF0LFxuICAgICAgICAgICAgdG9kYXksXG4gICAgICAgICAgICB5ZWFyLFxuICAgICAgICAgICAgbW9udGgsXG4gICAgICAgICAgICBkYXRlLFxuICAgICAgICAgICAgcmVwbGFjZU1hcCxcbiAgICAgICAgICAgIHJlZztcblxuICAgICAgICBpZiAoISR0b2RheS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRvZGF5ID0gY2FsZW5kYXJVdGlscy5nZXREYXRlSGFzaFRhYmxlKCk7XG4gICAgICAgIHllYXIgPSB0b2RheS55ZWFyO1xuICAgICAgICBtb250aCA9IGNhbGVuZGFyVXRpbHMucHJlcGVuZExlYWRpbmdaZXJvKHRvZGF5Lm1vbnRoKTtcbiAgICAgICAgZGF0ZSA9IGNhbGVuZGFyVXRpbHMucHJlcGVuZExlYWRpbmdaZXJvKHRvZGF5LmRhdGUpO1xuICAgICAgICB0b2RheUZvcm1hdCA9IHRoaXMuX29wdGlvbi50b2RheUZvcm1hdDtcbiAgICAgICAgcmVwbGFjZU1hcCA9IHRoaXMuX2dldFJlcGxhY2VNYXAoeWVhciwgbW9udGgsIGRhdGUpO1xuICAgICAgICByZWcgPSBDT05TVEFOVFMudG9kYXlSZWdFeHA7XG4gICAgICAgIHRoaXMuX3NldERhdGVUZXh0SW5DYWxlbmRhcigkdG9kYXksIHRvZGF5Rm9ybWF0LCByZXBsYWNlTWFwLCByZWcpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGl0bGUgb24geWVhcidzIGxheWVyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgLSBZZWFyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0VGl0bGVPblllYXJMYXllcjogZnVuY3Rpb24oeWVhcikge1xuICAgICAgICB2YXIgaXRlbUNvdW50T2ZZZWFyID0gdGhpcy5fZ2V0SW5mb09mWWVhclJhbmdlKHllYXIpO1xuICAgICAgICB2YXIgc3RhcnRZZWFyVGV4dCA9IHRoaXMuX2dldENvbnZlcnRlZFllYXJUaXRsZShpdGVtQ291bnRPZlllYXIuc3RhcnRZZWFyKTtcbiAgICAgICAgdmFyIGVuZFllYXJUZXh0ID0gdGhpcy5fZ2V0Q29udmVydGVkWWVhclRpdGxlKGl0ZW1Db3VudE9mWWVhci5lbmRZZWFyKTtcbiAgICAgICAgdmFyIHRpdGxlID0gc3RhcnRZZWFyVGV4dCArICcgLSAnICsgZW5kWWVhclRleHQ7XG5cbiAgICAgICAgdGhpcy4kdGl0bGUudGV4dCh0aXRsZSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBjbGFzcyBuYW1lIG9uIHRpdGxlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNob3duTGF5ZXJJZHggLSBZZWFyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0Q2xhc3NOYW1lT25UaXRsZTogZnVuY3Rpb24oc2hvd25MYXllcklkeCkge1xuICAgICAgICB2YXIgY2xhc3NOYW1lID0gdGhpcy5fb3B0aW9uLmNsYXNzUHJlZml4ICsgQ09OU1RBTlRTLmNsaWNrYWJsZTtcblxuICAgICAgICBpZiAoIXRoaXMuaXNDbGlja2FibGVUaXRsZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNob3duTGF5ZXJJZHggIT09IDIpIHtcbiAgICAgICAgICAgIHRoaXMuJHRpdGxlLmFkZENsYXNzKGNsYXNzTmFtZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiR0aXRsZS5yZW1vdmVDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBjb252ZXJ0ZWQgeWVhciB0ZXh0IG9uIHllYXIgYW5kIG1vbnRoIGxheWVyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgLSBZZWFyXG4gICAgICogQHJldHVybnMge3N0cmluZ30gQ29udmVydGVkIHllYXIgdGV4dFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2dldENvbnZlcnRlZFllYXJUaXRsZTogZnVuY3Rpb24oeWVhcikge1xuICAgICAgICB2YXIgb3B0aW9uID0gdGhpcy5fb3B0aW9uO1xuICAgICAgICB2YXIgcmVwbGFjZU1hcCwgcmVnO1xuXG4gICAgICAgIHJlcGxhY2VNYXAgPSB0aGlzLl9nZXRSZXBsYWNlTWFwKHllYXIpO1xuICAgICAgICByZWcgPSBDT05TVEFOVFMudGl0bGVZZWFyUmVnRXhwO1xuXG4gICAgICAgIHJldHVybiBjYWxlbmRhclV0aWxzLmdldENvbnZlcnRlZFRpdGxlKG9wdGlvbi55ZWFyVGl0bGVGb3JtYXQsIHJlcGxhY2VNYXAsIHJlZyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB5ZWFycyBpbmZvIGJ5IFwiaXRlbUNvdW50T2ZZZWFyXCIgb3B0aW9uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgLSBZZWFyXG4gICAgICogQHJldHVybnMge09iamVjdH0gSW5mbyBvZiB5ZWFyJ3MgcmFuZ2VcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9nZXRJbmZvT2ZZZWFyUmFuZ2U6IGZ1bmN0aW9uKHllYXIpIHtcbiAgICAgICAgdmFyIGZyYW1lSW5mbyA9IHRoaXMuZGF0YU9mWWVhckxheWVyLmZyYW1lO1xuICAgICAgICB2YXIgY29scyA9IGZyYW1lSW5mby5jb2xzO1xuICAgICAgICB2YXIgcm93cyA9IGZyYW1lSW5mby5yb3dzO1xuICAgICAgICB2YXIgYmFzZUlkeCA9IChjb2xzICogTWF0aC5mbG9vcihyb3dzIC8gMikpICsgTWF0aC5mbG9vcihjb2xzIC8gMik7XG4gICAgICAgIHZhciBzdGFydFllYXIgPSB5ZWFyIC0gYmFzZUlkeDtcbiAgICAgICAgdmFyIGVuZFllYXIgPSBzdGFydFllYXIgKyAoY29scyAqIHJvd3MpIC0gMTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3RhcnRZZWFyOiBzdGFydFllYXIsXG4gICAgICAgICAgICBlbmRZZWFyOiBlbmRZZWFyXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBpbmRleCBvZiBjdXJyZW50IHNob3duIGxheWVyIGJ5IGxheWVyJ3MgdHlwZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gdHlwZSAtIFR5cGUgb2YgbGF5ZXJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBJbmRleCBvZiBzaG93biBsYXllclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2dldEluZGV4T2ZTaG93bkxheWVyOiBmdW5jdGlvbih0eXBlKSB7XG4gICAgICAgIHJldHVybiAodHlwZSA/IHV0aWwuaW5BcnJheSh0eXBlLCBDT05TVEFOVFMubGF5ZXJLZXlzKSA6IHRoaXMuc2hvd25MYXllcklkeCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERyYXcgaGVhZGVyIGVsZW1lbnRcbiAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyAtIFRoZSBoYXNoIHRoYXQgc2hvdyB1cCBvbiBjYWxlbmRhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzaG93bkxheWVySWR4IC0gSW5kZXggb2Ygc2hvd24gbGF5ZXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kcmF3SGVhZGVyOiBmdW5jdGlvbihkYXRlRm9yRHJhd2luZywgc2hvd25MYXllcklkeCkge1xuICAgICAgICB2YXIgY2xhc3NTZWxlY3RvciA9ICcuJyArIHRoaXMuX29wdGlvbi5jbGFzc1ByZWZpeCArICdidG4tJztcbiAgICAgICAgdmFyIHByZXZCdG4gPSB0aGlzLiRoZWFkZXIuZmluZChjbGFzc1NlbGVjdG9yICsgQ09OU1RBTlRTLnByZXYpO1xuICAgICAgICB2YXIgbmV4dEJ0biA9IHRoaXMuJGhlYWRlci5maW5kKGNsYXNzU2VsZWN0b3IgKyBDT05TVEFOVFMubmV4dCk7XG4gICAgICAgIHZhciBrZXkgPSBDT05TVEFOVFMucmVsYXRpdmVNb250aFZhbHVlS2V5O1xuICAgICAgICB2YXIgaXRlbUNvdW50T2ZZZWFyID0gdGhpcy5fb3B0aW9uLml0ZW1Db3VudE9mWWVhcjtcbiAgICAgICAgdmFyIHByZXZWYWx1ZSwgbmV4dFZhbHVlO1xuXG4gICAgICAgIHRoaXMuX3NldENsYXNzTmFtZU9uVGl0bGUoc2hvd25MYXllcklkeCk7XG5cbiAgICAgICAgc3dpdGNoIChzaG93bkxheWVySWR4KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0Q2FsZW5kYXJUZXh0KGRhdGVGb3JEcmF3aW5nKTtcbiAgICAgICAgICAgICAgICBwcmV2VmFsdWUgPSAtMTtcbiAgICAgICAgICAgICAgICBuZXh0VmFsdWUgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHRoaXMuJHRpdGxlLnRleHQodGhpcy5fZ2V0Q29udmVydGVkWWVhclRpdGxlKGRhdGVGb3JEcmF3aW5nLnllYXIpKTtcbiAgICAgICAgICAgICAgICBwcmV2VmFsdWUgPSAtMTI7XG4gICAgICAgICAgICAgICAgbmV4dFZhbHVlID0gMTI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgdGhpcy5fc2V0VGl0bGVPblllYXJMYXllcihkYXRlRm9yRHJhd2luZy55ZWFyKTtcbiAgICAgICAgICAgICAgICBwcmV2VmFsdWUgPSAtMTIgKiBpdGVtQ291bnRPZlllYXI7XG4gICAgICAgICAgICAgICAgbmV4dFZhbHVlID0gMTIgKiBpdGVtQ291bnRPZlllYXI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OiAvLyBAdG9kbyBXaHkgZG9lcyBub3QgdXNlICdyZXR1cm4nIGJ1dCAnYnJlYWsnP1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJldkJ0bi5kYXRhKGtleSwgcHJldlZhbHVlKTtcbiAgICAgICAgbmV4dEJ0bi5kYXRhKGtleSwgbmV4dFZhbHVlKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRHJhdyBib2R5IGVsZW1lbnRzXG4gICAgICogQHBhcmFtIHt7eWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyfX0gZGF0ZUZvckRyYXdpbmcgLSBUaGUgaGFzaCB0aGF0IHNob3cgdXAgb24gY2FsZW5kYXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2hvd25MYXllcklkeCAtIEluZGV4IG9mIHNob3duIGxheWVyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZHJhd0JvZHk6IGZ1bmN0aW9uKGRhdGVGb3JEcmF3aW5nLCBzaG93bkxheWVySWR4KSB7XG4gICAgICAgIHZhciB5ZWFyID0gZGF0ZUZvckRyYXdpbmcueWVhcjtcbiAgICAgICAgdmFyIG1vbnRoID0gZGF0ZUZvckRyYXdpbmcubW9udGg7XG4gICAgICAgIHZhciBjbGFzc1ByZWZpeCA9IHRoaXMuX29wdGlvbi5jbGFzc1ByZWZpeDtcblxuICAgICAgICAvLyB3ZWVrc1xuICAgICAgICB0aGlzLl9zZXRXZWVrcyh5ZWFyLCBtb250aCk7XG4gICAgICAgIHRoaXMuXyRkYXRlRWxlbWVudCA9ICQoJy4nICsgY2xhc3NQcmVmaXggKyAnZGF0ZScsIHRoaXMuJHdlZWtBcHBlbmRUYXJnZXQpO1xuICAgICAgICB0aGlzLl8kZGF0ZUNvbnRhaW5lckVsZW1lbnQgPSAkKCcuJyArIGNsYXNzUHJlZml4ICsgJ3dlZWsgPiAqJywgdGhpcy4kd2Vla0FwcGVuZFRhcmdldCk7XG5cbiAgICAgICAgLy8gZGF0ZXNcbiAgICAgICAgdGhpcy5fZHJhd0RhdGVzKGRhdGVGb3JEcmF3aW5nLCBjbGFzc1ByZWZpeCk7XG5cbiAgICAgICAgLy8gbW9udGggbGF5ZXJcbiAgICAgICAgdGhpcy5fZHJhd0ZyYW1lT25Nb250aExheWVyKCk7XG4gICAgICAgIHRoaXMuX2RyYXdCdXR0b25zT2ZNb250aChkYXRlRm9yRHJhd2luZywgY2xhc3NQcmVmaXgpO1xuXG4gICAgICAgIC8vIHllYXIgbGF5ZXJcbiAgICAgICAgdGhpcy5fZHJhd0ZyYW1lT25ZZWFyTGF5ZXIoKTtcbiAgICAgICAgdGhpcy5fZHJhd0J1dHRvbnNPZlllYXIoZGF0ZUZvckRyYXdpbmcsIGNsYXNzUHJlZml4KTtcblxuICAgICAgICAvLyBzaG93IGxheWVyXG4gICAgICAgIHRoaXMuX2NoYW5nZVNob3duTGF5ZXIoc2hvd25MYXllcklkeCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERyYXcgZnJhbWUgY29udGFpbmluZyBidXR0b25zIG9uIG1vbnRoJ3MgbGF5ZXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kcmF3RnJhbWVPbk1vbnRoTGF5ZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIHZhciByb3dzID0gdGhpcy5kYXRhT2ZNb250aExheWVyLmZyYW1lLnJvd3M7XG4gICAgICAgIHZhciBkYXRhT2ZNb250aExheWVyID0gdGhpcy5kYXRhT2ZNb250aExheWVyO1xuICAgICAgICB2YXIgJG1vbnRoR3JvdXBFbDtcblxuICAgICAgICBmb3IgKDsgaSA8IHJvd3M7IGkgKz0gMSkge1xuICAgICAgICAgICAgJG1vbnRoR3JvdXBFbCA9IGRhdGFPZk1vbnRoTGF5ZXIudGVtcGxhdGUuY2xvbmUodHJ1ZSk7XG4gICAgICAgICAgICAkbW9udGhHcm91cEVsLmFwcGVuZFRvKGRhdGFPZk1vbnRoTGF5ZXIuYXBwZW5kZWRUYXJnZXQpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERyYXcgc2VsZWN0YWJsZSBidXR0b25zIG9uIG1vbnRoJ3MgbGF5ZXJcbiAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyAtIFRoZSBoYXNoIHRoYXQgc2hvdyB1cCBvbiBjYWxlbmRhclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1ByZWZpeCAtIEEgY2xhc3MgcHJlZml4XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZHJhd0J1dHRvbnNPZk1vbnRoOiBmdW5jdGlvbihkYXRlRm9yRHJhd2luZywgY2xhc3NQcmVmaXgpIHtcbiAgICAgICAgdmFyIGtleSA9IENPTlNUQU5UUy5yZWxhdGl2ZU1vbnRoVmFsdWVLZXk7XG4gICAgICAgIHZhciBzZWxlY3RlZE1vbnRoID0gZGF0ZUZvckRyYXdpbmcubW9udGg7XG4gICAgICAgIHZhciBtb250aFRpdGxlcyA9IHRoaXMuX29wdGlvbi5tb250aFRpdGxlcztcbiAgICAgICAgdmFyICRtb250aEVscyA9IHRoaXMuZGF0YU9mTW9udGhMYXllci5hcHBlbmRlZFRhcmdldC5maW5kKCcuJyArIGNsYXNzUHJlZml4ICsgJ21vbnRoJyk7XG4gICAgICAgIHZhciAkYnV0dG9uRWwsIG1vbnRoLCByZWxhdGl2ZU1vbnRoO1xuICAgICAgICB2YXIgZXZlbnREYXRhO1xuXG4gICAgICAgIHV0aWwuZm9yRWFjaChtb250aFRpdGxlcywgZnVuY3Rpb24odGl0bGUsIGlkeCkge1xuICAgICAgICAgICAgJGJ1dHRvbkVsID0gJG1vbnRoRWxzLmVxKGlkeCk7XG4gICAgICAgICAgICBtb250aCA9IGlkeCArIDE7XG5cbiAgICAgICAgICAgIGlmIChtb250aCA9PT0gc2VsZWN0ZWRNb250aCkge1xuICAgICAgICAgICAgICAgICRidXR0b25FbC5hZGRDbGFzcyhjbGFzc1ByZWZpeCArIENPTlNUQU5UUy5zZWxlY3RlZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1RvZGF5KHRoaXMuX3Nob3duRGF0ZS55ZWFyLCBtb250aCkpIHtcbiAgICAgICAgICAgICAgICAkYnV0dG9uRWwuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyBDT05TVEFOVFMudG9kYXkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZWxhdGl2ZU1vbnRoID0gbW9udGggLSBzZWxlY3RlZE1vbnRoO1xuXG4gICAgICAgICAgICAkYnV0dG9uRWwuZGF0YShrZXksIHJlbGF0aXZlTW9udGgpLmh0bWwodGl0bGUpO1xuXG4gICAgICAgICAgICBldmVudERhdGEgPSB7XG4gICAgICAgICAgICAgICAgJGRhdGU6ICRidXR0b25FbCxcbiAgICAgICAgICAgICAgICAkZGF0ZUNvbnRhaW5lcjogJGJ1dHRvbkVsLFxuICAgICAgICAgICAgICAgIHllYXI6IGRhdGVGb3JEcmF3aW5nLnllYXIsXG4gICAgICAgICAgICAgICAgbW9udGg6IG1vbnRoLFxuICAgICAgICAgICAgICAgIGRhdGU6IDAsXG4gICAgICAgICAgICAgICAgaHRtbDogdGl0bGVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuZmlyZSgnZHJhdycsIGV2ZW50RGF0YSk7XG4gICAgICAgIH0sIHRoaXMpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEcmF3IGZyYW1lIGNvbnRhaW5pbmcgYnV0dG9ucyBvbiB5ZWFyJ3MgbGF5ZXJcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kcmF3RnJhbWVPblllYXJMYXllcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpID0gMDtcbiAgICAgICAgdmFyIHJvd3MgPSB0aGlzLmRhdGFPZk1vbnRoTGF5ZXIuZnJhbWUucm93cztcbiAgICAgICAgdmFyIGRhdGFPZlllYXJMYXllciA9IHRoaXMuZGF0YU9mWWVhckxheWVyO1xuICAgICAgICB2YXIgJHllYXJHcm91cEVsO1xuXG4gICAgICAgIGZvciAoOyBpIDwgcm93czsgaSArPSAxKSB7XG4gICAgICAgICAgICAkeWVhckdyb3VwRWwgPSBkYXRhT2ZZZWFyTGF5ZXIudGVtcGxhdGUuY2xvbmUodHJ1ZSk7XG4gICAgICAgICAgICAkeWVhckdyb3VwRWwuYXBwZW5kVG8oZGF0YU9mWWVhckxheWVyLmFwcGVuZGVkVGFyZ2V0KTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEcmF3IHNlbGVjdGFibGUgYnV0dG9ucyBvbiB5ZWFyJ3MgbGF5ZXJcbiAgICAgKiBAcGFyYW0ge3t5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXJ9fSBkYXRlRm9yRHJhd2luZyAtIFRoZSBoYXNoIHRoYXQgc2hvdyB1cCBvbiBjYWxlbmRhclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjbGFzc1ByZWZpeCAtIEEgY2xhc3MgcHJlZml4XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZHJhd0J1dHRvbnNPZlllYXI6IGZ1bmN0aW9uKGRhdGVGb3JEcmF3aW5nLCBjbGFzc1ByZWZpeCkge1xuICAgICAgICB2YXIga2V5ID0gQ09OU1RBTlRTLnJlbGF0aXZlTW9udGhWYWx1ZUtleTtcbiAgICAgICAgdmFyIHllYXIgPSBkYXRlRm9yRHJhd2luZy55ZWFyO1xuICAgICAgICB2YXIgaXRlbUNvdW50T2ZZZWFyID0gdGhpcy5fZ2V0SW5mb09mWWVhclJhbmdlKHllYXIpO1xuICAgICAgICB2YXIgc3RhcnRZZWFyID0gaXRlbUNvdW50T2ZZZWFyLnN0YXJ0WWVhcjtcbiAgICAgICAgdmFyIGVuZFllYXIgPSBpdGVtQ291bnRPZlllYXIuZW5kWWVhcjtcbiAgICAgICAgdmFyIGNudCA9IDA7XG4gICAgICAgIHZhciAkeWVhckVscyA9IHRoaXMuZGF0YU9mWWVhckxheWVyLmFwcGVuZGVkVGFyZ2V0LmZpbmQoJy4nICsgY2xhc3NQcmVmaXggKyAneWVhcicpO1xuICAgICAgICB2YXIgJGJ1dHRvbkVsLCByZWxhdGl2ZU1vbnRoO1xuICAgICAgICB2YXIgZXZlbnREYXRhO1xuXG4gICAgICAgIGZvciAoOyBzdGFydFllYXIgPD0gZW5kWWVhcjsgc3RhcnRZZWFyICs9IDEpIHtcbiAgICAgICAgICAgICRidXR0b25FbCA9ICR5ZWFyRWxzLmVxKGNudCk7XG5cbiAgICAgICAgICAgIGlmIChzdGFydFllYXIgPT09IHllYXIpIHtcbiAgICAgICAgICAgICAgICAkYnV0dG9uRWwuYWRkQ2xhc3MoY2xhc3NQcmVmaXggKyBDT05TVEFOVFMuc2VsZWN0ZWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5faXNUb2RheShzdGFydFllYXIpKSB7XG4gICAgICAgICAgICAgICAgJGJ1dHRvbkVsLmFkZENsYXNzKGNsYXNzUHJlZml4ICsgQ09OU1RBTlRTLnRvZGF5KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVsYXRpdmVNb250aCA9IChzdGFydFllYXIgLSB5ZWFyKSAqIDEyO1xuXG4gICAgICAgICAgICAkYnV0dG9uRWwuZGF0YShrZXksIHJlbGF0aXZlTW9udGgpLmh0bWwoc3RhcnRZZWFyKTtcblxuICAgICAgICAgICAgY250ICs9IDE7XG5cbiAgICAgICAgICAgIGV2ZW50RGF0YSA9IHtcbiAgICAgICAgICAgICAgICAkZGF0ZTogJGJ1dHRvbkVsLFxuICAgICAgICAgICAgICAgICRkYXRlQ29udGFpbmVyOiAkYnV0dG9uRWwsXG4gICAgICAgICAgICAgICAgeWVhcjogc3RhcnRZZWFyLFxuICAgICAgICAgICAgICAgIG1vbnRoOiAwLFxuICAgICAgICAgICAgICAgIGRhdGU6IDAsXG4gICAgICAgICAgICAgICAgaHRtbDogc3RhcnRZZWFyXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmZpcmUoJ2RyYXcnLCBldmVudERhdGEpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIENoYW5nZSBjdXJyZW50IHNob3duIGxheWVyIG9uIGNhbGVuZGFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNob3duTGF5ZXJJZHggLSBJbmRleCBvZiBzaG93biBsYXllclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2NoYW5nZVNob3duTGF5ZXI6IGZ1bmN0aW9uKHNob3duTGF5ZXJJZHgpIHtcbiAgICAgICAgdmFyIGNsYXNzUHJlZml4ID0gdGhpcy5fb3B0aW9uLmNsYXNzUHJlZml4O1xuICAgICAgICB2YXIgcHJldnNob3duTGF5ZXJJZHggPSB0aGlzLnNob3duTGF5ZXJJZHg7XG4gICAgICAgIHZhciAkYm9keXMgPSB0aGlzLiRlbGVtZW50LmZpbmQoJy4nICsgY2xhc3NQcmVmaXggKyAnYm9keScpO1xuXG4gICAgICAgIHRoaXMuc2hvd25MYXllcklkeCA9IHNob3duTGF5ZXJJZHg7XG5cbiAgICAgICAgJGJvZHlzLmVxKHByZXZzaG93bkxheWVySWR4KS5oaWRlKCk7XG4gICAgICAgICRib2R5cy5lcShzaG93bkxheWVySWR4KS5zaG93KCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIERyYXcgY2FsZW5kYXJcbiAgICAgKiBAYXBpXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt5ZWFyXSBBIHllYXIgKGV4LiAyMDA4KVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbbW9udGhdIEEgbW9udGggKDEgfiAxMilcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtpc1JlbGF0aXZlXSBBIHllYXIgYW5kIG1vbnRoIGlzIHJlbGF0ZWRcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3Nob3duVHlwZV0gU2hvd24gdHlwZSBvZiBsYXllciAoZXguIFtkYXksIG1vbnRoLCB5ZWFyXSB8IFswXSB+IDJdKVxuICAgICAqIEBleGFtcGxlXG4gICAgICogY2FsZW5kYXIuZHJhdygpOyAvLyBEcmF3IHdpdGggbm93IGRhdGUuXG4gICAgICogY2FsZW5kYXIuZHJhdygyMDA4LCAxMik7IC8vIERyYXcgMjAwOC8xMlxuICAgICAqIGNhbGVuZGFyLmRyYXcobnVsbCwgMTIpOyAvLyBEcmF3IGN1cnJlbnQgeWVhci8xMlxuICAgICAqIGNhbGVuZGFyLmRyYXcoMjAxMCwgbnVsbCk7IC8vIERyYXcgMjAxMC9jdXJyZW50IG1vbnRoXG4gICAgICogY2FsZW5kYXIuZHJhdygwLCAxLCB0cnVlKTsgLy8gRHJhdyBuZXh0IG1vbnRoXG4gICAgICogY2FsZW5kYXIuZHJhdygtMSwgbnVsbCwgdHJ1ZSk7IC8vIERyYXcgcHJldiB5ZWFyXG4gICAgICogY2FsZW5kYXIuZHJhdygwLCAwLCBmYWxzZSwgJ2RhdGUnKTsgLy8gRHJhdyB0b2RheSB3aXRoIGRhdGUncyBsYXllclxuICAgICAqIGNhbGVuZGFyLmRyYXcoMjAxMCwgMTAsIGZhbHNlLCAnbW9udGgnKTsgLy8gRHJhdyAyMDEwLzEwIHdpdGggbW9udGgncyBsYXllclxuICAgICAqIGNhbGVuZGFyLmRyYXcoMjAxNiwgbnVsbCwgZmFsc2UsICd5ZWFyJyk7IC8vIERyYXcgMjAxNi9tb250aCB3aXRoIHllYXIncyBsYXllclxuICAgICAqKi9cbiAgICBkcmF3OiBmdW5jdGlvbih5ZWFyLCBtb250aCwgaXNSZWxhdGl2ZSwgc2hvd25UeXBlKSB7XG4gICAgICAgIHZhciBkYXRlRm9yRHJhd2luZyA9IHRoaXMuX2dldERhdGVGb3JEcmF3aW5nKHllYXIsIG1vbnRoLCBpc1JlbGF0aXZlKTtcbiAgICAgICAgdmFyIGlzUmVhZHlGb3JEcmF3aW5nID0gdGhpcy5pbnZva2UoJ2JlZm9yZURyYXcnLCBkYXRlRm9yRHJhd2luZyk7XG4gICAgICAgIHZhciBzaG93bkxheWVySWR4O1xuXG4gICAgICAgIC8qID09PT09PT09PT09PT09PVxuICAgICAgICAgKiBiZWZvcmVEcmF3XG4gICAgICAgICAqID09PT09PT09PT09PT09PT09Ki9cbiAgICAgICAgaWYgKCFpc1JlYWR5Rm9yRHJhd2luZykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogPT09PT09PT09PT09PT09XG4gICAgICAgICAqIGRyYXdcbiAgICAgICAgICogPT09PT09PT09PT09PT09PT0qL1xuICAgICAgICBzaG93bkxheWVySWR4ID0gdXRpbC5pc051bWJlcihzaG93blR5cGUpID8gc2hvd25UeXBlIDogdGhpcy5fZ2V0SW5kZXhPZlNob3duTGF5ZXIoc2hvd25UeXBlKTtcblxuICAgICAgICB5ZWFyID0gZGF0ZUZvckRyYXdpbmcueWVhcjtcbiAgICAgICAgbW9udGggPSBkYXRlRm9yRHJhd2luZy5tb250aDtcblxuICAgICAgICB0aGlzLnNldERhdGUoeWVhciwgbW9udGgpO1xuXG4gICAgICAgIHRoaXMuX2NsZWFyKCk7XG4gICAgICAgIHRoaXMuX2RyYXdIZWFkZXIoZGF0ZUZvckRyYXdpbmcsIHNob3duTGF5ZXJJZHgpO1xuICAgICAgICB0aGlzLl9kcmF3Qm9keShkYXRlRm9yRHJhd2luZywgc2hvd25MYXllcklkeCk7XG5cbiAgICAgICAgLyogPT09PT09PT09PT09PT09XG4gICAgICAgICAqIGFmdGVyRHJhd1xuICAgICAgICAgKiA9PT09PT09PT09PT09PT09Ki9cbiAgICAgICAgdGhpcy5maXJlKCdhZnRlckRyYXcnLCBkYXRlRm9yRHJhd2luZyk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybiBjdXJyZW50IHllYXIgYW5kIG1vbnRoKGp1c3Qgc2hvd24pLlxuICAgICAqIEBhcGlcbiAgICAgKiBAcmV0dXJucyB7e3llYXI6IG51bWJlciwgbW9udGg6IG51bWJlcn19XG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgZ2V0RGF0ZSgpOyA9PiB7IHllYXI6IHh4eHgsIG1vbnRoOiB4eCB9O1xuICAgICAqL1xuICAgIGdldERhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeWVhcjogdGhpcy5fc2hvd25EYXRlLnllYXIsXG4gICAgICAgICAgICBtb250aDogdGhpcy5fc2hvd25EYXRlLm1vbnRoXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldCBkYXRlXG4gICAgICogQGFwaVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbeWVhcl0gQSB5ZWFyIChleC4gMjAwOClcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW21vbnRoXSBBIG1vbnRoICgxIH4gMTIpXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgc2V0RGF0ZSgxOTg0LCAwNCk7XG4gICAgICoqL1xuICAgIHNldERhdGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHZhciBkYXRlID0gdGhpcy5fc2hvd25EYXRlO1xuICAgICAgICBkYXRlLnllYXIgPSB1dGlsLmlzTnVtYmVyKHllYXIpID8geWVhciA6IGRhdGUueWVhcjtcbiAgICAgICAgZGF0ZS5tb250aCA9IHV0aWwuaXNOdW1iZXIobW9udGgpID8gbW9udGggOiBkYXRlLm1vbnRoO1xuICAgIH1cbn0pO1xuXG51dGlsLkN1c3RvbUV2ZW50cy5taXhpbihDYWxlbmRhcik7XG5tb2R1bGUuZXhwb3J0cyA9IENhbGVuZGFyO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY2FsZW5kYXIuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgQ09OU1RBTlRTID0ge1xuICAgIHJlbGF0aXZlTW9udGhWYWx1ZUtleTogJ3JlbGF0aXZlTW9udGhWYWx1ZScsXG4gICAgcHJldjogJ3ByZXYnLFxuICAgIHByZXZZZWFyOiAncHJldi15ZWFyJyxcbiAgICBwcmV2TW9udGg6ICdwcmV2LW1vbnRoJyxcbiAgICBuZXh0OiAnbmV4dCcsXG4gICAgbmV4dFllYXI6ICduZXh0LXllYXInLFxuICAgIG5leHRNb250aDogJ25leHQtbW9udGgnLFxuICAgIHNlbGVjdGVkOiAnc2VsZWN0ZWQnLFxuICAgIHRvZGF5OiAndG9kYXknLFxuICAgIGNsaWNrYWJsZTogJ2NsaWNrYWJsZS10aXRsZScsXG4gICAgY2FsZW5kYXJIZWFkZXI6IG51bGwsXG4gICAgY2FsZW5kYXJCb2R5OiBudWxsLFxuICAgIGNhbGVuZGFyRm9vdGVyOiBudWxsLFxuICAgIGRlZmF1bHRDbGFzc1ByZWZpeFJlZ0V4cDogL2NhbGVuZGFyLS9nLFxuICAgIHRpdGxlUmVnRXhwOiAveXl5eXx5eXxtbXxtfE0vZyxcbiAgICB0aXRsZVllYXJSZWdFeHA6IC95eXl5fHl5L2csXG4gICAgdGl0bGVNb250aFJlZ0V4cDogL21tfG18TS9nLFxuICAgIHRvZGF5UmVnRXhwOiAveXl5eXx5eXxtbXxtfE18ZGR8ZHxEL2csXG4gICAgaXRlbUNvdW50T2ZZZWFyOiAxMixcbiAgICBsYXllcktleXM6IFsnZGF0ZScsICdtb250aCcsICd5ZWFyJ11cbn07XG5cbi8qIGVzbGludC1kaXNhYmxlICovXG5DT05TVEFOVFMuY2FsZW5kYXJIZWFkZXIgPSBbXG4gICAgJzxkaXYgY2xhc3M9XCJjYWxlbmRhci1oZWFkZXJcIj4nLFxuICAgICAgICAnPGEgaHJlZj1cIiNcIiBjbGFzcz1cImNhbGVuZGFyLXJvbGxvdmVyIGNhbGVuZGFyLWJ0bi0nICsgQ09OU1RBTlRTLnByZXYgKyAnXCI+UHJldjwvYT4nLFxuICAgICAgICAnPHN0cm9uZyBjbGFzcz1cImNhbGVuZGFyLXRpdGxlIGNhbGVuZGFyLWNsaWNrYWJsZS10aXRsZVwiPjwvc3Ryb25nPicsXG4gICAgICAgICc8YSBocmVmPVwiI1wiIGNsYXNzPVwiY2FsZW5kYXItcm9sbG92ZXIgY2FsZW5kYXItYnRuLScgKyBDT05TVEFOVFMubmV4dCArICdcIj5OZXh0PC9hPicsXG4gICAgJzwvZGl2PiddLmpvaW4oJycpO1xuXG5DT05TVEFOVFMuY2FsZW5kYXJCb2R5ID0gW1xuICAgICc8ZGl2IGNsYXNzPVwiY2FsZW5kYXItYm9keVwiPicsXG4gICAgICAgICc8dGFibGU+JyxcbiAgICAgICAgICAgICc8dGhlYWQ+JyxcbiAgICAgICAgICAgICAgICAnPHRyPicsXG4gICAgICAgICAgICAgICAgICAgJzx0aCBjbGFzcz1cImNhbGVuZGFyLXN1blwiPlN1PC90aD48dGg+TW88L3RoPjx0aD5UdTwvdGg+PHRoPldlPC90aD48dGg+VGg8L3RoPjx0aD5GYTwvdGg+PHRoIGNsYXNzPVwiY2FsZW5kYXItc2F0XCI+U2E8L3RoPicsXG4gICAgICAgICAgICAgICAgJzwvdHI+JyxcbiAgICAgICAgICAgICc8L3RoZWFkPicsXG4gICAgICAgICAgICAnPHRib2R5PicsXG4gICAgICAgICAgICAgICAgJzx0ciBjbGFzcz1cImNhbGVuZGFyLXdlZWtcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXItZGF0ZVwiPjwvdGQ+JyxcbiAgICAgICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImNhbGVuZGFyLWRhdGVcIj48L3RkPicsXG4gICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXItZGF0ZVwiPjwvdGQ+JyxcbiAgICAgICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImNhbGVuZGFyLWRhdGVcIj48L3RkPicsXG4gICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1kYXRlXCI+PC90ZD4nLFxuICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXItZGF0ZVwiPjwvdGQ+JyxcbiAgICAgICAgICAgICAgICAnPC90cj4nLFxuICAgICAgICAgICAgJzwvdGJvZHk+JyxcbiAgICAgICAgJzwvdGFibGU+JyxcbiAgICAnPC9kaXY+JyxcbiAgICAnPGRpdiBjbGFzcz1cImNhbGVuZGFyLWJvZHlcIj4nLFxuICAgICAgICAnPHRhYmxlPicsXG4gICAgICAgICAgICAnPHRib2R5PicsXG4gICAgICAgICAgICAgICAgJzx0ciBjbGFzcz1cImNhbGVuZGFyLW1vbnRoLWdyb3VwXCI+JyxcbiAgICAgICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImNhbGVuZGFyLW1vbnRoXCI+PC90ZD4nLFxuICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXItbW9udGhcIj48L3RkPicsXG4gICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci1tb250aFwiPjwvdGQ+JyxcbiAgICAgICAgICAgICAgICAnPC90cj4nLFxuICAgICAgICAgICAgJzwvdGJvZHk+JyxcbiAgICAgICAgJzwvdGFibGU+JyxcbiAgICAnPC9kaXY+JyxcbiAgICAnPGRpdiBjbGFzcz1cImNhbGVuZGFyLWJvZHlcIj4nLFxuICAgICAgICAnPHRhYmxlPicsXG4gICAgICAgICAgICAnPHRib2R5PicsXG4gICAgICAgICAgICAgICAgJzx0ciBjbGFzcz1cImNhbGVuZGFyLXllYXItZ3JvdXBcIj4nLFxuICAgICAgICAgICAgICAgICAgICAnPHRkIGNsYXNzPVwiY2FsZW5kYXIteWVhclwiPjwvdGQ+JyxcbiAgICAgICAgICAgICAgICAgICAgJzx0ZCBjbGFzcz1cImNhbGVuZGFyLXllYXJcIj48L3RkPicsXG4gICAgICAgICAgICAgICAgICAgICc8dGQgY2xhc3M9XCJjYWxlbmRhci15ZWFyXCI+PC90ZD4nLFxuICAgICAgICAgICAgICAgICc8L3RyPicsXG4gICAgICAgICAgICAnPC90Ym9keT4nLFxuICAgICAgICAnPC90YWJsZT4nLFxuICAgICc8L2Rpdj4nXS5qb2luKCcnKTtcblxuQ09OU1RBTlRTLmNhbGVuZGFyRm9vdGVyID0gW1xuICAgICc8ZGl2IGNsYXNzPVwiY2FsZW5kYXItZm9vdGVyXCI+JyxcbiAgICAgICAgJzxwPuyYpOuKmCA8ZW0gY2xhc3M9XCJjYWxlbmRhci10b2RheVwiPjwvZW0+PC9wPicsXG4gICAgJzwvZGl2PiddLmpvaW4oJycpO1xuLyogZXNsaW50LWVuYWJsZSAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IENPTlNUQU5UUztcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2NvbnN0YW50cy5qc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIEBmaWxlb3ZlcnZpZXcgVXRpbHMgZm9yIGNhbGVuZGFyIGNvbXBvbmVudFxuICogQGF1dGhvciBOSE4gTmV0LiBGRSBkZXYgTGFiIDxkbF9qYXZhc2NyaXB0QG5obmVudC5jb20+XG4gKiBAZGVwZW5kZW5jeSB0dWktY29kZS1zbmlwcGV0IH4xLjAuMlxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBVdGlscyBvZiBjYWxlbmRhclxuICogQG5hbWVzcGFjZSBjYWxlbmRhclV0aWxzXG4gKiBAaWdub3JlXG4gKi9cbnZhciB1dGlscyA9IHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gZGF0ZSBoYXNoIGJ5IHBhcmFtZXRlci5cbiAgICAgKiAgaWYgdGhlcmUgYXJlIDMgcGFyYW1ldGVyLCB0aGUgcGFyYW1ldGVyIGlzIGNvcmduaXplZCBEYXRlIG9iamVjdFxuICAgICAqICBpZiB0aGVyZSBhcmUgbm8gcGFyYW1ldGVyLCByZXR1cm4gdG9kYXkncyBoYXNoIGRhdGVcbiAgICAgKiBAZnVuY3Rpb24gZ2V0RGF0ZUhhc2hUYWJsZVxuICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG4gICAgICogQHBhcmFtIHtEYXRlfG51bWJlcn0gW3llYXJdIEEgZGF0ZSBpbnN0YW5jZSBvciB5ZWFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFttb250aF0gQSBtb250aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbZGF0ZV0gQSBkYXRlXG4gICAgICogQHJldHVybnMge3t5ZWFyOiAqLCBtb250aDogKiwgZGF0ZTogKn19XG4gICAgICovXG4gICAgZ2V0RGF0ZUhhc2hUYWJsZTogZnVuY3Rpb24oeWVhciwgbW9udGgsIGRhdGUpIHtcbiAgICAgICAgdmFyIG5EYXRlO1xuXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMykge1xuICAgICAgICAgICAgbkRhdGUgPSBhcmd1bWVudHNbMF0gfHwgbmV3IERhdGUoKTtcblxuICAgICAgICAgICAgeWVhciA9IG5EYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICBtb250aCA9IG5EYXRlLmdldE1vbnRoKCkgKyAxO1xuICAgICAgICAgICAgZGF0ZSA9IG5EYXRlLmdldERhdGUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB5ZWFyOiB5ZWFyLFxuICAgICAgICAgICAgbW9udGg6IG1vbnRoLFxuICAgICAgICAgICAgZGF0ZTogZGF0ZVxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdG9kYXkgdGhhdCBzYXZlZCBvbiBjb21wb25lbnQgb3IgY3JlYXRlIG5ldyBkYXRlLlxuICAgICAqIEBmdW5jdGlvbiBnZXRUb2RheVxuICAgICAqIEByZXR1cm5zIHt7eWVhcjogKiwgbW9udGg6ICosIGRhdGU6ICp9fVxuICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG4gICAgICovXG4gICAgZ2V0VG9kYXk6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdXRpbHMuZ2V0RGF0ZUhhc2hUYWJsZSgpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgd2Vla3MgY291bnQgYnkgcGFyYW1lbnRlclxuICAgICAqIEBmdW5jdGlvbiBnZXRXZWVrc1xuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB5ZWFyIEEgeWVhclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIG1vbnRoXG4gICAgICogQHJldHVybnMge251bWJlcn0g7KO8ICg0fjYpXG4gICAgICogQG1lbWJlcm9mIGNhbGVuZGFyVXRpbHNcbiAgICAgKiovXG4gICAgZ2V0V2Vla3M6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHZhciBmaXJzdERheSA9IHRoaXMuZ2V0Rmlyc3REYXkoeWVhciwgbW9udGgpLFxuICAgICAgICAgICAgbGFzdERhdGUgPSB0aGlzLmdldExhc3REYXRlKHllYXIsIG1vbnRoKTtcblxuICAgICAgICByZXR1cm4gTWF0aC5jZWlsKChmaXJzdERheSArIGxhc3REYXRlKSAvIDcpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdW5peCB0aW1lIGZyb20gZGF0ZSBoYXNoXG4gICAgICogQGZ1bmN0aW9uIGdldFRpbWVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0ZSBBIGRhdGUgaGFzaFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlLnllYXIgQSB5ZWFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUubW9udGggQSBtb250aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkYXRlLmRhdGUgQSBkYXRlXG4gICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAgKiBAbWVtYmVyb2YgdXRpbHNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHV0aWxzLmdldFRpbWUoe3llYXI6MjAxMCwgbW9udGg6NSwgZGF0ZToxMn0pOyAvLyAxMjczNTkwMDAwMDAwXG4gICAgICoqL1xuICAgIGdldFRpbWU6IGZ1bmN0aW9uKGRhdGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGF0ZU9iamVjdChkYXRlKS5nZXRUaW1lKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCB3aGljaCBkYXkgaXMgZmlyc3QgYnkgcGFyYW1ldGVycyB0aGF0IGluY2x1ZGUgeWVhciBhbmQgbW9udGggaW5mb3JtYXRpb24uXG4gICAgICogQGZ1bmN0aW9uIGdldEZpcnN0RGF5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSB5ZWFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMH42KVxuICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG4gICAgICoqL1xuICAgIGdldEZpcnN0RGF5OiBmdW5jdGlvbih5ZWFyLCBtb250aCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCAxKS5nZXREYXkoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogR2V0IHdoaWNoIGRheSBpcyBsYXN0IGJ5IHBhcmFtZXRlcnMgdGhhdCBpbmNsdWRlIHllYXIgYW5kIG1vbnRoIGluZm9ybWF0aW9uLlxuICAgICAqIEBmdW5jdGlvbiBnZXRMYXN0RGF5XG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSB5ZWFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMH42KVxuICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG4gICAgICoqL1xuICAgIGdldExhc3REYXk6IGZ1bmN0aW9uKHllYXIsIG1vbnRoKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMCkuZ2V0RGF5KCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBsYXN0IGRhdGUgYnkgcGFyYW1ldGVycyB0aGF0IGluY2x1ZGUgeWVhciBhbmQgbW9udGggaW5mb3JtYXRpb24uXG4gICAgICogQGZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHllYXIgQSB5ZWFyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1vbnRoIEEgbW9udGhcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSAoMX4zMSlcbiAgICAgKiBAbWVtYmVyb2YgY2FsZW5kYXJVdGlsc1xuICAgICAqKi9cbiAgICBnZXRMYXN0RGF0ZTogZnVuY3Rpb24oeWVhciwgbW9udGgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHllYXIsIG1vbnRoLCAwKS5nZXREYXRlKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldCBkYXRlIGluc3RhbmNlLlxuICAgICAqIEBmdW5jdGlvbiBnZXREYXRlT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGUgQSBkYXRlIGhhc2hcbiAgICAgKiBAcmV0dXJucyB7RGF0ZX0gRGF0ZVxuICAgICAqIEBtZW1iZXJvZiBjYWxlbmRhclV0aWxzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgY2FsZW5kYXJVdGlscy5nZXREYXRlT2JqZWN0KHt5ZWFyOjIwMTAsIG1vbnRoOjUsIGRhdGU6MTJ9KTtcbiAgICAgKiAgY2FsZW5kYXJVdGlscy5nZXREYXRlT2JqZWN0KDIwMTAsIDUsIDEyKTsgLy95ZWFyLG1vbnRoLGRhdGVcbiAgICAgKiovXG4gICAgZ2V0RGF0ZU9iamVjdDogZnVuY3Rpb24oZGF0ZSkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdIC0gMSwgYXJndW1lbnRzWzJdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLnllYXIsIGRhdGUubW9udGggLSAxLCBkYXRlLmRhdGUpO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBHZXQgcmVsYXRlZCBkYXRlIGhhc2ggd2l0aCBwYXJhbWV0ZXJzIHRoYXQgaW5jbHVkZSBkYXRlIGluZm9ybWF0aW9uLlxuICAgICAqIEBmdW5jdGlvbiBnZXRSZWxhdGl2ZURhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0geWVhciBBIHJlbGF0ZWQgdmFsdWUgZm9yIHllYXIoeW91IGNhbiB1c2UgKy8tKVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtb250aCBBIHJlbGF0ZWQgdmFsdWUgZm9yIG1vbnRoICh5b3UgY2FuIHVzZSArLy0pXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGUgQSByZWxhdGVkIHZhbHVlIGZvciBkYXkgKHlvdSBjYW4gdXNlICsvLSlcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0ZU9iaiBzdGFuZGFyZCBkYXRlIGhhc2hcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBkYXRlT2JqXG4gICAgICogQG1lbWJlcm9mIGNhbGVuZGFyVXRpbHNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqICBjYWxlbmRhclV0aWxzLmdldFJlbGF0aXZlRGF0ZSgxLCAwLCAwLCB7eWVhcjoyMDAwLCBtb250aDoxLCBkYXRlOjF9KTsgLy8ge3llYXI6MjAwMSwgbW9udGg6MSwgZGF0ZToxfVxuICAgICAqICBjYWxlbmRhclV0aWxzLmdldFJlbGF0aXZlRGF0ZSgwLCAwLCAtMSwge3llYXI6MjAxMCwgbW9udGg6MSwgZGF0ZToxfSk7IC8vIHt5ZWFyOjIwMDksIG1vbnRoOjEyLCBkYXRlOjMxfVxuICAgICAqKi9cbiAgICBnZXRSZWxhdGl2ZURhdGU6IGZ1bmN0aW9uKHllYXIsIG1vbnRoLCBkYXRlLCBkYXRlT2JqKSB7XG4gICAgICAgIHZhciBuWWVhciA9IChkYXRlT2JqLnllYXIgKyB5ZWFyKSxcbiAgICAgICAgICAgIG5Nb250aCA9IChkYXRlT2JqLm1vbnRoICsgbW9udGggLSAxKSxcbiAgICAgICAgICAgIG5EYXRlID0gKGRhdGVPYmouZGF0ZSArIGRhdGUpLFxuICAgICAgICAgICAgbkRhdGVPYmogPSBuZXcgRGF0ZShuWWVhciwgbk1vbnRoLCBuRGF0ZSk7XG5cbiAgICAgICAgcmV0dXJuIHV0aWxzLmdldERhdGVIYXNoVGFibGUobkRhdGVPYmopO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDaGFnbmUgbnVtYmVyIDB+OSB0byAnMDB+MDknXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG51bWJlciBudW1iZXJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiAgY2FsZW5kYXJVdGlscy5wcmVwZW5kTGVhZGluZ1plcm8oMCk7IC8vICAnMDAnXG4gICAgICogIGNhbGVuZGFyVXRpbHMucHJlcGVuZExlYWRpbmdaZXJvKDkpOyAvLyAgJzA5J1xuICAgICAqICBjYWxlbmRhclV0aWxzLnByZXBlbmRMZWFkaW5nWmVybygxMik7IC8vICAnMTInXG4gICAgICovXG4gICAgcHJlcGVuZExlYWRpbmdaZXJvOiBmdW5jdGlvbihudW1iZXIpIHtcbiAgICAgICAgdmFyIHByZWZpeCA9ICcnO1xuXG4gICAgICAgIGlmIChudW1iZXIgPCAxMCkge1xuICAgICAgICAgICAgcHJlZml4ID0gJzAnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByZWZpeCArIG51bWJlcjtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQ2hhZ2UgdGV4dCBhbmQgcmV0dXJuLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgQSB0ZXh0IHRvIGNoYWduZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBtYXAgQSBjaGFnbmUga2V5LCB2YWx1ZSBzZXRcbiAgICAgKiBAcGFyYW0ge1JlZ0V4cH0gcmVnIEEgcmVnRXhwIHRvIGNoYWduZVxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBnZXRDb252ZXJ0ZWRUaXRsZTogZnVuY3Rpb24oc3RyLCBtYXAsIHJlZykge1xuICAgICAgICBzdHIgPSBzdHIucmVwbGFjZShyZWcsIGZ1bmN0aW9uKG1hdGNoZWRTdHJpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBtYXBbbWF0Y2hlZFN0cmluZ10gfHwgJyc7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlscztcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL3V0aWxzLmpzXG4vLyBtb2R1bGUgaWQgPSAzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0=
